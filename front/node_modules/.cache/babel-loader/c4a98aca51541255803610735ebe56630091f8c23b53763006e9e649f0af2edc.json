{"ast":null,"code":"import { setDebug as cn, retrieveLaunchParams as wo, createPostEvent as un, invokeCustomMethod as ln, request as pn, postEvent as dn, supports as oe, isTMA as Jt, on as d, off as E, retrieveRawInitData as mn, captureSameReq as _n } from \"@telegram-apps/bridge\";\nimport { AbortablePromise as Wl, CancelledError as Ql, InvalidLaunchParamsError as Kl, InvokeCustomMethodError as Yl, LaunchParamsRetrieveError as Xl, ManualPromise as Zl, MethodParameterUnsupportedError as Jl, MethodUnsupportedError as ep, TimeoutError as tp, UnknownEnvError as op, createPostEvent as sp, emitEvent as np, isCancelledError as rp, isInvalidLaunchParamsError as ap, isInvokeCustomMethodError as ip, isLaunchParamsRetrieveError as cp, isMethodMethodParameterUnsupportedError as up, isMethodUnsupportedError as lp, isTMA as pp, isTimeoutError as dp, isUnknownEnvError as mp, mockTelegramEnv as _p, off as fp, on as hp, postMessage as bp, postMessageImplementation as gp, retrieveLaunchParams as Ep, retrieveRawInitData as Sp, retrieveRawLaunchParams as wp, supports as Cp, targetOrigin as $p } from \"@telegram-apps/bridge\";\nimport { createLogger as fn, getStorageValue as S, setStorageValue as M, snakeToKebab as hn, createCbCollector as tt, camelToKebab as Co } from \"@telegram-apps/toolkit\";\nimport { isPageReload as w } from \"@telegram-apps/navigation\";\nimport { computed as bn, signal as gn, batch as se } from \"@telegram-apps/signals\";\nimport { errorClass as A } from \"error-kid\";\nimport { AbortablePromise as f, isCancelledError as En, ManualPromise as Sn } from \"better-promises\";\nimport { parse as ne, array as wn, string as $, record as Cn, ValiError as eo, pipe as fe, union as $n, instance as Mn, looseObject as to, number as $o, optional as An, transform as Mo, date as Ao, integer as vn } from \"valibot\";\nimport { toRGB as yn, isRGB as we, transformQueryUsing as Bn, jsonParse as Pn } from \"@telegram-apps/transformers\";\nimport { isRGB as Ap, isRGBShort as vp, parseInitDataQuery as yp, parseLaunchParamsQuery as Bp, serializeInitDataQuery as Pp, serializeLaunchParamsQuery as Tp, serializeToQuery as kp, toRGB as Op, transformQueryUsing as Ip } from \"@telegram-apps/transformers\";\n// @__NO_SIDE_EFFECTS__\nfunction G(e, t) {\n  return gn(e, t);\n}\n// @__NO_SIDE_EFFECTS__\nfunction c(e, t) {\n  return bn(e, t);\n}\n// @__NO_SIDE_EFFECTS__\nfunction u(e, t) {\n  const o = /* @__PURE__ */G(e, t);\n  return [o, /* @__PURE__ */c(o)];\n}\nlet vo = !1;\nconst [Qe, Bu] = fn(\"SDK\", {\n  bgColor: \"forestgreen\",\n  textColor: \"white\",\n  shouldLog() {\n    return vo;\n  }\n});\nfunction Pu(e) {\n  vo = e, cn(e);\n}\nconst je = /* @__PURE__ */G(0),\n  yo = /* @__PURE__ */G(dn),\n  [oo, le] = /* @__PURE__ */u({\n    tgWebAppPlatform: \"unknown\",\n    tgWebAppVersion: \"0.0\"\n  }),\n  k = /* @__PURE__ */c(() => le().tgWebAppVersion);\nfunction Tn(e) {\n  e || (e = {});\n  const {\n      postEvent: t\n    } = e,\n    o = e.launchParams || wo();\n  oo.set(o), yo.set(typeof t == \"function\" ? t : un(o.tgWebAppVersion)), Qe(!1, \"The package was configured. Launch params:\", oo());\n}\nfunction Bo() {\n  return je.set(je() + 1), je().toString();\n}\nfunction z(e, t, o) {\n  return ln(e, t, Bo(), {\n    ...(o || {}),\n    postEvent: i\n  });\n}\nconst p = (e, t, o) => (o || (o = {}), o.postEvent || (o.postEvent = i), pn(e, t, o)),\n  i = (e, t) => yo()(e, t);\nfunction v(e) {\n  return /* @__PURE__ */c(() => oe(e, k()));\n}\nfunction H(e) {\n  return [e];\n}\nconst [ot, Tu] = A(\"CSSVarsBoundError\", \"CSS variables are already bound\"),\n  [Po, ku] = A(\"NotAvailableError\", H),\n  [Ou, Iu] = A(\"InvalidEnvError\", H),\n  [Z, qu] = A(\"FunctionNotAvailableError\", H),\n  [y, Vu] = A(\"InvalidArgumentsError\", (e, t) => [e, {\n    cause: t\n  }]),\n  [kn, xu] = A(\"ConcurrentCallError\", H),\n  [On, Nu] = A(\"SetEmojiStatusError\", e => [`Failed to set emoji status: ${e}`]),\n  [To, Du] = A(\"AccessDeniedError\", H),\n  [In, Hu] = A(\"FullscreenFailedError\", H),\n  [qn, Lu] = A(\"ShareMessageError\", H),\n  [st, Ru] = A(\"UnknownThemeParamsKeyError\", e => [`Unknown theme params key passed: ${e}`]);\nfunction so() {\n  return typeof window > \"u\";\n}\n// @__NO_SIDE_EFFECTS__\nfunction l(e, t, o) {\n  o || (o = {});\n  const {\n      isSupported: s,\n      isMounted: n,\n      isMounting: r,\n      component: a,\n      supports: m\n    } = o || {},\n    Y = `${a ? `${a}.` : \"\"}${e}()`,\n    P = s ? Array.isArray(s) || typeof s == \"object\" && \"any\" in s ? s : [s] : void 0;\n  function X(g) {\n    if (m) {\n      const _ = m[g];\n      return oe(_[0], _[1], k());\n    }\n    return !0;\n  }\n  function T() {\n    if (!P) return;\n    function g(F) {\n      return typeof F == \"function\" ? F() : oe(F, k()) ? void 0 : `it is unsupported in Mini Apps version ${k()}`;\n    }\n    const _ = Array.isArray(P) ? P : P.any,\n      V = _.map(g).filter(Boolean);\n    return Array.isArray(P) ? V[0] : V.length === _.length ? V[V.length - 1] : void 0;\n  }\n  function rn(...g) {\n    for (const _ in m) if (m[_][2](...g) && !X(_)) return `option ${_} is not supported in Mini Apps version ${k()}`;\n  }\n  let _e;\n  if (m) {\n    _e = {};\n    for (const g in m) _e[g] = /* @__PURE__ */c(() => X(g));\n  }\n  const Kt = /* @__PURE__ */c(() => !T()),\n    Yt = /* @__PURE__ */c(() => k() !== \"0.0\"),\n    Xt = /* @__PURE__ */c(() => !n || n()),\n    Zt = /* @__PURE__ */c(() => Jt() && !so() && Yt() && Kt() && Xt());\n  return Object.assign((...g) => {\n    const _ = `Unable to call the ${Y} ${a ? \"method\" : \"function\"}:`;\n    if (so() || !Jt()) throw new Z(`${_} it can't be called outside Mini Apps`);\n    if (!Yt()) throw new Z(`${_} the SDK was not initialized. Use the SDK init() function`);\n    const V = T();\n    if (V) throw new Z(`${_} ${V}`);\n    const F = rn(...g);\n    if (F) throw new Z(`${_} ${F}`);\n    if (!Xt()) {\n      const an = r && r() ? \"mounting. Wait for the mount completion\" : `unmounted. Use the ${a}.mount() method`;\n      throw new Z(`${_} the component is ${an}`);\n    }\n    return t(...g);\n  }, t, {\n    isAvailable: Zt,\n    ifAvailable(...g) {\n      return Zt() ? [!0, t(...g)] : [!1];\n    }\n  }, P ? {\n    isSupported: Kt\n  } : {}, _e ? {\n    supports: _e\n  } : {});\n}\nfunction Ce(e, t) {\n  return t || (t = {}), (o, s, n, r) => /* @__PURE__ */l(o, s, {\n    ...t,\n    isSupported: n || t.isSupported,\n    supports: r,\n    component: e\n  });\n}\nfunction O(e, t, o) {\n  return Ce(e, {\n    isSupported: o,\n    isMounted: t\n  });\n}\nfunction C(e, t) {\n  return Ce(e, {\n    isSupported: t\n  });\n}\nconst $e = \"web_app_setup_back_button\",\n  ko = \"back_button_pressed\",\n  Me = \"backButton\",\n  [no, Vn] = /* @__PURE__ */u(!1),\n  [he, xn] = /* @__PURE__ */u(!1),\n  Nn = v($e),\n  Oo = O(Me, he, $e),\n  nt = C(Me, $e),\n  Dn = Oo(\"hide\", () => {\n    rt(!1);\n  }),\n  Hn = nt(\"mount\", () => {\n    he() || (rt(w() && S(Me) || !1), he.set(!0));\n  });\nfunction rt(e) {\n  e !== no() && (i($e, {\n    is_visible: e\n  }), M(Me, e), no.set(e));\n}\nconst Ln = nt(\"onClick\", e => d(ko, e)),\n  Rn = nt(\"offClick\", e => {\n    E(ko, e);\n  }),\n  jn = Oo(\"show\", () => {\n    rt(!0);\n  });\nfunction Fn() {\n  he.set(!1);\n}\nconst ju = /* @__PURE__ */Object.freeze(/* @__PURE__ */Object.defineProperty({\n  __proto__: null,\n  hide: Dn,\n  isMounted: xn,\n  isSupported: Nn,\n  isVisible: Vn,\n  mount: Hn,\n  offClick: Rn,\n  onClick: Ln,\n  show: jn,\n  unmount: Fn\n}, Symbol.toStringTag, {\n  value: \"Module\"\n}));\nfunction b(e, t, o) {\n  o || (o = {});\n  const {\n      promise: s,\n      error: n\n    } = o,\n    [r, a] = s ? [s, /* @__PURE__ */c(s)] : /* @__PURE__ */u(),\n    [m, Y] = n ? [n, /* @__PURE__ */c(n)] : /* @__PURE__ */u();\n  return [Object.assign((...P) => {\n    if (r()) {\n      const T = new kn(t);\n      return m.set(T), f.reject(T);\n    }\n    se(() => {\n      r.set(e(...P)), m.set(void 0);\n    });\n    let X;\n    return r().catch(T => {\n      throw X = T, T;\n    }).finally(() => {\n      se(() => {\n        r.set(void 0), m.set(X);\n      });\n    });\n  }, e), [r, a, /* @__PURE__ */c(() => !!r())], [m, Y]];\n}\n// @__NO_SIDE_EFFECTS__\nfunction pe(e, t, o) {\n  const [s, ...n] = b(t, `The ${e} component is already mounting`),\n    [r, a] = /* @__PURE__ */u(!1);\n  return [(...m) => r() ? f.resolve() : s(...m).then(Y => {\n    se(() => {\n      r.set(!0), o(Y);\n    });\n  }), ...n, [r, a]];\n}\nconst [at, Un] = /* @__PURE__ */u({\n    available: !1,\n    type: \"\",\n    accessGranted: !1,\n    accessRequested: !1,\n    deviceId: \"\",\n    tokenSaved: !1\n  }),\n  Gn = /* @__PURE__ */c(() => at().available),\n  ro = \"web_app_biometry_get_info\",\n  zn = /* @__PURE__ */l(\"requestBiometry\", e => p(ro, \"biometry_info_received\", e), {\n    isSupported: ro\n  });\nfunction Io(e) {\n  if (!En(e)) throw e;\n}\nfunction W(e) {\n  const t = e();\n  t && t.catch(Io).cancel();\n}\nconst re = \"biometry\",\n  Ae = \"web_app_biometry_request_auth\",\n  it = \"biometry_info_received\",\n  qo = e => {\n    ve(ct(e));\n  };\nfunction Vo() {\n  throw new Po(\"Biometry is not available\");\n}\nfunction ct(e) {\n  let t = !1,\n    o = !1,\n    s = \"\",\n    n = !1,\n    r = \"\",\n    a = !1;\n  return e.available && (t = !0, o = e.token_saved, s = e.device_id, n = e.access_requested, r = e.type, a = e.access_granted), {\n    available: t,\n    tokenSaved: o,\n    deviceId: s,\n    type: r,\n    accessGranted: a,\n    accessRequested: n\n  };\n}\nconst Wn = v(Ae),\n  [Qn, Kn, Yn, xo] = /* @__PURE__ */pe(re, e => {\n    const t = w() && S(re);\n    return t ? f.resolve(t) : zn({\n      abortSignal: e\n    }).then(ct);\n  }, e => {\n    d(it, qo), ve(e);\n  }),\n  No = C(re, Ae),\n  ut = O(re, xo[0], Ae),\n  Xn = No(\"mount\", Qn),\n  [, Do, Zn] = Kn,\n  [, Jn] = Yn,\n  [er, tr] = xo,\n  [or, sr, nr] = b(e => f.fn(async t => {\n    const o = at();\n    o.available || Vo();\n    const s = await p(Ae, \"biometry_auth_requested\", {\n        ...e,\n        ...t,\n        params: {\n          reason: ((e || {}).reason || \"\").trim()\n        }\n      }),\n      {\n        token: n\n      } = s;\n    return typeof n == \"string\" && ve({\n      ...o,\n      token: n\n    }), s;\n  }, e), \"Biometry authentication is already in progress\"),\n  rr = ut(\"authenticate\", or),\n  [, Ho, ar] = sr,\n  [, ir] = nr,\n  cr = No(\"openSettings\", () => {\n    i(\"web_app_biometry_open_settings\");\n  }),\n  [ur, lr, pr] = b(e => f.fn(async t => {\n    const o = await p(\"web_app_biometry_request_access\", it, {\n      ...e,\n      ...t,\n      params: {\n        reason: (e || {}).reason || \"\"\n      }\n    }).then(ct);\n    return o.available || Vo(), ve(o), o.accessGranted;\n  }, e), \"Biometry access request is already in progress\"),\n  dr = ut(\"requestAccess\", ur),\n  [, Lo, mr] = lr,\n  [, _r] = pr;\nfunction ve(e) {\n  at.set(e), M(re, e);\n}\nfunction fr() {\n  [Ho, Lo, Do].forEach(W), E(it, qo), er.set(!1);\n}\nconst hr = ut(\"updateToken\", e => (e || (e = {}), p(\"web_app_biometry_update_token\", \"biometry_token_updated\", {\n    ...e,\n    params: {\n      token: e.token || \"\",\n      reason: e.reason\n    }\n  }).then(t => t.status))),\n  Fu = /* @__PURE__ */Object.freeze(/* @__PURE__ */Object.defineProperty({\n    __proto__: null,\n    authError: ir,\n    authPromise: Ho,\n    authenticate: rr,\n    isAuthenticating: ar,\n    isAvailable: Gn,\n    isMounted: tr,\n    isMounting: Zn,\n    isRequestingAccess: mr,\n    isSupported: Wn,\n    mount: Xn,\n    mountError: Jn,\n    mountPromise: Do,\n    openSettings: cr,\n    requestAccess: dr,\n    requestAccessError: _r,\n    requestAccessPromise: Lo,\n    state: Un,\n    unmount: fr,\n    updateToken: hr\n  }, Symbol.toStringTag, {\n    value: \"Module\"\n  }));\nfunction ye(e, t) {\n  return Ce(e, {\n    isMounted: t\n  });\n}\nconst I = Ce,\n  Be = \"closingBehavior\",\n  [ao, br] = /* @__PURE__ */u(!1),\n  [Ke, Ro] = /* @__PURE__ */u(!1),\n  jo = ye(Be, Ro),\n  gr = I(Be),\n  Er = jo(\"disableConfirmation\", () => {\n    lt(!1);\n  }),\n  Sr = jo(\"enableConfirmation\", () => {\n    lt(!0);\n  }),\n  wr = gr(\"mount\", () => {\n    Ke() || (lt(w() && S(Be) || !1), Ke.set(!0));\n  });\nfunction lt(e) {\n  e !== ao() && (i(\"web_app_setup_closing_behavior\", {\n    need_confirmation: e\n  }), M(Be, e), ao.set(e));\n}\nfunction Cr() {\n  Ke.set(!1);\n}\nconst Uu = /* @__PURE__ */Object.freeze(/* @__PURE__ */Object.defineProperty({\n    __proto__: null,\n    disableConfirmation: Er,\n    enableConfirmation: Sr,\n    isConfirmationEnabled: br,\n    isMounted: Ro,\n    mount: wr,\n    unmount: Cr\n  }, Symbol.toStringTag, {\n    value: \"Module\"\n  })),\n  Fo = \"web_app_invoke_custom_method\",\n  de = C(\"cloudStorage\", Fo),\n  $r = v(Fo),\n  Uo = de(\"deleteItem\", (e, t) => {\n    const o = Array.isArray(e) ? e : [e];\n    return o.length ? z(\"deleteStorageValues\", {\n      keys: o\n    }, t).then() : f.resolve();\n  });\nfunction Mr(e, t) {\n  const o = Array.isArray(e) ? e : [e];\n  return o.length ? z(\"getStorageValues\", {\n    keys: o\n  }, t).then(s => {\n    const n = {\n      // Fulfill the response with probably missing keys.\n      ...o.reduce((r, a) => (r[a] = \"\", r), {}),\n      ...ne(Cn($(), $()), s)\n    };\n    return typeof e == \"string\" ? n[e] : n;\n  }) : f.resolve(Array.isArray(e) ? {} : \"\");\n}\nconst Ar = de(\"getItem\", Mr),\n  Go = de(\"getKeys\", e => z(\"getStorageKeys\", {}, e).then(t => ne(wn($()), t))),\n  vr = de(\"setItem\", (e, t, o) => z(\"saveStorageValue\", {\n    key: e,\n    value: t\n  }, o).then()),\n  yr = de(\"clear\", e => Go(e).then(Uo)),\n  Gu = /* @__PURE__ */Object.freeze(/* @__PURE__ */Object.defineProperty({\n    __proto__: null,\n    clear: yr,\n    deleteItem: Uo,\n    getItem: Ar,\n    getKeys: Go,\n    isSupported: $r,\n    setItem: vr\n  }, Symbol.toStringTag, {\n    value: \"Module\"\n  })),\n  me = \"web_app_trigger_haptic_feedback\",\n  pt = C(\"hapticFeedback\", me),\n  Br = v(me),\n  Pr = pt(\"impactOccurred\", e => {\n    i(me, {\n      type: \"impact\",\n      impact_style: e\n    });\n  }),\n  Tr = pt(\"notificationOccurred\", e => {\n    i(me, {\n      type: \"notification\",\n      notification_type: e\n    });\n  }),\n  kr = pt(\"selectionChanged\", () => {\n    i(me, {\n      type: \"selection_change\"\n    });\n  }),\n  zu = /* @__PURE__ */Object.freeze(/* @__PURE__ */Object.defineProperty({\n    __proto__: null,\n    impactOccurred: Pr,\n    isSupported: Br,\n    notificationOccurred: Tr,\n    selectionChanged: kr\n  }, Symbol.toStringTag, {\n    value: \"Module\"\n  })),\n  [zo, Or] = /* @__PURE__ */u(void 0);\nfunction B(e) {\n  return /* @__PURE__ */c(() => {\n    const t = zo();\n    return t ? t[e] : void 0;\n  });\n}\nconst Wo = B(\"auth_date\"),\n  Qo = B(\"can_send_after\"),\n  Ir = /* @__PURE__ */c(() => {\n    const e = Wo(),\n      t = Qo();\n    return t && e ? new Date(e.getTime() + t * 1e3) : void 0;\n  }),\n  qr = B(\"chat\"),\n  Vr = B(\"chat_type\"),\n  xr = B(\"chat_instance\"),\n  Nr = B(\"hash\"),\n  Dr = B(\"query_id\"),\n  [Hr, Lr] = /* @__PURE__ */u(),\n  Rr = B(\"receiver\");\nfunction jr() {\n  const e = wo();\n  zo.set(e.tgWebAppData), Hr.set(mn());\n}\nconst Fr = B(\"start_param\"),\n  Ur = B(\"user\"),\n  Wu = /* @__PURE__ */Object.freeze(/* @__PURE__ */Object.defineProperty({\n    __proto__: null,\n    authDate: Wo,\n    canSendAfter: Qo,\n    canSendAfterDate: Ir,\n    chat: qr,\n    chatInstance: xr,\n    chatType: Vr,\n    hash: Nr,\n    queryId: Dr,\n    raw: Lr,\n    receiver: Rr,\n    restore: jr,\n    startParam: Fr,\n    state: Or,\n    user: Ur\n  }, Symbol.toStringTag, {\n    value: \"Module\"\n  })),\n  dt = \"web_app_open_invoice\",\n  Gr = C(\"invoice\", dt),\n  zr = v(dt);\nfunction Wr(e, t, o) {\n  let s;\n  if (t === \"url\") {\n    const {\n      hostname: n,\n      pathname: r\n    } = new URL(e, window.location.href);\n    if (n !== \"t.me\") throw new y(`Link has unexpected hostname: ${n}`);\n    const a = r.match(/^\\/(\\$|invoice\\/)([A-Za-z0-9\\-_=]+)$/);\n    if (!a) throw new y('Expected to receive a link with a pathname in format \"/invoice/{slug}\" or \"/${slug}\"');\n    [,, s] = a;\n  } else s = e, o = t;\n  return p(dt, \"invoice_closed\", {\n    ...o,\n    params: {\n      slug: s\n    },\n    capture: n => s === n.slug\n  }).then(n => n.status);\n}\nconst [Qr, Kr, Yr] = b(Wr, \"Invoice is already opened\"),\n  Xr = Gr(\"open\", Qr),\n  [, Zr, Jr] = Kr,\n  [, ea] = Yr,\n  Qu = /* @__PURE__ */Object.freeze(/* @__PURE__ */Object.defineProperty({\n    __proto__: null,\n    isOpened: Jr,\n    isSupported: zr,\n    open: Xr,\n    openError: ea,\n    openPromise: Zr\n  }, Symbol.toStringTag, {\n    value: \"Module\"\n  })),\n  J = \"locationManager\",\n  mt = \"web_app_check_location\",\n  io = \"web_app_open_location_settings\",\n  be = /* @__PURE__ */G({\n    available: !1,\n    accessGranted: !1,\n    accessRequested: !1\n  });\nfunction _t(e) {\n  return /* @__PURE__ */c(() => be()[e]);\n}\nconst ta = v(mt),\n  oa = _t(\"available\"),\n  sa = _t(\"accessGranted\"),\n  na = _t(\"accessRequested\");\nfunction ra(e) {\n  let t = !1,\n    o,\n    s;\n  return e.available && (t = !0, o = e.access_requested, s = e.access_granted), {\n    available: t,\n    accessGranted: s || !1,\n    accessRequested: o || !1\n  };\n}\nconst [aa, ia, ca, Ko] = /* @__PURE__ */pe(J, e => {\n    const t = w() && S(J);\n    return t ? f.resolve(t) : p(\"web_app_check_location\", \"location_checked\", e).then(ra);\n  }, e => {\n    be.set(e), M(J, e);\n  }),\n  Yo = C(J, mt),\n  ua = O(J, Ko[0], mt),\n  la = Yo(\"mount\", aa),\n  [, pa, da] = ia,\n  [, ma] = ca,\n  [_a, fa] = Ko,\n  [ha, ba, ga] = b(e => p(\"web_app_request_location\", \"location_requested\", e).then(t => {\n    if (!t.available) throw be.set({\n      ...be(),\n      available: !1\n    }), new Po(\"Location data tracking is not available\");\n    const {\n      available: o,\n      ...s\n    } = t;\n    return s;\n  }), \"Location request is currently in progress\"),\n  Ea = ua(\"requestLocation\", ha),\n  [, Xo, Sa] = ba,\n  [, wa] = ga,\n  Ca = Yo(\"openSettings\", () => {\n    i(io);\n  }, io);\nfunction $a() {\n  W(Xo), _a.set(!1);\n}\nconst Ku = /* @__PURE__ */Object.freeze(/* @__PURE__ */Object.defineProperty({\n  __proto__: null,\n  isAccessGranted: sa,\n  isAccessRequested: na,\n  isAvailable: oa,\n  isMounted: fa,\n  isMounting: da,\n  isRequestingLocation: Sa,\n  isSupported: ta,\n  mount: la,\n  mountError: ma,\n  mountPromise: pa,\n  openSettings: Ca,\n  requestLocation: Ea,\n  requestLocationError: wa,\n  requestLocationPromise: Xo,\n  unmount: $a\n}, Symbol.toStringTag, {\n  value: \"Module\"\n}));\nfunction ft(e) {\n  const t = {};\n  for (const o in e) {\n    const s = e[o];\n    s !== void 0 && (t[o] = s);\n  }\n  return t;\n}\nfunction Zo(e) {\n  const t = yn(e);\n  return Math.sqrt([0.299, 0.587, 0.114].reduce((o, s, n) => {\n    const r = parseInt(t.slice(1 + n * 2, 1 + (n + 1) * 2), 16);\n    return o + r * r * s;\n  }, 0)) < 120;\n}\nconst [Fe, Ma] = /* @__PURE__ */u(!1),\n  [N, Q] = /* @__PURE__ */u({});\nfunction h(e) {\n  return /* @__PURE__ */c(() => N()[e]);\n}\nconst Aa = h(\"accent_text_color\"),\n  Jo = h(\"bg_color\"),\n  ht = h(\"button_color\"),\n  es = h(\"button_text_color\"),\n  va = h(\"bottom_bar_bg_color\"),\n  ya = h(\"destructive_text_color\"),\n  Ba = h(\"header_bg_color\"),\n  Pa = h(\"hint_color\"),\n  Ta = /* @__PURE__ */c(() => {\n    const e = Jo();\n    return !e || Zo(e);\n  }),\n  ka = h(\"link_color\"),\n  ts = h(\"secondary_bg_color\"),\n  Oa = h(\"section_bg_color\"),\n  Ia = h(\"section_header_text_color\"),\n  qa = h(\"section_separator_color\"),\n  Va = h(\"subtitle_text_color\"),\n  xa = h(\"text_color\");\nfunction L(e) {\n  return /* @__PURE__ */c(() => bt()[e]);\n}\nconst ee = /* @__PURE__ */G({\n    hasShineEffect: !1,\n    isEnabled: !0,\n    isLoaderVisible: !1,\n    isVisible: !1,\n    text: \"Continue\"\n  }),\n  bt = /* @__PURE__ */c(() => {\n    const e = ee();\n    return {\n      ...e,\n      backgroundColor: e.backgroundColor || ht() || \"#2481cc\",\n      textColor: e.textColor || es() || \"#ffffff\"\n    };\n  }),\n  [Ye, os] = /* @__PURE__ */u(!1),\n  Na = L(\"backgroundColor\"),\n  Da = L(\"hasShineEffect\"),\n  Ha = L(\"isEnabled\"),\n  La = L(\"isLoaderVisible\"),\n  Ra = L(\"isVisible\"),\n  ja = L(\"text\"),\n  Fa = L(\"textColor\"),\n  Ua = \"web_app_setup_main_button\",\n  ss = \"main_button_pressed\",\n  Pe = \"mainButton\",\n  gt = I(Pe),\n  Ga = ye(Pe, os),\n  za = gt(\"mount\", () => {\n    if (!Ye()) {\n      const e = w() && S(Pe);\n      e && ee.set(e), Ye.set(!0);\n    }\n  }),\n  Wa = gt(\"onClick\", e => d(ss, e)),\n  Qa = gt(\"offClick\", e => {\n    E(ss, e);\n  }),\n  Ka = Ga(\"setParams\", e => {\n    ee.set({\n      ...ee(),\n      ...ft(e)\n    }), M(Pe, ee());\n    const t = bt();\n    t.text && i(Ua, {\n      color: t.backgroundColor,\n      has_shine_effect: t.hasShineEffect,\n      is_active: t.isEnabled,\n      is_progress_visible: t.isLoaderVisible,\n      is_visible: t.isVisible,\n      text: t.text,\n      text_color: t.textColor\n    });\n  });\nfunction Ya() {\n  Ye.set(!1);\n}\nconst Yu = /* @__PURE__ */Object.freeze(/* @__PURE__ */Object.defineProperty({\n  __proto__: null,\n  backgroundColor: Na,\n  hasShineEffect: Da,\n  isEnabled: Ha,\n  isLoaderVisible: La,\n  isMounted: os,\n  isVisible: Ra,\n  mount: za,\n  offClick: Qa,\n  onClick: Wa,\n  setParams: Ka,\n  state: bt,\n  text: ja,\n  textColor: Fa,\n  unmount: Ya\n}, Symbol.toStringTag, {\n  value: \"Module\"\n}));\nfunction Et(e, t) {\n  document.documentElement.style.setProperty(e, t);\n}\nfunction St(e) {\n  document.documentElement.style.removeProperty(e);\n}\nconst U = \"themeParams\",\n  wt = \"theme_changed\",\n  ns = I(U),\n  Ct = ({\n    theme_params: e\n  }) => {\n    N.set(e), M(U, e);\n  },\n  [Xa, rs, Za, as] = /* @__PURE__ */pe(U,\n  // eslint-disable-next-line @typescript-eslint/no-unused-vars\n  e => f.resolve(w() && S(U) || le().tgWebAppThemeParams || {}), e => {\n    d(wt, Ct), N.set(e);\n  }),\n  Ja = ye(U, as[0]),\n  ei = Ja(\"bindCssVars\", e => {\n    if (Fe()) throw new ot();\n    e || (e = s => `--tg-theme-${hn(s)}`);\n    function t(s) {\n      Object.entries(N()).forEach(([n, r]) => {\n        r && s(n, r);\n      });\n    }\n    function o() {\n      t((s, n) => {\n        Et(e(s), n);\n      });\n    }\n    return o(), N.sub(o), Fe.set(!0), () => {\n      t(St), N.unsub(o), Fe.set(!1);\n    };\n  }),\n  is = ns(\"mount\", Xa),\n  ti = rs[2],\n  cs = rs[1],\n  oi = Za[1],\n  [Xe, si] = as,\n  us = ns(\"mountSync\", () => {\n    if (!Xe()) {\n      const e = w() && S(U) || le().tgWebAppThemeParams || {};\n      d(wt, Ct), se(() => {\n        N.set(e), Xe.set(!0);\n      });\n    }\n  });\nfunction ni() {\n  W(cs), E(wt, Ct), Xe.set(!1);\n}\n// @__NO_SIDE_EFFECTS__\nfunction ls(e) {\n  return /* @__PURE__ */c(() => Te(e()));\n}\nfunction Te(e) {\n  return we(e) ? e : Q()[e];\n}\nconst [ae, ri] = /* @__PURE__ */u(\"bg_color\"),\n  $t = /* @__PURE__ */ls(ae),\n  [ie, ai] = /* @__PURE__ */u(\"bottom_bar_bg_color\"),\n  Mt = /* @__PURE__ */c(() => {\n    const e = ie();\n    return we(e) ? e : Q()[e] || ts();\n  }),\n  [ce, ii] = /* @__PURE__ */u(\"bg_color\"),\n  ps = /* @__PURE__ */ls(ce),\n  [Ue, ci] = /* @__PURE__ */u(!1),\n  ui = /* @__PURE__ */c(() => {\n    const e = $t();\n    return e ? Zo(e) : !1;\n  }),\n  [ke, li] = /* @__PURE__ */u(!0),\n  ds = /* @__PURE__ */c(() => ({\n    backgroundColor: ae(),\n    bottomBarColor: ie(),\n    headerColor: ce(),\n    isActive: ke()\n  })),\n  Xu = /* @__PURE__ */Object.freeze(/* @__PURE__ */Object.defineProperty({\n    __proto__: null,\n    accentTextColor: Aa,\n    backgroundColor: Jo,\n    bindCssVars: ei,\n    bottomBarBgColor: va,\n    buttonColor: ht,\n    buttonTextColor: es,\n    destructiveTextColor: ya,\n    headerBackgroundColor: Ba,\n    hintColor: Pa,\n    isCssVarsBound: Ma,\n    isDark: Ta,\n    isMounted: si,\n    isMounting: ti,\n    linkColor: ka,\n    mount: is,\n    mountError: oi,\n    mountPromise: cs,\n    mountSync: us,\n    secondaryBackgroundColor: ts,\n    sectionBackgroundColor: Oa,\n    sectionHeaderTextColor: Ia,\n    sectionSeparatorColor: qa,\n    state: Q,\n    subtitleTextColor: Va,\n    textColor: xa,\n    unmount: ni\n  }, Symbol.toStringTag, {\n    value: \"Module\"\n  })),\n  ge = \"web_app_set_background_color\",\n  Ee = \"web_app_set_bottom_bar_color\",\n  x = \"web_app_set_header_color\",\n  At = \"visibility_changed\",\n  D = \"miniApp\",\n  vt = {\n    any: [ge, Ee, x]\n  },\n  pi = /* @__PURE__ */c(() => vt.any.some(e => oe(e, k()))),\n  yt = e => {\n    ke.set(e.is_visible), Ie();\n  },\n  Bt = e => {\n    [[ce, x], [ae, ge], [ie, Ee]].forEach(([t, o]) => {\n      const s = t();\n      if (!we(s) && (\n      // Header color setter uses additional checks. We don't apply changes if the current\n      // value is a known color key because it updates automatically by itself.\n      o !== x || s !== \"bg_color\" && s !== \"secondary_bg_color\")) {\n        const n = e[s];\n        n && i(o, {\n          color: n\n        });\n      }\n    });\n  },\n  [di, ms, mi, _s] = /* @__PURE__ */pe(D, e => is(e).then(() => w() && S(D) || void 0), e => {\n    Pt.ifAvailable(e ? e.backgroundColor : \"bg_color\"), Tt.ifAvailable(e ? e.bottomBarColor : \"bottom_bar_bg_color\"), kt.ifAvailable(e ? e.headerColor : \"bg_color\"), ke.set(e ? e.isActive : !0), d(At, yt), Q.sub(Bt);\n  }),\n  fs = I(D),\n  hs = C(D, vt),\n  Oe = O(D, _s[0], vt),\n  _i = Oe(\"bindCssVars\", e => {\n    if (Ue()) throw new ot();\n    const [t, o] = tt();\n    function s(n, r) {\n      function a() {\n        Et(n, r() || null);\n      }\n      a(), t(r.sub(a), St.bind(null, n));\n    }\n    return e || (e = n => `--tg-${Co(n)}`), s(e(\"bgColor\"), $t), s(e(\"bottomBarColor\"), Mt), s(e(\"headerColor\"), ps), t(() => {\n      Ue.set(!1);\n    }), Ue.set(!0), o;\n  }),\n  fi = fs(\"close\", e => {\n    i(\"web_app_close\", {\n      return_back: e\n    });\n  }),\n  hi = hs(\"mount\", di),\n  bi = ms[2],\n  bs = ms[1],\n  gi = mi[1],\n  [Ze, Ei] = _s,\n  Si = hs(\"mountSync\", () => {\n    if (!Ze()) {\n      us();\n      const e = w() && S(D) || void 0;\n      Pt.ifAvailable(e ? e.backgroundColor : \"bg_color\"), Tt.ifAvailable(e ? e.bottomBarColor : \"bottom_bar_bg_color\"), kt.ifAvailable(e ? e.headerColor : \"bg_color\"), d(At, yt), Q.sub(Bt), se(() => {\n        ke.set(e ? e.isActive : !0), Ze.set(!0);\n      });\n    }\n  }),\n  wi = fs(\"ready\", () => {\n    i(\"web_app_ready\");\n  });\nfunction Ie() {\n  M(D, ds());\n}\nconst Pt = Oe(\"setBackgroundColor\", e => {\n    if (e === ae()) return;\n    const t = Te(e);\n    if (!t) throw new st(e);\n    i(ge, {\n      color: t\n    }), ae.set(e), Ie();\n  }, ge),\n  Tt = Oe(\"setBottomBarColor\", e => {\n    if (e === ie()) return;\n    const t = Te(e);\n    if (!t) throw new st(e);\n    i(Ee, {\n      color: t\n    }), ie.set(e), Ie();\n  }, Ee),\n  kt = Oe(\"setHeaderColor\", e => {\n    if (e !== ce()) {\n      if (e === \"bg_color\" || e === \"secondary_bg_color\") i(x, {\n        color_key: e\n      });else {\n        const t = Te(e);\n        if (!t) throw new st(e);\n        i(x, {\n          color: t\n        });\n      }\n      ce.set(e), Ie();\n    }\n  }, x, {\n    rgb: [x, \"color\", we]\n  });\nfunction Ci() {\n  W(bs), E(At, yt), Q.unsub(Bt), Ze.set(!1);\n}\nconst Zu = /* @__PURE__ */Object.freeze(/* @__PURE__ */Object.defineProperty({\n  __proto__: null,\n  backgroundColor: ri,\n  backgroundColorRGB: $t,\n  bindCssVars: _i,\n  bottomBarColor: ai,\n  bottomBarColorRGB: Mt,\n  close: fi,\n  headerColor: ii,\n  headerColorRGB: ps,\n  isActive: li,\n  isCssVarsBound: ci,\n  isDark: ui,\n  isMounted: Ei,\n  isMounting: bi,\n  isSupported: pi,\n  mount: hi,\n  mountError: gi,\n  mountPromise: bs,\n  mountSync: Si,\n  ready: wi,\n  setBackgroundColor: Pt,\n  setBottomBarColor: Tt,\n  setHeaderColor: kt,\n  state: ds,\n  unmount: Ci\n}, Symbol.toStringTag, {\n  value: \"Module\"\n}));\nfunction $i(e) {\n  const t = e.message.trim(),\n    o = (e.title || \"\").trim(),\n    s = e.buttons || [];\n  if (o.length > 64) throw new y(`Invalid title: ${o}`);\n  if (!t || t.length > 256) throw new y(`Invalid message: ${t}`);\n  if (s.length > 3) throw new y(`Invalid buttons count: ${s.length}`);\n  return {\n    title: o,\n    message: t,\n    buttons: s.length ? s.map((n, r) => {\n      const a = n.id || \"\";\n      if (a.length > 64) throw new y(`Button with index ${r} has invalid id: ${a}`);\n      if (!n.type || n.type === \"default\" || n.type === \"destructive\") {\n        const m = n.text.trim();\n        if (!m || m.length > 64) throw new y(`Button with index ${r} has invalid text: ${m}`);\n        return {\n          type: n.type,\n          text: m,\n          id: a\n        };\n      }\n      return {\n        type: n.type,\n        id: a\n      };\n    }) : [{\n      type: \"close\",\n      id: \"\"\n    }]\n  };\n}\nconst Ot = \"web_app_open_popup\",\n  gs = C(\"popup\", Ot),\n  Mi = v(Ot),\n  [Es, It, Ss] = b(e => p(Ot, \"popup_closed\", {\n    ...e,\n    params: $i(e)\n  }).then(({\n    button_id: t\n  }) => t === void 0 ? null : t), \"A popup is already opened\"),\n  Ai = gs(\"open\", Es),\n  vi = It[1],\n  yi = It[2],\n  Bi = Ss[1],\n  Pi = gs(\"show\", Es),\n  [, Ti, ki] = It,\n  [, Oi] = Ss,\n  Ju = /* @__PURE__ */Object.freeze(/* @__PURE__ */Object.defineProperty({\n    __proto__: null,\n    isOpened: yi,\n    isShown: ki,\n    isSupported: Mi,\n    open: Ai,\n    openError: Bi,\n    openPromise: vi,\n    show: Pi,\n    showError: Oi,\n    showPromise: Ti\n  }, Symbol.toStringTag, {\n    value: \"Module\"\n  })),\n  ws = \"web_app_close_scan_qr_popup\",\n  qt = \"web_app_open_scan_qr_popup\",\n  Ii = \"scan_qr_popup_closed\",\n  qi = \"qr_text_received\",\n  Cs = C(\"qrScanner\", qt),\n  Vi = Cs(\"close\", () => {\n    i(ws), W($s);\n  }),\n  xi = v(qt);\nfunction Ni(e) {\n  e || (e = {});\n  const {\n      onCaptured: t,\n      text: o,\n      capture: s\n    } = e,\n    [, n] = tt(d(Ii, () => {\n      r.resolve();\n    }), d(qi, a => {\n      t ? t(a.data) : (!s || s(a.data)) && (r.resolve(a.data), i(ws));\n    })),\n    r = new Sn(e);\n  return (e.postEvent || i)(qt, {\n    text: o\n  }), f.resolve(r).catch(Io).finally(n);\n}\nconst [Di, Hi, Li] = b(Ni, \"The QR Scanner is already opened\"),\n  Ri = Cs(\"open\", Di),\n  [, $s, ji] = Hi,\n  [, Fi] = Li,\n  el = /* @__PURE__ */Object.freeze(/* @__PURE__ */Object.defineProperty({\n    __proto__: null,\n    close: Vi,\n    isOpened: ji,\n    isSupported: xi,\n    open: Ri,\n    openError: Fi,\n    openPromise: $s\n  }, Symbol.toStringTag, {\n    value: \"Module\"\n  }));\nfunction q(e) {\n  return /* @__PURE__ */c(() => Vt()[e]);\n}\nconst te = /* @__PURE__ */G({\n    hasShineEffect: !1,\n    isEnabled: !0,\n    isLoaderVisible: !1,\n    isVisible: !1,\n    position: \"left\",\n    text: \"Cancel\"\n  }),\n  Vt = /* @__PURE__ */c(() => {\n    const e = te();\n    return {\n      ...e,\n      backgroundColor: e.backgroundColor || Mt() || \"#000000\",\n      textColor: e.textColor || ht() || \"#2481cc\"\n    };\n  }),\n  [Je, Ms] = /* @__PURE__ */u(!1),\n  Ui = q(\"backgroundColor\"),\n  Gi = q(\"hasShineEffect\"),\n  zi = q(\"isEnabled\"),\n  Wi = q(\"isLoaderVisible\"),\n  Qi = q(\"isVisible\"),\n  Ki = q(\"position\"),\n  Yi = q(\"text\"),\n  Xi = q(\"textColor\"),\n  qe = \"web_app_setup_secondary_button\",\n  As = \"secondary_button_pressed\",\n  Ve = \"secondaryButton\",\n  xt = C(Ve, qe),\n  Zi = O(Ve, Ms, qe),\n  Ji = v(qe),\n  ec = xt(\"mount\", () => {\n    if (!Je()) {\n      const e = w() && S(Ve);\n      e && te.set(e), Je.set(!0);\n    }\n  }),\n  tc = xt(\"onClick\", e => d(As, e)),\n  oc = xt(\"offClick\", e => {\n    E(As, e);\n  }),\n  sc = Zi(\"setParams\", e => {\n    te.set({\n      ...te(),\n      ...ft(e)\n    }), M(Ve, te());\n    const t = Vt();\n    t.text && i(qe, {\n      color: t.backgroundColor,\n      has_shine_effect: t.hasShineEffect,\n      is_active: t.isEnabled,\n      is_progress_visible: t.isLoaderVisible,\n      is_visible: t.isVisible,\n      position: t.position,\n      text: t.text,\n      text_color: t.textColor\n    });\n  });\nfunction nc() {\n  Je.set(!1);\n}\nconst tl = /* @__PURE__ */Object.freeze(/* @__PURE__ */Object.defineProperty({\n    __proto__: null,\n    backgroundColor: Ui,\n    hasShineEffect: Gi,\n    isEnabled: zi,\n    isLoaderVisible: Wi,\n    isMounted: Ms,\n    isSupported: Ji,\n    isVisible: Qi,\n    mount: ec,\n    offClick: oc,\n    onClick: tc,\n    position: Ki,\n    setParams: sc,\n    state: Vt,\n    text: Yi,\n    textColor: Xi,\n    unmount: nc\n  }, Symbol.toStringTag, {\n    value: \"Module\"\n  })),\n  xe = \"web_app_setup_settings_button\",\n  vs = \"settings_button_pressed\",\n  Ne = \"settingsButton\",\n  [co, rc] = /* @__PURE__ */u(!1),\n  [Se, ac] = /* @__PURE__ */u(!1),\n  ic = v(xe),\n  Nt = C(Ne, xe),\n  ys = O(Ne, Se, xe),\n  cc = ys(\"hide\", () => {\n    Dt(!1);\n  }),\n  uc = Nt(\"mount\", () => {\n    Se() || (Dt(w() && S(Ne) || !1), Se.set(!0));\n  });\nfunction Dt(e) {\n  e !== co() && (i(xe, {\n    is_visible: e\n  }), M(Ne, e), co.set(e));\n}\nconst lc = Nt(\"onClick\", e => d(vs, e)),\n  pc = Nt(\"offClick\", e => {\n    E(vs, e);\n  }),\n  dc = ys(\"show\", () => {\n    Dt(!0);\n  });\nfunction mc() {\n  Se.set(!1);\n}\nconst ol = /* @__PURE__ */Object.freeze(/* @__PURE__ */Object.defineProperty({\n    __proto__: null,\n    hide: cc,\n    isMounted: ac,\n    isSupported: ic,\n    isVisible: rc,\n    mount: uc,\n    offClick: pc,\n    onClick: lc,\n    show: dc,\n    unmount: mc\n  }, Symbol.toStringTag, {\n    value: \"Module\"\n  })),\n  De = \"web_app_setup_swipe_behavior\",\n  He = \"swipeBehavior\",\n  [ue, _c] = /* @__PURE__ */u(!1),\n  fc = v(De),\n  [et, hc] = /* @__PURE__ */u(!0),\n  bc = C(He, De),\n  Bs = O(He, ue, De),\n  gc = Bs(\"disableVertical\", () => {\n    Ht(!1);\n  }),\n  Ec = Bs(\"enableVertical\", () => {\n    Ht(!0);\n  }),\n  Sc = bc(\"mount\", () => {\n    ue() || (Ht(w() && S(He) || !1, !0), ue.set(!0));\n  });\nfunction Ht(e, t) {\n  (e !== et() || t) && (i(De, {\n    allow_vertical_swipe: e\n  }), M(He, e), et.set(e));\n}\nfunction wc() {\n  ue.set(!1);\n}\nconst sl = /* @__PURE__ */Object.freeze(/* @__PURE__ */Object.defineProperty({\n    __proto__: null,\n    _isMounted: ue,\n    _isVerticalEnabled: et,\n    disableVertical: gc,\n    enableVertical: Ec,\n    isMounted: _c,\n    isSupported: fc,\n    isVerticalEnabled: hc,\n    mount: Sc,\n    unmount: wc\n  }, Symbol.toStringTag, {\n    value: \"Module\"\n  })),\n  R = \"viewport\",\n  Lt = \"fullscreen_changed\",\n  Rt = \"safe_area_changed\",\n  jt = \"content_safe_area_changed\",\n  Ft = \"viewport_changed\",\n  Ps = I(R),\n  uo = {\n    left: 0,\n    top: 0,\n    bottom: 0,\n    right: 0\n  };\nfunction Ge(e) {\n  return Math.max(e, 0);\n}\nconst [ze, Ts] = /* @__PURE__ */u({\n  contentSafeAreaInsets: uo,\n  height: 0,\n  isExpanded: !1,\n  isFullscreen: !1,\n  safeAreaInsets: uo,\n  stableHeight: 0,\n  width: 0\n});\nfunction j(e) {\n  return /* @__PURE__ */c(() => Ts()[e]);\n}\nconst Ut = j(\"height\"),\n  Gt = j(\"stableHeight\"),\n  ks = j(\"width\"),\n  Cc = j(\"isExpanded\"),\n  $c = /* @__PURE__ */c(() => Ut() === Gt());\nfunction K(e) {\n  const {\n    height: t,\n    stableHeight: o,\n    width: s\n  } = e;\n  ze.set({\n    ...ze(),\n    ...ft({\n      ...e,\n      height: t ? Ge(t) : void 0,\n      width: s ? Ge(s) : void 0,\n      stableHeight: o ? Ge(o) : void 0\n    })\n  }), M(R, ze());\n}\nfunction Mc() {\n  return S(R);\n}\nfunction Le(e) {\n  return /* @__PURE__ */c(() => zt()[e]);\n}\nconst zt = j(\"contentSafeAreaInsets\"),\n  Os = Le(\"bottom\"),\n  Is = Le(\"left\"),\n  qs = Le(\"right\"),\n  Vs = Le(\"top\");\nfunction Re(e) {\n  return /* @__PURE__ */c(() => Wt()[e]);\n}\nconst Wt = j(\"safeAreaInsets\"),\n  xs = Re(\"bottom\"),\n  Ns = Re(\"left\"),\n  Ds = Re(\"right\"),\n  Hs = Re(\"top\"),\n  Ls = \"web_app_request_safe_area\",\n  Rs = C(R, Ls),\n  lo = Rs(\"requestContentSafeAreaInsets\", e => p(\"web_app_request_content_safe_area\", jt, e));\nfunction Ac(e) {\n  return p(\"web_app_request_viewport\", Ft, e);\n}\nconst po = Rs(\"requestSafeAreaInsets\", e => p(Ls, Rt, e)),\n  js = e => {\n    const {\n      height: t\n    } = e;\n    K({\n      isExpanded: e.is_expanded,\n      height: t,\n      width: e.width,\n      stableHeight: e.is_state_stable ? t : void 0\n    });\n  },\n  Fs = e => {\n    K({\n      isFullscreen: e.is_fullscreen\n    });\n  },\n  Us = e => {\n    K({\n      safeAreaInsets: e\n    });\n  },\n  Gs = e => {\n    K({\n      contentSafeAreaInsets: e\n    });\n  },\n  [vc, yc, Bc, Pc] = /* @__PURE__ */pe(R, e => {\n    const t = w() && Mc();\n    return t ? f.resolve(t) : f.fn(async o => {\n      const s = await f.all([po.isAvailable() ? po(o) : Wt(), lo.isAvailable() ? lo(o) : zt()]),\n        n = le(),\n        r = {\n          contentSafeAreaInsets: s[1],\n          isFullscreen: !!n.tgWebAppFullscreen,\n          safeAreaInsets: s[0]\n        };\n      if ([\"macos\", \"tdesktop\", \"unigram\", \"webk\", \"weba\", \"web\"].includes(n.tgWebAppPlatform)) {\n        const a = window;\n        return {\n          ...r,\n          height: a.innerHeight,\n          isExpanded: !0,\n          stableHeight: a.innerHeight,\n          width: a.innerWidth\n        };\n      }\n      return Ac(o).then(a => ({\n        ...r,\n        height: a.height,\n        isExpanded: a.is_expanded,\n        stableHeight: a.is_state_stable ? a.height : 0,\n        width: a.width\n      }));\n    }, e);\n  }, e => {\n    d(Ft, js), d(Lt, Fs), d(Rt, Us), d(jt, Gs), K(e);\n  }),\n  Tc = Ps(\"mount\", vc),\n  [, zs, kc] = yc,\n  [, Oc] = Bc,\n  [Qt, Ic] = Pc;\nfunction qc() {\n  W(zs), E(Ft, js), E(Lt, Fs), E(Rt, Us), E(jt, Gs), Qt.set(!1);\n}\nconst Vc = ye(R, Qt),\n  [We, xc] = /* @__PURE__ */u(!1),\n  Nc = Vc(\"bindCssVars\", e => {\n    if (We()) throw new ot();\n    e || (e = o => `--tg-viewport-${Co(o)}`);\n    const t = [[\"height\", Ut], [\"stableHeight\", Gt], [\"width\", ks], [\"safeAreaInsetTop\", Hs], [\"safeAreaInsetBottom\", xs], [\"safeAreaInsetLeft\", Ns], [\"safeAreaInsetRight\", Ds], [\"contentSafeAreaInsetTop\", Vs], [\"contentSafeAreaInsetBottom\", Os], [\"contentSafeAreaInsetLeft\", Is], [\"contentSafeAreaInsetRight\", qs]].reduce((o, [s, n]) => {\n      const r = e(s);\n      if (r) {\n        const a = () => {\n          Et(r, `${n()}px`);\n        };\n        o.push([a, n.sub(a), r]);\n      }\n      return o;\n    }, []);\n    return t.forEach(o => {\n      o[0]();\n    }), We.set(!0), () => {\n      t.forEach(o => {\n        o[1](), St(o[2]);\n      }), We.set(!1);\n    };\n  }),\n  Dc = Ps(\"expand\", () => {\n    i(\"web_app_expand\");\n  }),\n  Ws = \"web_app_request_fullscreen\",\n  Hc = O(R, Qt, Ws),\n  Qs = j(\"isFullscreen\"),\n  [Lc, Rc] = /* @__PURE__ */u(),\n  [jc, Fc] = /* @__PURE__ */u();\nfunction Ks(e, t) {\n  return Hc(e, b(o => p(t ? Ws : \"web_app_exit_fullscreen\", [Lt, \"fullscreen_failed\"], o).then(s => {\n    if (\"error\" in s && s.error !== \"ALREADY_FULLSCREEN\") throw new In(s.error);\n    const n = \"is_fullscreen\" in s ? s.is_fullscreen : !0;\n    n !== Qs() && K({\n      isFullscreen: n\n    });\n  }), \"Fullscreen mode change is already being requested\", {\n    promise: Lc,\n    error: jc\n  })[0]);\n}\nconst Uc = Ks(\"requestFullscreen\", !0),\n  Gc = Ks(\"exitFullscreen\"),\n  nl = /* @__PURE__ */Object.freeze(/* @__PURE__ */Object.defineProperty({\n    __proto__: null,\n    bindCssVars: Nc,\n    changeFullscreenError: Fc,\n    changeFullscreenPromise: Rc,\n    contentSafeAreaInsetBottom: Os,\n    contentSafeAreaInsetLeft: Is,\n    contentSafeAreaInsetRight: qs,\n    contentSafeAreaInsetTop: Vs,\n    contentSafeAreaInsets: zt,\n    exitFullscreen: Gc,\n    expand: Dc,\n    height: Ut,\n    isCssVarsBound: xc,\n    isExpanded: Cc,\n    isFullscreen: Qs,\n    isMounted: Ic,\n    isMounting: kc,\n    isStable: $c,\n    mount: Tc,\n    mountError: Oc,\n    mountPromise: zs,\n    requestFullscreen: Uc,\n    safeAreaInsetBottom: xs,\n    safeAreaInsetLeft: Ns,\n    safeAreaInsetRight: Ds,\n    safeAreaInsetTop: Hs,\n    safeAreaInsets: Wt,\n    stableHeight: Gt,\n    state: Ts,\n    unmount: qc,\n    width: ks\n  }, Symbol.toStringTag, {\n    value: \"Module\"\n  })),\n  Ys = \"web_app_request_emoji_status_access\",\n  [zc, Wc, Qc] = b(e => p(Ys, \"emoji_status_access_requested\", e).then(t => t.status), \"Emoji status access request is already in progress\"),\n  rl = /* @__PURE__ */l(\"requestEmojiStatusAccess\", zc, {\n    isSupported: Ys\n  }),\n  [, al, il] = Wc,\n  [, cl] = Qc,\n  Xs = \"web_app_set_emoji_status\",\n  [Kc, Yc, Xc] = b((e, t) => p(Xs, [\"emoji_status_set\", \"emoji_status_failed\"], {\n    params: {\n      custom_emoji_id: e,\n      duration: (t || {}).duration\n    },\n    ...t\n  }).then(o => {\n    if (o && \"error\" in o) throw new On(o.error);\n  }), \"Emoji status set request is currently in progress\"),\n  ul = /* @__PURE__ */l(\"setEmojiStatus\", Kc, {\n    isSupported: Xs\n  }),\n  [, ll, pl] = Yc,\n  [, dl] = Xc,\n  Zc = {\n    isSupported: \"web_app_add_to_home_screen\"\n  },\n  Zs = \"home_screen_failed\",\n  ml = /* @__PURE__ */l(\"onAddToHomeScreenFailed\", (e, t) => d(Zs, e, t), {\n    isSupported: \"web_app_add_to_home_screen\"\n  }),\n  _l = /* @__PURE__ */l(\"offAddToHomeScreenFailed\", e => {\n    E(Zs, e);\n  }, Zc),\n  Js = {\n    isSupported: \"web_app_add_to_home_screen\"\n  },\n  en = \"home_screen_added\",\n  fl = /* @__PURE__ */l(\"onAddedToHomeScreen\", (e, t) => d(en, e, t), Js),\n  hl = /* @__PURE__ */l(\"offAddedToHomeScreen\", e => {\n    E(en, e);\n  }, Js),\n  mo = \"web_app_add_to_home_screen\",\n  bl = /* @__PURE__ */l(\"addToHomeScreen\", () => {\n    i(mo);\n  }, {\n    isSupported: mo\n  }),\n  tn = \"web_app_check_home_screen\",\n  [Jc, eu, tu] = b(e => p(tn, \"home_screen_checked\", e).then(t => t.status || \"unknown\"), \"Check home screen status request is currently in progress\"),\n  gl = /* @__PURE__ */l(\"checkHomeScreenStatus\", Jc, {\n    isSupported: tn\n  }),\n  [, El, Sl] = eu,\n  [, wl] = tu,\n  ou = I(),\n  Cl = ou(\"openLink\", (e, t) => {\n    if (typeof e == \"string\") try {\n      e = new URL(e);\n    } catch (o) {\n      throw new y(`\"${e.toString()}\" is invalid URL`, o);\n    }\n    t || (t = {}), i(\"web_app_open_link\", {\n      url: e.toString(),\n      try_browser: t.tryBrowser,\n      try_instant_view: t.tryInstantView\n    });\n  }),\n  _o = \"web_app_open_tg_link\",\n  su = I(),\n  nu = su(\"openTelegramLink\", e => {\n    const t = e.toString();\n    if (!t.match(/^https:\\/\\/t.me\\/.+/)) throw new y(`\"${t}\" is invalid URL`);\n    if (!oe(_o, k())) {\n      window.location.href = t;\n      return;\n    }\n    e = new URL(e), i(_o, {\n      path_full: e.pathname + e.search\n    });\n  }),\n  ru = I(),\n  $l = ru(\"shareURL\", (e, t) => {\n    nu(\"https://t.me/share/url?\" + new URLSearchParams({\n      url: e,\n      text: t || \"\"\n    }).toString().replace(/\\+/g, \"%20\"));\n  });\nfunction au(e, t) {\n  return new f({\n    abortSignal: t,\n    timeout: e\n  }).catch(() => {});\n}\nconst on = \"web_app_request_phone\",\n  [iu, cu, uu] = b(e => p(on, \"phone_requested\", e).then(t => t.status), \"Phone access request is currently in progress\"),\n  lu = /* @__PURE__ */l(\"requestPhoneAccess\", iu, {\n    isSupported: on\n  }),\n  [, Ml, Al] = cu,\n  [, vl] = uu,\n  sn = {\n    isSupported: \"web_app_request_phone\"\n  };\nasync function fo(e) {\n  const t = ne($(), await z(\"getRequestedContact\", {}, {\n    ...e,\n    timeout: (e || {}).timeout || 5e3\n  }));\n  return {\n    raw: t,\n    parsed: ne(fe(\n    // todo: Union is unnecessary here, but we use it to comply TypeScript checker.\n    $n([$(), Mn(URLSearchParams)]), Bn(to({\n      contact: fe($(), Pn(), to({\n        user_id: $o(),\n        phone_number: $(),\n        first_name: $(),\n        last_name: An($())\n      })),\n      auth_date: fe($(), Mo(o => new Date(Number(o) * 1e3)), Ao()),\n      hash: $()\n    }))), t)\n  };\n}\nconst [pu, du, mu] = b(e => new f(async (t, o, s) => {\n    try {\n      return t(await fo(s));\n    } catch (a) {\n      if (a instanceof eo) throw a;\n    }\n    if ((await lu(s)) !== \"sent\") throw new To(\"User denied access\");\n    let r = 50;\n    for (; !s.isAborted();) {\n      try {\n        return t(await fo(s));\n      } catch (a) {\n        if (a instanceof eo) throw a;\n      }\n      await au(r), r += 50;\n    }\n  }, e), \"Contact is already being requested\"),\n  _u = /* @__PURE__ */l(\"requestContactComplete\", pu, sn),\n  yl = /* @__PURE__ */l(\"requestContact\", e => _u(e).then(t => t.parsed), sn),\n  [, Bl, Pl] = du,\n  [, Tl] = mu,\n  nn = \"web_app_request_write_access\",\n  [fu, hu, bu] = b(e => p(nn, \"write_access_requested\", e).then(t => t.status), \"Write access request is currently in progress\"),\n  kl = /* @__PURE__ */l(\"requestWriteAccess\", fu, {\n    isSupported: nn\n  }),\n  [, Ol, Il] = hu,\n  [, ql] = bu;\nfunction gu(e) {\n  const t = document.createElement(\"textarea\");\n  t.value = e, t.style.top = \"0\", t.style.left = \"0\", t.style.position = \"fixed\", document.body.appendChild(t), t.focus(), t.select();\n  try {\n    document.execCommand(\"copy\");\n  } finally {\n    document.body.removeChild(t);\n  }\n}\nasync function Vl(e) {\n  try {\n    const {\n      clipboard: t\n    } = navigator;\n    if (t) return await t.writeText(e);\n  } catch {}\n  gu(e);\n}\nconst ho = \"web_app_request_file_download\",\n  xl = /* @__PURE__ */l(\"downloadFile\", (e, t, o) => p(ho, \"file_download_requested\", {\n    ...o,\n    params: {\n      url: e,\n      file_name: t\n    }\n  }).then(s => {\n    if (s.status !== \"downloading\") throw new To(\"User denied the action\");\n  }), {\n    isSupported: ho\n  }),\n  Nl = /* @__PURE__ */l(\"getCurrentTime\", e => z(\"getCurrentTime\", {}, e).then(t => ne(fe($o(), vn(), Mo(o => new Date(o * 1e3)), Ao()), t)), {\n    isSupported: \"web_app_invoke_custom_method\"\n  }),\n  bo = \"web_app_read_text_from_clipboard\",\n  Dl = /* @__PURE__ */l(\"readTextFromClipboard\", e => {\n    const t = Bo();\n    return p(bo, \"clipboard_text_received\", {\n      ...e,\n      params: {\n        req_id: t\n      },\n      capture: _n(t)\n    }).then(({\n      data: o = null\n    }) => o);\n  }, {\n    isSupported: bo\n  }),\n  go = \"web_app_data_send\",\n  Hl = /* @__PURE__ */l(\"sendData\", e => {\n    const {\n      size: t\n    } = new Blob([e]);\n    if (!t || t > 4096) throw new y(t ? \"Maximum size of data to send is 4096 bytes\" : \"Attempted to send empty data\");\n    i(go, {\n      data: e\n    });\n  }, {\n    isSupported: go\n  }),\n  Eo = \"web_app_send_prepared_message\",\n  Ll = /* @__PURE__ */l(\"shareMessage\", (e, t) => p(Eo, [\"prepared_message_failed\", \"prepared_message_sent\"], {\n    ...t,\n    params: {\n      id: e\n    }\n  }).then(o => {\n    if (o && \"error\" in o) throw new qn(o.error);\n  }), {\n    isSupported: Eo\n  }),\n  So = \"web_app_share_to_story\",\n  Rl = /* @__PURE__ */l(\"shareStory\", (e, t) => {\n    t || (t = {}), i(So, {\n      text: t.text,\n      media_url: e,\n      widget_link: t.widgetLink\n    });\n  }, {\n    isSupported: So\n  }),\n  Eu = \"web_app_switch_inline_query\",\n  jl = /* @__PURE__ */l(\"switchInlineQuery\", (e, t) => {\n    i(Eu, {\n      query: e,\n      chat_types: t || []\n    });\n  }, {\n    isSupported() {\n      return le().tgWebAppBotInline ? void 0 : \"The application must be launched in the inline mode\";\n    }\n  });\nfunction Fl(e) {\n  try {\n    return [!0, e()];\n  } catch (t) {\n    return [!1, t];\n  }\n}\nfunction Ul(e) {\n  Tn(e);\n  const [t, o] = tt(d(\"reload_iframe\", () => {\n      Qe(!1, \"Received a request to reload the page\"), i(\"iframe_will_reload\"), window.location.reload();\n    })),\n    {\n      acceptCustomStyles: s = !0\n    } = e || {};\n  if (s) {\n    const n = document.createElement(\"style\");\n    n.id = \"telegram-custom-styles\", document.head.appendChild(n), t(d(\"set_custom_style\", r => {\n      n.innerHTML = r;\n    }), () => {\n      document.head.removeChild(n);\n    });\n  }\n  return i(\"iframe_ready\", {\n    reload_supported: !0\n  }), Qe(!1, \"The package was initialized\"), o;\n}\nexport { Wl as AbortablePromise, To as AccessDeniedError, ot as CSSVarsBoundError, Ql as CancelledError, kn as ConcurrentCallError, In as FullscreenFailedError, Z as FunctionUnavailableError, y as InvalidArgumentsError, Ou as InvalidEnvError, Kl as InvalidLaunchParamsError, Yl as InvokeCustomMethodError, Xl as LaunchParamsRetrieveError, Zl as ManualPromise, Jl as MethodParameterUnsupportedError, ep as MethodUnsupportedError, Po as NotAvailableError, On as SetEmojiStatusError, qn as ShareMessageError, tp as TimeoutError, op as UnknownEnvError, st as UnknownThemeParamsKeyError, bl as addToHomeScreen, rr as authenticateBiometry, ju as backButton, _i as bindMiniAppCssVars, ei as bindThemeParamsCssVars, Nc as bindViewportCssVars, Fu as biometry, ir as biometryAuthError, Ho as biometryAuthPromise, Jn as biometryMountError, Un as biometryState, Fc as changeFullscreenError, Rc as changeFullscreenPromise, gl as checkHomeScreenStatus, wl as checkHomeScreenStatusError, El as checkHomeScreenStatusPromise, fi as closeMiniApp, Vi as closeQrScanner, Uu as closingBehavior, Gu as cloudStorage, Tn as configure, Vl as copyTextToClipboard, sp as createPostEvent, Bo as createRequestId, Uo as deleteCloudStorageItem, Er as disableClosingConfirmation, gc as disableVerticalSwipes, xl as downloadFile, np as emitEvent, Sr as enableClosingConfirmation, Ec as enableVerticalSwipes, Gc as exitFullscreen, Dc as expandViewport, Ar as getCloudStorageItem, Go as getCloudStorageKeys, Nl as getCurrentTime, zu as hapticFeedback, Pr as hapticFeedbackImpactOccurred, Tr as hapticFeedbackNotificationOccurred, kr as hapticFeedbackSelectionChanged, Dn as hideBackButton, cc as hideSettingsButton, Io as ignoreCanceled, Ul as init, Wu as initData, Wo as initDataAuthDate, Qo as initDataCanSendAfter, Ir as initDataCanSendAfterDate, qr as initDataChat, xr as initDataChatInstance, Vr as initDataChatType, Nr as initDataHash, Dr as initDataQueryId, Lr as initDataRaw, Rr as initDataReceiver, Fr as initDataStartParam, Or as initDataState, Ur as initDataUser, Qu as invoice, z as invokeCustomMethod, Du as isAccessDeniedError, ar as isAuthenticatingBiometry, xn as isBackButtonMounted, Nn as isBackButtonSupported, Vn as isBackButtonVisible, Gn as isBiometryAvailable, tr as isBiometryMounted, Zn as isBiometryMounting, Wn as isBiometrySupported, Tu as isCSSVarsBoundError, rp as isCancelledError, Sl as isCheckingHomeScreenStatus, Ro as isClosingBehaviorMounted, br as isClosingConfirmationEnabled, $r as isCloudStorageSupported, Zo as isColorDark, xu as isConcurrentCallError, Qs as isFullscreen, Hu as isFullscreenFailedError, qu as isFunctionNotAvailableError, Br as isHapticFeedbackSupported, Vu as isInvalidArguments, Iu as isInvalidEnvError, ap as isInvalidLaunchParamsError, Jr as isInvoiceOpened, zr as isInvoiceSupported, ip as isInvokeCustomMethodError, cp as isLaunchParamsRetrieveError, sa as isLocationManagerAccessGranted, na as isLocationManagerAccessRequested, oa as isLocationManagerAvailable, fa as isLocationManagerMounted, da as isLocationManagerMounting, ta as isLocationManagerSupported, Ha as isMainButtonEnabled, La as isMainButtonLoaderVisible, os as isMainButtonMounted, Ra as isMainButtonVisible, up as isMethodMethodParameterUnsupportedError, lp as isMethodUnsupportedError, li as isMiniAppActive, ci as isMiniAppCssVarsBound, ui as isMiniAppDark, Ei as isMiniAppMounted, bi as isMiniAppMounting, pi as isMiniAppSupported, ku as isNotAvailableError, yi as isPopupOpened, ki as isPopupShown, Mi as isPopupSupported, ji as isQrScannerOpened, xi as isQrScannerSupported, Ap as isRGB, vp as isRGBShort, mr as isRequestingBiometryAccess, Pl as isRequestingContact, il as isRequestingEmojiStatusAccess, Sa as isRequestingLocation, Al as isRequestingPhoneAccess, Il as isRequestingWriteAccess, so as isSSR, zi as isSecondaryButtonEnabled, Wi as isSecondaryButtonLoaderVisible, Ms as isSecondaryButtonMounted, Ji as isSecondaryButtonSupported, Qi as isSecondaryButtonVisible, Nu as isSetEmojiStatusError, pl as isSettingEmojiStatus, ac as isSettingsButtonMounted, ic as isSettingsButtonSupported, rc as isSettingsButtonVisible, Lu as isShareMessageError, _c as isSwipeBehaviorMounted, fc as isSwipeBehaviorSupported, pp as isTMA, Ma as isThemeParamsCssVarsBound, Ta as isThemeParamsDark, si as isThemeParamsMounted, ti as isThemeParamsMounting, dp as isTimeoutError, mp as isUnknownEnvError, Ru as isUnknownThemeParamsKeyError, hc as isVerticalSwipesEnabled, xc as isViewportCssVarsBound, Cc as isViewportExpanded, Ic as isViewportMounted, kc as isViewportMounting, $c as isViewportStable, Ku as locationManager, ma as locationManagerMountError, pa as locationManagerMountPromise, Yu as mainButton, Na as mainButtonBackgroundColor, Da as mainButtonHasShineEffect, bt as mainButtonState, ja as mainButtonText, Fa as mainButtonTextColor, Zu as miniApp, ri as miniAppBackgroundColor, $t as miniAppBackgroundColorRGB, ai as miniAppBottomBarColor, Mt as miniAppBottomBarColorRGB, ii as miniAppHeaderColor, ps as miniAppHeaderColorRGB, gi as miniAppMountError, bs as miniAppMountPromise, wi as miniAppReady, ds as miniAppState, _p as mockTelegramEnv, Hn as mountBackButton, Xn as mountBiometry, Do as mountBiometryPromise, wr as mountClosingBehavior, la as mountLocationManager, za as mountMainButton, hi as mountMiniApp, Si as mountMiniAppSync, ec as mountSecondaryButton, uc as mountSettingsButton, Sc as mountSwipeBehavior, is as mountThemeParams, us as mountThemeParamsSync, Tc as mountViewport, fp as off, _l as offAddToHomeScreenFailed, hl as offAddedToHomeScreen, Rn as offBackButtonClick, Qa as offMainButtonClick, oc as offSecondaryButtonClick, pc as offSettingsButtonClick, hp as on, ml as onAddToHomeScreenFailed, fl as onAddedToHomeScreen, Ln as onBackButtonClick, Wa as onMainButtonClick, tc as onSecondaryButtonClick, lc as onSettingsButtonClick, cr as openBiometrySettings, Xr as openInvoice, ea as openInvoiceError, Zr as openInvoicePromise, Cl as openLink, Ca as openLocationManagerSettings, Ai as openPopup, Bi as openPopupError, vi as openPopupPromise, Ri as openQrScanner, Fi as openQrScannerError, $s as openQrScannerPromise, nu as openTelegramLink, yp as parseInitDataQuery, Bp as parseLaunchParamsQuery, Ju as popup, i as postEvent, bp as postMessage, gp as postMessageImplementation, el as qrScanner, Dl as readTextFromClipboard, p as request, zn as requestBiometry, dr as requestBiometryAccess, _r as requestBiometryAccessError, Lo as requestBiometryAccessPromise, yl as requestContact, _u as requestContactComplete, Tl as requestContactError, Bl as requestContactPromise, lo as requestContentSafeAreaInsets, rl as requestEmojiStatusAccess, cl as requestEmojiStatusAccessError, al as requestEmojiStatusAccessPromise, Uc as requestFullscreen, Ea as requestLocation, wa as requestLocationError, Xo as requestLocationPromise, lu as requestPhoneAccess, vl as requestPhoneAccessError, Ml as requestPhoneAccessPromise, po as requestSafeAreaInsets, Ac as requestViewport, kl as requestWriteAccess, ql as requestWriteAccessError, Ol as requestWriteAccessPromise, jr as restoreInitData, Ep as retrieveLaunchParams, Sp as retrieveRawInitData, wp as retrieveRawLaunchParams, Fl as safeCall, tl as secondaryButton, Ui as secondaryButtonBackgroundColor, Gi as secondaryButtonHasShineEffect, Ki as secondaryButtonPosition, Vt as secondaryButtonState, Yi as secondaryButtonText, Xi as secondaryButtonTextColor, Hl as sendData, Pp as serializeInitDataQuery, Tp as serializeLaunchParamsQuery, kp as serializeToQuery, vr as setCloudStorageItem, Pu as setDebug, ul as setEmojiStatus, dl as setEmojiStatusError, ll as setEmojiStatusPromise, Ka as setMainButtonParams, Pt as setMiniAppBackgroundColor, Tt as setMiniAppBottomBarColor, kt as setMiniAppHeaderColor, sc as setSecondaryButtonParams, ol as settingsButton, Ll as shareMessage, Rl as shareStory, $l as shareURL, jn as showBackButton, Pi as showPopup, Oi as showPopupError, Ti as showPopupPromise, dc as showSettingsButton, Cp as supports, sl as swipeBehavior, jl as switchInlineQuery, $p as targetOrigin, Xu as themeParams, Aa as themeParamsAccentTextColor, Jo as themeParamsBackgroundColor, va as themeParamsBottomBarBgColor, ht as themeParamsButtonColor, es as themeParamsButtonTextColor, ya as themeParamsDestructiveTextColor, Ba as themeParamsHeaderBackgroundColor, Pa as themeParamsHintColor, ka as themeParamsLinkColor, oi as themeParamsMountError, cs as themeParamsMountPromise, ts as themeParamsSecondaryBackgroundColor, Oa as themeParamsSectionBackgroundColor, Ia as themeParamsSectionHeaderTextColor, qa as themeParamsSectionSeparatorColor, Q as themeParamsState, Va as themeParamsSubtitleTextColor, xa as themeParamsTextColor, Op as toRGB, Ip as transformQueryUsing, Fn as unmountBackButton, fr as unmountBiometry, Cr as unmountClosingBehavior, $a as unmountLocationManager, Ya as unmountMainButton, Ci as unmountMiniApp, nc as unmountSecondaryButton, mc as unmountSettingsButton, wc as unmountSwipeBehavior, ni as unmountThemeParams, qc as unmountViewport, hr as updateBiometryToken, nl as viewport, Os as viewportContentSafeAreaInsetBottom, Is as viewportContentSafeAreaInsetLeft, qs as viewportContentSafeAreaInsetRight, Vs as viewportContentSafeAreaInsetTop, zt as viewportContentSafeAreaInsets, Ut as viewportHeight, Oc as viewportMountError, zs as viewportMountPromise, xs as viewportSafeAreaInsetBottom, Ns as viewportSafeAreaInsetLeft, Ds as viewportSafeAreaInsetRight, Hs as viewportSafeAreaInsetTop, Wt as viewportSafeAreaInsets, Gt as viewportStableHeight, Ts as viewportState, ks as viewportWidth, l as wrapSafe };","map":{"version":3,"names":["G","e","t","gn","c","bn","u","o","vo","Qe","Bu","fn","bgColor","textColor","shouldLog","Pu","cn","je","yo","dn","oo","le","tgWebAppPlatform","tgWebAppVersion","k","Tn","postEvent","launchParams","wo","set","un","Bo","toString","z","ln","i","p","request","pn","v","oe","H","ot","Tu","A","Po","ku","Ou","Iu","Z","qu","y","Vu","cause","kn","xu","On","Nu","To","Du","In","Hu","qn","Lu","st","Ru","so","window","l","isSupported","s","isMounted","n","isMounting","r","component","a","supports","m","Y","P","Array","isArray","X","g","_","T","F","any","V","map","filter","Boolean","length","rn","_e","Kt","Yt","Xt","Zt","Jt","Object","assign","an","isAvailable","ifAvailable","Ce","O","C","$e","ko","Me","no","Vn","he","xn","Nn","Oo","nt","Dn","rt","Hn","w","S","is_visible","M","Ln","d","Rn","E","jn","Fn","b","promise","error","f","reject","se","catch","finally","pe","resolve","then","at","Un","available","type","accessGranted","accessRequested","deviceId","tokenSaved","Gn","ro","zn","Io","En","W","cancel","re","Ae","it","qo","ve","ct","Vo","token_saved","device_id","access_requested","access_granted","Wn","Qn","Kn","Yn","xo","abortSignal","No","ut","Xn","Do","Zn","Jn","er","tr","or","sr","nr","params","reason","trim","token","rr","Ho","ar","ir","cr","ur","lr","pr","dr","Lo","mr","_r","fr","forEach","hr","status","Fu","freeze","defineProperty","ye","I","Be","ao","br","Ke","Ro","jo","gr","Er","lt","Sr","wr","need_confirmation","Cr","Fo","de","$r","Uo","keys","Mr","reduce","ne","Cn","$","Ar","Go","wn","vr","key","value","yr","Gu","me","pt","Br","Pr","impact_style","Tr","notification_type","kr","zu","zo","Or","B","Wo","Qo","Ir","Date","getTime","qr","Vr","xr","Nr","Dr","Hr","Lr","Rr","jr","tgWebAppData","mn","Fr","Ur","Wu","dt","Gr","zr","Wr","hostname","pathname","URL","location","href","match","slug","capture","Qr","Kr","Yr","Xr","Zr","Jr","ea","Qu","J","mt","io","be","_t","ta","oa","sa","na","ra","aa","ia","ca","Ko","Yo","ua","la","pa","da","ma","_a","fa","ha","ba","ga","Ea","Xo","Sa","wa","Ca","$a","ft","Zo","yn","Math","sqrt","parseInt","slice","Fe","Ma","N","Q","h","Aa","Jo","ht","es","va","ya","Ba","Pa","Ta","ka","ts","Oa","Ia","qa","Va","xa","L","bt","ee","hasShineEffect","isEnabled","isLoaderVisible","isVisible","text","backgroundColor","Ye","os","Na","Da","Ha","La","Ra","ja","Fa","Ua","ss","Pe","gt","Ga","za","Wa","Qa","Ka","color","has_shine_effect","is_active","is_progress_visible","text_color","Ya","Et","document","documentElement","style","setProperty","St","removeProperty","U","wt","ns","Ct","onThemeChanged","theme_params","Xa","rs","Za","as","tgWebAppThemeParams","Ja","ei","hn","entries","sub","unsub","is","ti","cs","oi","Xe","si","us","ni","ls","Te","we","ae","ri","$t","ie","ai","Mt","ce","ii","ps","Ue","ci","ui","ke","li","ds","bottomBarColor","headerColor","isActive","Xu","ge","Ee","x","At","D","vt","pi","some","yt","Ie","Bt","di","ms","mi","_s","Pt","Tt","kt","fs","hs","Oe","_i","tt","bind","Co","fi","return_back","hi","bi","bs","gi","Ze","Ei","Si","wi","color_key","rgb","Ci","$i","message","title","buttons","id","Ot","gs","Mi","Es","It","Ss","button_id","Ai","vi","yi","Bi","Pi","Ti","ki","Oi","Ju","ws","qt","Ii","qi","Cs","Vi","$s","xi","Ni","onCaptured","data","Sn","Di","Hi","Li","Ri","ji","Fi","el","q","Vt","te","position","Je","Ms","Ui","Gi","zi","Wi","Qi","Ki","Yi","Xi","qe","As","Ve","xt","Zi","Ji","ec","tc","oc","sc","nc","xe","vs","Ne","co","rc","Se","ac","ic","Nt","ys","cc","Dt","uc","lc","pc","dc","mc","De","He","ue","_c","fc","et","hc","bc","Bs","gc","Ht","Ec","Sc","allow_vertical_swipe","wc","R","Lt","Rt","jt","Ft","Ps","uo","left","top","bottom","right","Ge","max","ze","Ts","contentSafeAreaInsets","height","isExpanded","isFullscreen","safeAreaInsets","stableHeight","width","j","Ut","Gt","ks","Cc","$c","K","Mc","Le","zt","Os","Is","qs","Vs","Re","Wt","xs","Ns","Ds","Hs","Ls","Rs","lo","Ac","po","js","is_expanded","is_state_stable","Fs","is_fullscreen","Us","Gs","vc","yc","Bc","Pc","all","tgWebAppFullscreen","includes","innerHeight","innerWidth","Tc","zs","kc","Oc","Qt","Ic","qc","Vc","We","xc","Nc","update","push","Dc","Ws","Hc","Qs","Lc","Rc","jc","Fc","Ks","Uc","Gc","nl","Ys","zc","Wc","Qc","rl","al","il","cl","Xs","Kc","Yc","Xc","custom_emoji_id","duration","ul","ll","pl","dl","Zc","Zs","ml","_l","Js","en","fl","hl","mo","bl","tn","Jc","eu","tu","gl","El","Sl","wl","ou","Cl","url","try_browser","tryBrowser","try_instant_view","tryInstantView","_o","su","nu","path_full","search","ru","$l","URLSearchParams","replace","au","timeout","on","iu","cu","uu","lu","Ml","Al","vl","sn","fo","raw","parsed","fe","$n","Mn","Bn","to","contact","Pn","user_id","$o","phone_number","first_name","last_name","An","auth_date","Mo","Number","Ao","hash","pu","du","mu","eo","isAborted","_u","yl","Bl","Pl","Tl","nn","fu","hu","bu","kl","Ol","Il","ql","gu","createElement","body","appendChild","focus","select","execCommand","removeChild","Vl","clipboard","navigator","writeText","ho","xl","file_name","Nl","vn","bo","Dl","req_id","_n","go","Hl","size","Blob","Eo","Ll","So","Rl","media_url","widget_link","widgetLink","Eu","jl","query","chat_types","tgWebAppBotInline","Fl","Ul","reload","acceptCustomStyles","head","innerHTML","reload_supported"],"sources":["/home/leabrun/python_/KWORK/dj/front/node_modules/@telegram-apps/sdk/src/signals-registry.ts","/home/leabrun/python_/KWORK/dj/front/node_modules/@telegram-apps/sdk/src/debug.ts","/home/leabrun/python_/KWORK/dj/front/node_modules/@telegram-apps/sdk/src/globals.ts","/home/leabrun/python_/KWORK/dj/front/node_modules/@telegram-apps/sdk/src/scopes/createIsSupported.ts","/home/leabrun/python_/KWORK/dj/front/node_modules/@telegram-apps/sdk/src/errors.ts","/home/leabrun/python_/KWORK/dj/front/node_modules/@telegram-apps/sdk/src/utils/isSSR.ts","/home/leabrun/python_/KWORK/dj/front/node_modules/@telegram-apps/sdk/src/scopes/wrappers/wrapSafe.ts","/home/leabrun/python_/KWORK/dj/front/node_modules/@telegram-apps/sdk/src/scopes/wrappers/createWrapSafe.ts","/home/leabrun/python_/KWORK/dj/front/node_modules/@telegram-apps/sdk/src/scopes/wrappers/createWrapComplete.ts","/home/leabrun/python_/KWORK/dj/front/node_modules/@telegram-apps/sdk/src/scopes/wrappers/createWrapSupported.ts","/home/leabrun/python_/KWORK/dj/front/node_modules/@telegram-apps/sdk/src/scopes/components/back-button/back-button.ts","/home/leabrun/python_/KWORK/dj/front/node_modules/@telegram-apps/sdk/src/scopes/defineNonConcurrentFn.ts","/home/leabrun/python_/KWORK/dj/front/node_modules/@telegram-apps/sdk/src/scopes/defineMountFn.ts","/home/leabrun/python_/KWORK/dj/front/node_modules/@telegram-apps/sdk/src/scopes/components/biometry/signals.ts","/home/leabrun/python_/KWORK/dj/front/node_modules/@telegram-apps/sdk/src/scopes/components/biometry/requestBiometry.ts","/home/leabrun/python_/KWORK/dj/front/node_modules/@telegram-apps/sdk/src/utils/ignoreCanceled.ts","/home/leabrun/python_/KWORK/dj/front/node_modules/@telegram-apps/sdk/src/scopes/signalCancel.ts","/home/leabrun/python_/KWORK/dj/front/node_modules/@telegram-apps/sdk/src/scopes/components/biometry/methods.ts","/home/leabrun/python_/KWORK/dj/front/node_modules/@telegram-apps/sdk/src/scopes/wrappers/createWrapMounted.ts","/home/leabrun/python_/KWORK/dj/front/node_modules/@telegram-apps/sdk/src/scopes/wrappers/createWrapBasic.ts","/home/leabrun/python_/KWORK/dj/front/node_modules/@telegram-apps/sdk/src/scopes/components/closing-behavior/closing-behavior.ts","/home/leabrun/python_/KWORK/dj/front/node_modules/@telegram-apps/sdk/src/scopes/components/cloud-storage/cloud-storage.ts","/home/leabrun/python_/KWORK/dj/front/node_modules/@telegram-apps/sdk/src/scopes/components/haptic-feedback/haptic-feedback.ts","/home/leabrun/python_/KWORK/dj/front/node_modules/@telegram-apps/sdk/src/scopes/components/init-data/init-data.ts","/home/leabrun/python_/KWORK/dj/front/node_modules/@telegram-apps/sdk/src/scopes/components/invoice/invoice.ts","/home/leabrun/python_/KWORK/dj/front/node_modules/@telegram-apps/sdk/src/scopes/components/location-manager/location-manager.ts","/home/leabrun/python_/KWORK/dj/front/node_modules/@telegram-apps/sdk/src/utils/removeUndefined.ts","/home/leabrun/python_/KWORK/dj/front/node_modules/@telegram-apps/sdk/src/utils/isColorDark.ts","/home/leabrun/python_/KWORK/dj/front/node_modules/@telegram-apps/sdk/src/scopes/components/theme-params/signals.ts","/home/leabrun/python_/KWORK/dj/front/node_modules/@telegram-apps/sdk/src/scopes/components/main-button/signals.ts","/home/leabrun/python_/KWORK/dj/front/node_modules/@telegram-apps/sdk/src/scopes/components/main-button/methods.ts","/home/leabrun/python_/KWORK/dj/front/node_modules/@telegram-apps/sdk/src/utils/css-vars.ts","/home/leabrun/python_/KWORK/dj/front/node_modules/@telegram-apps/sdk/src/scopes/components/theme-params/methods.ts","/home/leabrun/python_/KWORK/dj/front/node_modules/@telegram-apps/sdk/src/scopes/components/mini-app/utils.ts","/home/leabrun/python_/KWORK/dj/front/node_modules/@telegram-apps/sdk/src/scopes/components/mini-app/signals.ts","/home/leabrun/python_/KWORK/dj/front/node_modules/@telegram-apps/sdk/src/scopes/components/mini-app/methods.ts","/home/leabrun/python_/KWORK/dj/front/node_modules/@telegram-apps/sdk/src/scopes/components/popup/prepareParams.ts","/home/leabrun/python_/KWORK/dj/front/node_modules/@telegram-apps/sdk/src/scopes/components/popup/popup.ts","/home/leabrun/python_/KWORK/dj/front/node_modules/@telegram-apps/sdk/src/scopes/components/qr-scanner/qr-scanner.ts","/home/leabrun/python_/KWORK/dj/front/node_modules/@telegram-apps/sdk/src/scopes/components/secondary-button/signals.ts","/home/leabrun/python_/KWORK/dj/front/node_modules/@telegram-apps/sdk/src/scopes/components/secondary-button/methods.ts","/home/leabrun/python_/KWORK/dj/front/node_modules/@telegram-apps/sdk/src/scopes/components/settings-button/settings-button.ts","/home/leabrun/python_/KWORK/dj/front/node_modules/@telegram-apps/sdk/src/scopes/components/swipe-behavior/swipe-behavior.ts","/home/leabrun/python_/KWORK/dj/front/node_modules/@telegram-apps/sdk/src/scopes/components/viewport/const.ts","/home/leabrun/python_/KWORK/dj/front/node_modules/@telegram-apps/sdk/src/scopes/components/viewport/wrappers.ts","/home/leabrun/python_/KWORK/dj/front/node_modules/@telegram-apps/sdk/src/scopes/components/viewport/signals.ts","/home/leabrun/python_/KWORK/dj/front/node_modules/@telegram-apps/sdk/src/scopes/components/viewport/static.ts","/home/leabrun/python_/KWORK/dj/front/node_modules/@telegram-apps/sdk/src/scopes/components/viewport/mounting.ts","/home/leabrun/python_/KWORK/dj/front/node_modules/@telegram-apps/sdk/src/scopes/components/viewport/css-vars.ts","/home/leabrun/python_/KWORK/dj/front/node_modules/@telegram-apps/sdk/src/scopes/components/viewport/expand.ts","/home/leabrun/python_/KWORK/dj/front/node_modules/@telegram-apps/sdk/src/scopes/components/viewport/fullscreen.ts","/home/leabrun/python_/KWORK/dj/front/node_modules/@telegram-apps/sdk/src/scopes/utilities/emoji-status/requestEmojiStatusAccess.ts","/home/leabrun/python_/KWORK/dj/front/node_modules/@telegram-apps/sdk/src/scopes/utilities/emoji-status/setEmojiStatus.ts","/home/leabrun/python_/KWORK/dj/front/node_modules/@telegram-apps/sdk/src/scopes/utilities/home-screen/add-to-home-screen-failed.ts","/home/leabrun/python_/KWORK/dj/front/node_modules/@telegram-apps/sdk/src/scopes/utilities/home-screen/added-to-home-screen.ts","/home/leabrun/python_/KWORK/dj/front/node_modules/@telegram-apps/sdk/src/scopes/utilities/home-screen/addToHomeScreen.ts","/home/leabrun/python_/KWORK/dj/front/node_modules/@telegram-apps/sdk/src/scopes/utilities/home-screen/checkHomeScreenStatus.ts","/home/leabrun/python_/KWORK/dj/front/node_modules/@telegram-apps/sdk/src/scopes/utilities/links/openLink.ts","/home/leabrun/python_/KWORK/dj/front/node_modules/@telegram-apps/sdk/src/scopes/utilities/links/openTelegramLink.ts","/home/leabrun/python_/KWORK/dj/front/node_modules/@telegram-apps/sdk/src/scopes/utilities/links/shareURL.ts","/home/leabrun/python_/KWORK/dj/front/node_modules/@telegram-apps/sdk/src/utils/sleep.ts","/home/leabrun/python_/KWORK/dj/front/node_modules/@telegram-apps/sdk/src/scopes/utilities/privacy/requestPhoneAccess.ts","/home/leabrun/python_/KWORK/dj/front/node_modules/@telegram-apps/sdk/src/scopes/utilities/privacy/requestContact.ts","/home/leabrun/python_/KWORK/dj/front/node_modules/@telegram-apps/sdk/src/scopes/utilities/privacy/requestWriteAccess.ts","/home/leabrun/python_/KWORK/dj/front/node_modules/@telegram-apps/sdk/src/scopes/utilities/uncategorized/copyTextToClipboard.ts","/home/leabrun/python_/KWORK/dj/front/node_modules/@telegram-apps/sdk/src/scopes/utilities/uncategorized/downloadFile.ts","/home/leabrun/python_/KWORK/dj/front/node_modules/@telegram-apps/sdk/src/scopes/utilities/uncategorized/getCurrentTime.ts","/home/leabrun/python_/KWORK/dj/front/node_modules/@telegram-apps/sdk/src/scopes/utilities/uncategorized/readTextFromClipboard.ts","/home/leabrun/python_/KWORK/dj/front/node_modules/@telegram-apps/sdk/src/scopes/utilities/uncategorized/sendData.ts","/home/leabrun/python_/KWORK/dj/front/node_modules/@telegram-apps/sdk/src/scopes/utilities/uncategorized/shareMessage.ts","/home/leabrun/python_/KWORK/dj/front/node_modules/@telegram-apps/sdk/src/scopes/utilities/uncategorized/shareStory.ts","/home/leabrun/python_/KWORK/dj/front/node_modules/@telegram-apps/sdk/src/scopes/utilities/uncategorized/switchInlineQuery.ts","/home/leabrun/python_/KWORK/dj/front/node_modules/@telegram-apps/sdk/src/utils/safeCall.ts","/home/leabrun/python_/KWORK/dj/front/node_modules/@telegram-apps/sdk/src/init.ts"],"sourcesContent":["import {\n  computed,\n  type Computed,\n  type Signal,\n  signal,\n  type SignalOptions,\n} from '@telegram-apps/signals';\n\nexport type SignalsTuple<T> = [Signal<T>, Computed<T>];\n\nconst signals: (Signal<any> | Computed<any>)[] = [];\n\n/**\n * Creates a new signal with the initial value.\n * @param initialValue - the initial value.\n * @param options - additional options.\n */\nexport function createSignal<T>(\n  initialValue: T,\n  options?: SignalOptions<T>,\n): Signal<T>;\n\n/**\n * Creates a new signal without the initial value.\n * @param initialValue - the initial value.\n * @param options - additional options.\n */\nexport function createSignal<T>(\n  initialValue?: T,\n  options?: SignalOptions<T | undefined>,\n): Signal<T | undefined>;\n\n// #__NO_SIDE_EFFECTS__\nexport function createSignal<T>(\n  initialValue?: T,\n  options?: SignalOptions<T | undefined>,\n): Signal<T | undefined> {\n  const s = signal(initialValue, options);\n  signals.push(s);\n  return s;\n}\n\n/**\n * Creates a signal, which wil be automatically updated if some of its dependant signals were\n * modified.\n * @param fn - computation function.\n * @param options - additional functions.\n */\n// #__NO_SIDE_EFFECTS__\nexport function createComputed<T>(fn: (prev?: T) => T, options?: SignalOptions<T>): Computed<T> {\n  const s = computed(fn, options);\n  signals.push(s);\n  return s;\n}\n\n/**\n * Resets all signals states.\n */\nexport function resetSignals() {\n  signals.forEach(s => {\n    s.unsubAll();\n    'reset' in s && s.reset();\n  });\n}\n\n/**\n * @returns A tuple, containing a manual and computed signals. The computed signal is based on\n * the manual one.\n * @param initialValue - the initial value.\n * @param options - additional options.\n */\nexport function createSignalsTuple<T>(\n  initialValue: T,\n  options?: SignalOptions<T>,\n): SignalsTuple<T>;\n\n/**\n * @returns A tuple, containing a manual and computed signals. The computed signal is based on\n * the manual one.\n * @param initialValue - an initial value.\n * @param options - additional options.\n */\nexport function createSignalsTuple<T>(\n  initialValue?: T,\n  options?: SignalOptions<T | undefined>,\n): SignalsTuple<T | undefined>;\n\n// #__NO_SIDE_EFFECTS__\nexport function createSignalsTuple<T>(\n  initialValue?: T,\n  options?: SignalOptions<T | undefined>,\n): SignalsTuple<T | undefined> {\n  const s = createSignal(initialValue, options);\n  return [s, createComputed(s)];\n}","import { setDebug as setBridgeDebug } from '@telegram-apps/bridge';\nimport { createLogger } from '@telegram-apps/toolkit';\n\n/**\n * The package debug mode.\n *\n * Enabling debug mode leads to printing additional messages in the console related to the\n * processes inside the package.\n */\nlet debug = false;\n\nexport const [logInfo, logError] = createLogger('SDK', {\n  bgColor: 'forestgreen',\n  textColor: 'white',\n  shouldLog() {\n    return debug;\n  },\n});\n\n/**\n * Sets the package debug mode leading to outputting additional logs.\n * @param value - enable debug mode.\n */\nexport function setDebug(value: boolean): void {\n  debug = value;\n  setBridgeDebug(value);\n}","import {\n  retrieveLaunchParams,\n  postEvent as _postEvent,\n  request as _request,\n  invokeCustomMethod as _invokeCustomMethod,\n  createPostEvent,\n  type PostEventFn,\n  type RequestFn,\n  type InvokeCustomMethodOptions,\n  type CustomMethodParams,\n  type CustomMethodName,\n} from '@telegram-apps/bridge';\nimport type { AbortablePromise } from 'better-promises';\nimport type { LaunchParamsLike } from '@telegram-apps/transformers';\n\nimport { createComputed, createSignal, createSignalsTuple } from '@/signals-registry.js';\nimport { logInfo } from '@/debug.js';\n\n/**\n * Launch parameters stored in the package state.\n */\nexport type PackageLaunchParams =\n  & Omit<LaunchParamsLike, 'tgWebAppThemeParams'>\n  & Partial<Pick<LaunchParamsLike, 'tgWebAppThemeParams'>>;\n\nexport interface ConfigureOptions {\n  /**\n   * Launch parameters used across the package.\n   * @default Being extracted using the `retrieveLaunchParams` function.\n   * @see retrieveLaunchParams\n   */\n  launchParams?: PackageLaunchParams;\n  /**\n   * Custom postEvent function.\n   * @default The `createPostEvent` function will be used with the version, specified in\n   * the `launchParams` option.\n   * @see createPostEvent\n   */\n  postEvent?: PostEventFn;\n}\n\nconst $lastRequestId = createSignal(0);\nexport const $postEvent = createSignal<PostEventFn>(_postEvent);\nexport const [_$launchParams, $launchParams] = createSignalsTuple<PackageLaunchParams>({\n  tgWebAppPlatform: 'unknown',\n  tgWebAppVersion: '0.0',\n});\n\nexport const version = createComputed(() => $launchParams().tgWebAppVersion);\n\n/**\n * Configures package global dependencies.\n * @param options - configuration additional options.\n */\nexport function configure(options?: ConfigureOptions): void {\n  options ||= {};\n  const { postEvent } = options;\n  const lp = options.launchParams || retrieveLaunchParams();\n  _$launchParams.set(lp);\n  $postEvent.set(\n    typeof postEvent === 'function'\n      ? postEvent\n      : createPostEvent(lp.tgWebAppVersion),\n  );\n  logInfo(false, 'The package was configured. Launch params:', _$launchParams());\n}\n\n/**\n * @returns A new request identifier.\n */\nexport function createRequestId(): string {\n  $lastRequestId.set($lastRequestId() + 1);\n  return $lastRequestId().toString();\n}\n\n/**\n * Invokes known custom method. Returns method execution result.\n * @param method - method name.\n * @param params - method parameters.\n * @param options - additional options.\n * @throws {InvokeCustomMethodError} Invocation completed with some error.\n */\nexport function invokeCustomMethod<M extends CustomMethodName>(\n  method: M,\n  params: CustomMethodParams<M>,\n  options?: InvokeCustomMethodOptions,\n): AbortablePromise<unknown>;\n\n/**\n * Invokes unknown custom method. Returns method execution result.\n * @param method - method name.\n * @param params - method parameters.\n * @param options - additional options.\n * @throws {InvokeCustomMethodError} Invocation completed with some error.\n */\nexport function invokeCustomMethod(\n  method: string,\n  params: object,\n  options?: InvokeCustomMethodOptions,\n): AbortablePromise<unknown>;\n\nexport function invokeCustomMethod(\n  method: string,\n  params: object,\n  options?: InvokeCustomMethodOptions,\n): AbortablePromise<unknown> {\n  return _invokeCustomMethod(method, params, createRequestId(), {\n    ...options || {},\n    postEvent: postEvent,\n  });\n}\n\n/**\n * `request` function from the bridge with applied global `postEvent` option.\n */\nexport const request = ((method: any, eventOrEvents: any, options: any) => {\n  options ||= {};\n  options.postEvent ||= postEvent;\n  return _request(method, eventOrEvents, options);\n}) as RequestFn;\n\n/**\n * Shortcut for $postEvent call.\n */\nexport const postEvent = ((method: any, params: any) => {\n  return $postEvent()(method, params);\n}) as PostEventFn;\n","import { type Computed } from '@telegram-apps/signals';\nimport { type MethodName, supports } from '@telegram-apps/bridge';\n\nimport { version } from '@/globals.js';\nimport { createComputed } from '@/signals-registry.js';\n\n/**\n * @returns A signal indicating if the specified Mini Apps method is supported.\n * @param method - Mini Apps method name\n */\nexport function createIsSupported(method: MethodName): Computed<boolean> {\n  return createComputed(() => supports(method, version()));\n}","import { errorClass } from 'error-kid';\n\nfunction proxyMessage(message?: string): [string?] {\n  return [message];\n}\n\nexport const [\n  CSSVarsBoundError,\n  isCSSVarsBoundError,\n] = errorClass('CSSVarsBoundError', 'CSS variables are already bound');\n\nexport const [\n  NotAvailableError,\n  isNotAvailableError,\n] = errorClass<[message: string]>('NotAvailableError', proxyMessage);\n\nexport const [\n  InvalidEnvError,\n  isInvalidEnvError,\n] = errorClass<[message?: string]>('InvalidEnvError', proxyMessage);\n\nexport const [\n  FunctionUnavailableError,\n  isFunctionNotAvailableError,\n] = errorClass<[message?: string]>('FunctionNotAvailableError', proxyMessage);\n\nexport const [\n  InvalidArgumentsError,\n  isInvalidArguments,\n] = errorClass<[message: string, cause?: unknown]>(\n  'InvalidArgumentsError',\n  (message, cause) => [message, { cause }],\n);\n\nexport const [\n  ConcurrentCallError,\n  isConcurrentCallError,\n] = errorClass<[message: string]>('ConcurrentCallError', proxyMessage);\n\nexport const [\n  SetEmojiStatusError,\n  isSetEmojiStatusError,\n] = errorClass<[error: string]>(\n  'SetEmojiStatusError',\n  error => [`Failed to set emoji status: ${error}`],\n);\n\nexport const [\n  AccessDeniedError,\n  isAccessDeniedError,\n] = errorClass<[message: string]>('AccessDeniedError', proxyMessage);\n\nexport const [\n  FullscreenFailedError,\n  isFullscreenFailedError,\n] = errorClass<[message: string]>('FullscreenFailedError', proxyMessage);\n\nexport const [\n  ShareMessageError,\n  isShareMessageError,\n] = errorClass<[error: string]>('ShareMessageError', proxyMessage);\n\nexport const [\n  UnknownThemeParamsKeyError,\n  isUnknownThemeParamsKeyError,\n] = errorClass<[key: string]>('UnknownThemeParamsKeyError', key => {\n  return [`Unknown theme params key passed: ${key}`];\n});","/**\n * @returns True, if current environment is server.\n */\nexport function isSSR(): boolean {\n  return typeof window === 'undefined';\n}\n","import {\n  type MethodName,\n  supports,\n  isTMA,\n  type MethodNameWithVersionedParams,\n  type MethodVersionedParams,\n} from '@telegram-apps/bridge';\nimport type { Computed } from '@telegram-apps/signals';\nimport type { If, IsNever } from '@telegram-apps/toolkit';\n\nimport { version } from '@/globals.js';\nimport { FunctionUnavailableError } from '@/errors.js';\nimport { isSSR } from '@/utils/isSSR.js';\nimport type { AnyFn } from '@/types.js';\nimport { createComputed } from '@/signals-registry.js';\n\nexport type CustomSupportValidatorFn = () => string | undefined;\n\nexport type IsSupportedType =\n  | MethodName\n  | CustomSupportValidatorFn\n  | (MethodName | CustomSupportValidatorFn)[]\n  | { any: (MethodName | CustomSupportValidatorFn)[] };\n\n/**\n * A map where the key is a method name with versioned parameters, and the value is a tuple\n * containing the method and parameter names. The third tuple value is a function accepting\n * the wrapped function arguments and returning true if support check must be applied.\n */\nexport type Supports<Fn extends AnyFn> = Record<string, {\n  [M in MethodNameWithVersionedParams]: [\n    method: M,\n    param: MethodVersionedParams<M>,\n    shouldCheck: (...args: Parameters<Fn>) => boolean,\n  ];\n}[MethodNameWithVersionedParams]>;\n\nexport type IfAvailableFnResult<Data> = [called: true, data: Data] | [called: false];\n\nexport type SafeWrapped<\n  Fn extends AnyFn,\n  HasSupportCheck extends boolean,\n  SupportsSchema extends Record<string, any>\n> =\n  & Fn\n  & {\n  /**\n   * The signal returning `true` if the function is available in the current environment and\n   * conditions.\n   *\n   * To be more accurate, the method checks the following:\n   * 1. The current environment is Telegram Mini Apps.\n   * 2. The SDK package is initialized.\n   * 3. If passed, the `isSupported` signal returns true.\n   * 4. If passed, the `isMounted` signal returns true.\n   *\n   * *You should use this function when possible because it provides must-have code security\n   * mechanisms and makes a developer sure that he is using the package properly.*\n   *\n   * @returns True if the function is available in the current environment.\n   * @example\n   * if (showBackButton.isAvailable()) {\n   *   showBackButton();\n   * }\n   */\n  isAvailable: Computed<boolean>;\n  /**\n   * Calls the function only in case it is available.\n   *\n   * It uses the `isAvailable` internally to check if the function is supported.\n   * @example\n   * showBackButton.ifAvailable();\n   */\n  ifAvailable(...args: Parameters<Fn>): IfAvailableFnResult<ReturnType<Fn>>;\n}\n  & If<HasSupportCheck, {\n  /**\n   * The signal returning `true` if the function is supported by the Telegram client,\n   * including some possible additional conditions.\n   *\n   * It is highly recommended to use this signal only in certain narrow cases when only the\n   * function support check is required, but not its availability.\n   *\n   * This signal is not applying additional operations like checking if the current environment\n   * is Mini Apps and the SDK is initialized.\n   *\n   * To check if the function is available for use, use the `isAvailable` signal.\n   *\n   * @returns True if this function is supported.\n   * @see isAvailable\n   * @example\n   * if (setMiniAppBottomBarColor.isSupported()) {\n   *   console.log('Mini App bottom bar is supported, but the function may be unavailable');\n   * }\n   */\n  isSupported: Computed<boolean>;\n}, {}>\n  & If<IsNever<SupportsSchema>, {}, {\n  /**\n   * A map where the key is the function-specific option name and value is a signal indicating\n   * if it is supported by the current environment.\n   * @example\n   * if (setHeaderColor.isAvailable()) {\n   *   if (setHeaderColor.supports.rgb()) {\n   *     setHeaderColor('#ffaabb');\n   *   } else {\n   *     setHeaderColor('bg_color');\n   *   }\n   * }\n   */\n  supports: Record<keyof SupportsSchema, Computed<boolean>>\n}>\n\nexport interface WrapSafeOptions<Fn extends AnyFn> {\n  /**\n   * The component name owning the wrapped function.\n   */\n  component?: string;\n  /**\n   * Signal returning true if the owning component is mounted.\n   */\n  isMounted?: () => boolean;\n  /**\n   * Signal returning true if the owning component is mounting.\n   */\n  isMounting?: () => boolean;\n  /**\n   * Value determining if the function is supported by the current environment.\n   */\n  isSupported?: IsSupportedType;\n  /**\n   * A map where the key is a method name with versioned parameters, and the value is a tuple\n   * containing the method and parameter names. The third tuple value is a function accepting\n   * the wrapped function arguments and returning true if support check must be applied.\n   */\n  supports?: Supports<Fn>,\n}\n\n/**\n * Wraps the function enhancing it with the useful utilities described in the SafeWrapped type.\n * @see SafeWrapped\n * @param method - method name\n * @param fn - wrapped function\n */\nexport function wrapSafe<Fn extends AnyFn>(method: string, fn: Fn): SafeWrapped<Fn, false, never>;\n/**\n * Wraps the function enhancing it with the useful utilities described in the SafeWrapped type.\n * @see SafeWrapped\n * @param method - method name\n * @param fn - wrapped function\n * @param options - additional options\n */\nexport function wrapSafe<Fn extends AnyFn, O extends WrapSafeOptions<Fn>>(\n  method: string,\n  fn: Fn,\n  options: O,\n): SafeWrapped<\n  Fn,\n  O extends { isSupported: any } ? true : false,\n  O extends { supports: any } ? O['supports'] : never\n>\n/*@__NO_SIDE_EFFECTS__*/\nexport function wrapSafe<Fn extends AnyFn>(\n  method: string,\n  fn: Fn,\n  options?: WrapSafeOptions<Fn>,\n): SafeWrapped<Fn, boolean, Record<string, any> | never> {\n  options ||= {};\n  const {\n    isSupported: optionsIsSupported,\n    isMounted,\n    isMounting,\n    component,\n    supports: optionSupports,\n  } = options || {};\n\n  const functionId = `${component ? `${component}.` : ''}${method}()`;\n\n  // Simplify the isSupported value to work with an array of validators or a single object.\n  const isSupported = optionsIsSupported\n    ? Array.isArray(optionsIsSupported)\n      // (MethodName | CustomSupportValidator)[]\n      ? optionsIsSupported\n      : typeof optionsIsSupported === 'object' && 'any' in optionsIsSupported\n        // { any: (MethodName | CustomSupportValidator)[] }\n        ? optionsIsSupported\n        // MethodName | CustomSupportValidator\n        : [optionsIsSupported]\n    : undefined;\n\n  /**\n   * @returns True if the specified option is supported.\n   * @param option - option name.\n   */\n  function supportsOption(option: string): boolean {\n    if (optionSupports) {\n      const tuple = optionSupports[option];\n      return supports(tuple[0], tuple[1], version());\n    }\n    return true;\n  }\n\n  /**\n   * @returns All found errors according to the isSupported variable value.\n   */\n  function supportError(): string | undefined {\n    // isSupported was not specified.\n    // In this case, we assume that the function has no dependencies and is always supported.\n    if (!isSupported) {\n      return;\n    }\n\n    function getError(item: MethodName | CustomSupportValidatorFn): string | undefined {\n      return typeof item === 'function'\n        ? item()\n        : supports(item, version())\n          ? undefined\n          : `it is unsupported in Mini Apps version ${version()}`;\n    }\n\n    const isSupportedItems = Array.isArray(isSupported) ? isSupported : isSupported.any;\n    const errors = isSupportedItems.map(getError).filter(Boolean) as string[];\n\n    return Array.isArray(isSupported)\n      // An array is passed. It means, the function is supported only in case no errors were\n      // returned.\n      ? errors[0]\n      // An object with the \"any\" property is passed.\n      // Should return nothing if at least one item didn't return an error.\n      : errors.length === isSupportedItems.length\n        ? errors[errors.length - 1]\n        : undefined;\n  }\n\n  /**\n   * @returns An error related to supports.<name> check.\n   */\n  function supportsOptionError(...args: Parameters<Fn>): string | undefined {\n    for (const k in optionSupports) {\n      if (optionSupports[k][2](...args) && !supportsOption(k)) {\n        return `option ${k} is not supported in Mini Apps version ${version()}`;\n      }\n    }\n  }\n\n  let supportsMap: Record<string, Computed<boolean>> | undefined;\n  if (optionSupports) {\n    supportsMap = {};\n    for (const option in optionSupports) {\n      supportsMap[option] = createComputed(() => supportsOption(option));\n    }\n  }\n\n  const $isSupported = createComputed(() => !supportError());\n  const $isInitialized = createComputed(() => version() !== '0.0');\n  const $isMounted = createComputed(() => !isMounted || isMounted());\n  const $isAvailable = createComputed(\n    () => isTMA()\n      && !isSSR()\n      && $isInitialized()\n      && $isSupported()\n      && $isMounted(),\n  );\n\n  return Object.assign(\n    (...args: Parameters<Fn>): ReturnType<Fn> => {\n      const errMessagePrefix = `Unable to call the ${functionId} ${component ? 'method' : 'function'}:`;\n\n      if (isSSR() || !isTMA()) {\n        throw new FunctionUnavailableError(`${errMessagePrefix} it can't be called outside Mini Apps`);\n      }\n      if (!$isInitialized()) {\n        throw new FunctionUnavailableError(`${errMessagePrefix} the SDK was not initialized. Use the SDK init() function`);\n      }\n      const supportErr = supportError();\n      if (supportErr) {\n        throw new FunctionUnavailableError(`${errMessagePrefix} ${supportErr}`);\n      }\n      const supportsOptionErr = supportsOptionError(...args);\n      if (supportsOptionErr) {\n        throw new FunctionUnavailableError(`${errMessagePrefix} ${supportsOptionErr}`);\n      }\n      if (!$isMounted()) {\n        const message = isMounting && isMounting()\n          ? 'mounting. Wait for the mount completion'\n          : `unmounted. Use the ${component}.mount() method`;\n        throw new FunctionUnavailableError(`${errMessagePrefix} the component is ${message}`);\n      }\n      return fn(...args);\n    },\n    fn,\n    {\n      isAvailable: $isAvailable,\n      ifAvailable(...args: Parameters<Fn>): IfAvailableFnResult<ReturnType<Fn>> {\n        return $isAvailable() ? [true, fn(...args)] : [false];\n      },\n    },\n    isSupported ? { isSupported: $isSupported } : {},\n    supportsMap ? { supports: supportsMap } : {},\n  );\n}\n","import type { AnyFn } from '@/types.js';\nimport {\n  wrapSafe,\n  type IsSupportedType,\n  type SafeWrapped,\n  type Supports,\n} from '@/scopes/wrappers/wrapSafe.js';\n\nexport interface SafeWrapFn<S extends boolean> {\n  <Fn extends AnyFn>(method: string, fn: Fn): SafeWrapped<Fn, S, never>;\n  <Fn extends AnyFn>(method: string, fn: Fn, isSupported: IsSupportedType): SafeWrapped<Fn, true, never>;\n  <Fn extends AnyFn, S extends Supports<Fn>>(\n    method: string,\n    fn: Fn,\n    isSupported: IsSupportedType,\n    supports: S,\n  ): SafeWrapped<Fn, true, S>;\n}\n\ninterface Options {\n  isMounted?: () => boolean;\n  isSupported?: IsSupportedType;\n}\n\nexport function createWrapSafe(component?: string): SafeWrapFn<false>;\n\nexport function createWrapSafe<O extends Options>(\n  component: string,\n  options: O,\n): SafeWrapFn<O extends { isSupported: any } ? true : false>;\n\nexport function createWrapSafe(\n  component?: string,\n  options?: Options,\n): SafeWrapFn<boolean> {\n  options ||= {};\n  return ((method, fn, overrideIsSupported, supports) => wrapSafe(method, fn, {\n    ...options,\n    isSupported: overrideIsSupported || options.isSupported,\n    supports,\n    component,\n  })) as SafeWrapFn<boolean>;\n}\n","import type { IsSupportedType } from '@/scopes/wrappers/wrapSafe.js';\nimport { createWrapSafe, type SafeWrapFn } from '@/scopes/wrappers/createWrapSafe.js';\n\nexport function createWrapComplete(\n  component: string,\n  isMounted: () => boolean,\n  isSupported: IsSupportedType,\n): SafeWrapFn<true> {\n  return createWrapSafe(component, { isSupported, isMounted });\n}\n","import {\n  createWrapSafe,\n  type SafeWrapFn,\n} from '@/scopes/wrappers/createWrapSafe.js';\nimport type { IsSupportedType } from '@/scopes/wrappers/wrapSafe.js';\n\nexport function createWrapSupported(\n  component: string,\n  isSupported: IsSupportedType,\n): SafeWrapFn<true> {\n  return createWrapSafe(component, { isSupported });\n}","import { off, on, type EventListener } from '@telegram-apps/bridge';\nimport { getStorageValue, setStorageValue } from '@telegram-apps/toolkit';\nimport { isPageReload } from '@telegram-apps/navigation';\n\nimport { createSignalsTuple } from '@/signals-registry.js';\nimport { postEvent } from '@/globals.js';\nimport { createIsSupported } from '@/scopes/createIsSupported.js';\nimport { createWrapComplete } from '@/scopes/wrappers/createWrapComplete.js';\nimport { createWrapSupported } from '@/scopes/wrappers/createWrapSupported.js';\n\ntype StorageValue = boolean;\n\nconst SETUP_METHOD_NAME = 'web_app_setup_back_button';\nconst CLICK_EVENT_NAME = 'back_button_pressed';\nconst COMPONENT_NAME = 'backButton';\n\n/**\n * Signal indicating if the Back Button is currently visible.\n */\nexport const [_isVisible, isVisible] = createSignalsTuple(false);\n\n/**\n * Signal indicating if the Back Button is currently mounted.\n */\nexport const [_isMounted, isMounted] = createSignalsTuple(false);\n\n/**\n * Signal indicating if the Back Button is supported.\n */\nexport const isSupported = createIsSupported(SETUP_METHOD_NAME);\n\nconst wrapComplete = createWrapComplete(COMPONENT_NAME, _isMounted, SETUP_METHOD_NAME);\nconst wrapSupported = createWrapSupported(COMPONENT_NAME, SETUP_METHOD_NAME);\n\n/**\n * Hides the Back Button.\n * @param\n * @throws {FunctionNotAvailableError} The environment is unknown\n * @throws {FunctionNotAvailableError} The SDK is not initialized\n * @throws {FunctionNotAvailableError} The function is not supported\n * @throws {FunctionNotAvailableError} The parent component is not mounted\n * @since Mini Apps v6.1\n * @example\n * if (hide.isAvailable()) {\n *   hide();\n * }\n */\nexport const hide = wrapComplete('hide', (): void => {\n  setVisibility(false);\n});\n\n/**\n * Mounts the Back Button restoring its state.\n * @param\n * @throws {FunctionNotAvailableError} The environment is unknown\n * @throws {FunctionNotAvailableError} The SDK is not initialized\n * @throws {FunctionNotAvailableError} The function is not supported\n * @since Mini Apps v6.1\n * @example\n * if (mount.isAvailable()) {\n *   mount();\n * }\n */\nexport const mount = wrapSupported('mount', (): void => {\n  if (!_isMounted()) {\n    setVisibility(isPageReload() && getStorageValue<StorageValue>(COMPONENT_NAME) || false);\n    _isMounted.set(true);\n  }\n});\n\nfunction setVisibility(value: boolean): void {\n  if (value !== _isVisible()) {\n    postEvent(SETUP_METHOD_NAME, { is_visible: value });\n    setStorageValue<StorageValue>(COMPONENT_NAME, value);\n    _isVisible.set(value);\n  }\n}\n\n/**\n * Adds a new Back Button click listener.\n * @param fn - event listener.\n * @returns A function to remove bound listener.\n * @throws {FunctionNotAvailableError} The environment is unknown\n * @throws {FunctionNotAvailableError} The SDK is not initialized\n * @throws {FunctionNotAvailableError} The function is not supported\n * @since Mini Apps v6.1\n * @example\n * if (onClick.isAvailable()) {\n *   const off = onClick(() => {\n *     console.log('User clicked the Back Button');\n *     off();\n *   });\n * }\n */\nexport const onClick = wrapSupported(\n  'onClick',\n  (fn: EventListener<'back_button_pressed'>): VoidFunction => on(CLICK_EVENT_NAME, fn),\n);\n\n/**\n * Removes the Back Button click listener.\n * @param fn - an event listener.\n * @throws {FunctionNotAvailableError} The environment is unknown\n * @throws {FunctionNotAvailableError} The SDK is not initialized\n * @throws {FunctionNotAvailableError} The function is not supported\n * @since Mini Apps v6.1\n * @example\n * if (offClick.isAvailable()) {\n *   function listener() {\n *     console.log('User clicked the Back Button');\n *     offClick(listener);\n *   }\n *   onClick(listener);\n * }\n */\nexport const offClick = wrapSupported(\n  'offClick',\n  (fn: EventListener<'back_button_pressed'>): void => {\n    off(CLICK_EVENT_NAME, fn);\n  },\n);\n\n/**\n * Shows the Back Button.\n * @throws {FunctionNotAvailableError} The environment is unknown\n * @throws {FunctionNotAvailableError} The SDK is not initialized\n * @throws {FunctionNotAvailableError} The function is not supported\n * @throws {FunctionNotAvailableError} The parent component is not mounted\n * @since Mini Apps v6.1\n * @example\n * if (show.isAvailable()) {\n *   show();\n * }\n */\nexport const show = wrapComplete('show', (): void => {\n  setVisibility(true);\n});\n\n/**\n * Unmounts the Back Button.\n *\n * Note that this function does not remove listeners added via the `onClick`\n * function, so you have to remove them on your own.\n * @see onClick\n */\nexport function unmount(): void {\n  _isMounted.set(false);\n}\n","import { AbortablePromise } from 'better-promises';\nimport {\n  batch,\n  type Computed,\n  type Signal,\n} from '@telegram-apps/signals';\nimport { createComputed, createSignalsTuple, type SignalsTuple } from '@/signals-registry.js';\nimport { ConcurrentCallError } from '@/errors.js';\n\nexport function defineNonConcurrentFn<Fn extends (...args: any) => AbortablePromise<any>>(\n  fn: Fn,\n  errorMessage: string,\n  options?: {\n    /**\n     * A signal with the promise to use instead of the generated one.\n     */\n    promise?: Signal<AbortablePromise<Awaited<ReturnType<Fn>>> | undefined>;\n    /**\n     * A signal with the error to use instead of the generated one.\n     */\n    error?: Signal<Error | undefined>;\n  },\n): [\n  fn: Fn,\n  promise: [\n    ...SignalsTuple<AbortablePromise<Awaited<ReturnType<Fn>>> | undefined>,\n    isRequesting: Computed<boolean>,\n  ],\n  error: SignalsTuple<Error | undefined>\n] {\n  options ||= {};\n  const {\n    promise: optionsPromise,\n    error: optionsError,\n  } = options;\n  const [_promise, promise] =\n    optionsPromise\n      ? [optionsPromise, createComputed(optionsPromise)]\n      : createSignalsTuple<AbortablePromise<Awaited<ReturnType<Fn>>> | undefined>();\n  const [_error, error] =\n    optionsError\n      ? [optionsError, createComputed(optionsError)]\n      : createSignalsTuple<Error | undefined>();\n\n  return [\n    Object.assign((...args: Parameters<Fn>): AbortablePromise<Awaited<ReturnType<Fn>>> => {\n      if (_promise()) {\n        const err = new ConcurrentCallError(errorMessage);\n        _error.set(err);\n        return AbortablePromise.reject(err);\n      }\n\n      batch(() => {\n        _promise.set(fn(...args));\n        _error.set(undefined);\n      });\n\n      let error: Error | undefined;\n      return _promise()!\n        .catch(e => {\n          error = e;\n          throw e;\n        })\n        .finally(() => {\n          batch(() => {\n            _promise.set(undefined);\n            _error.set(error);\n          });\n        });\n    }, fn),\n    [_promise, promise, createComputed(() => !!_promise())],\n    [_error, error],\n  ];\n}","import { batch, type Computed } from '@telegram-apps/signals';\nimport { AbortablePromise } from 'better-promises';\n\nimport { defineNonConcurrentFn } from '@/scopes/defineNonConcurrentFn.js';\nimport { createSignalsTuple, type SignalsTuple } from '@/signals-registry.js';\n\n/**\n * Creates a mount function for a component.\n * @param component - the component name\n * @param mount - function mounting the component\n * @param onMounted - function that will be called whenever mount was completed.\n */\n// #__NO_SIDE_EFFECTS__\nexport function defineMountFn<Fn extends (...args: any) => AbortablePromise<any>>(\n  component: string,\n  mount: Fn,\n  onMounted: (result: Awaited<ReturnType<Fn>>) => void,\n): [\n  fn: (...args: Parameters<Fn>) => AbortablePromise<void>,\n  promise: [\n    ...SignalsTuple<AbortablePromise<Awaited<ReturnType<Fn>>> | undefined>,\n    isRequesting: Computed<boolean>,\n  ],\n  error: SignalsTuple<Error | undefined>,\n  isMounted: SignalsTuple<boolean>,\n] {\n  const [fn, ...rest] =\n    defineNonConcurrentFn(mount, `The ${component} component is already mounting`);\n  const [_isMounted, isMounted] = createSignalsTuple(false);\n\n  return [\n    (...args) => _isMounted()\n      ? AbortablePromise.resolve()\n      : fn(...args).then(data => {\n        batch(() => {\n          _isMounted.set(true);\n          onMounted(data);\n        });\n      }),\n    ...rest,\n    [_isMounted, isMounted],\n  ];\n}\n","import { createComputed, createSignalsTuple } from '@/signals-registry.js';\n\nimport type { State } from './types.js';\n\n/**\n * Complete biometry manager state.\n */\nexport const [_state, state] = createSignalsTuple<State>({\n  available: false,\n  type: '',\n  accessGranted: false,\n  accessRequested: false,\n  deviceId: '',\n  tokenSaved: false,\n});\n\n/**\n * Signal indicating biometry is available.\n */\nexport const isAvailable = createComputed(() => _state().available);\n","import type { EventPayload } from '@telegram-apps/bridge';\nimport type { AbortablePromise } from 'better-promises';\n\nimport { request } from '@/globals.js';\nimport { wrapSafe } from '@/scopes/wrappers/wrapSafe.js';\nimport type { RequestOptionsNoCapture } from '@/types.js';\n\nconst METHOD_NAME = 'web_app_biometry_get_info';\n\n/**\n * Requests biometry information.\n * @since Mini Apps v7.2\n * @param options - additional execution options.\n * @throws {FunctionNotAvailableError} The environment is unknown\n * @throws {FunctionNotAvailableError} The SDK is not initialized\n * @throws {FunctionNotAvailableError} The function is not supported\n * @example\n * if (requestBiometry.isAvailable()) {\n *   const biometryState = await requestBiometry();\n * }\n */\nexport const requestBiometry = wrapSafe(\n  'requestBiometry',\n  (options?: RequestOptionsNoCapture): AbortablePromise<EventPayload<'biometry_info_received'>> => {\n    return request(METHOD_NAME, 'biometry_info_received', options);\n  },\n  { isSupported: METHOD_NAME },\n);\n","import { isCancelledError } from 'better-promises';\n\n/**\n * Throw the value if is not CanceledError.\n * @param e - value to check.\n */\nexport function ignoreCanceled(e: unknown): never | void {\n  if (!isCancelledError(e)) {\n    throw e;\n  }\n}","import type { AbortablePromise } from 'better-promises';\nimport { ignoreCanceled } from '@/utils/ignoreCanceled.js';\n\n/**\n * Cancels the promise stored in the signal.\n * @param signal - signal with promise.\n */\nexport function signalCancel(signal: () => (AbortablePromise<any> | undefined)): void {\n  const p = signal();\n  p && p.catch(ignoreCanceled).cancel();\n}","import {\n  on,\n  off,\n  type BiometryTokenUpdateStatus,\n  type BiometryAuthRequestStatus,\n  type EventListener,\n  type EventPayload,\n} from '@telegram-apps/bridge';\nimport { isPageReload } from '@telegram-apps/navigation';\nimport { getStorageValue, setStorageValue } from '@telegram-apps/toolkit';\nimport { AbortablePromise } from 'better-promises';\n\nimport { postEvent, request } from '@/globals.js';\nimport { defineMountFn } from '@/scopes/defineMountFn.js';\nimport { createIsSupported } from '@/scopes/createIsSupported.js';\nimport { createWrapComplete } from '@/scopes/wrappers/createWrapComplete.js';\nimport { createWrapSupported } from '@/scopes/wrappers/createWrapSupported.js';\nimport { defineNonConcurrentFn } from '@/scopes/defineNonConcurrentFn.js';\nimport { NotAvailableError } from '@/errors.js';\n\nimport { _state } from './signals.js';\nimport { requestBiometry } from './requestBiometry.js';\nimport type {\n  State,\n  AuthenticateOptions,\n  RequestAccessOptions,\n  UpdateTokenOptions,\n} from './types.js';\nimport { signalCancel } from '@/scopes/signalCancel.js';\n\ntype StorageValue = State;\n\nconst COMPONENT_NAME = 'biometry';\nconst REQUEST_AUTH_METHOD = 'web_app_biometry_request_auth';\nconst INFO_RECEIVED_EVENT = 'biometry_info_received';\n\nconst onBiometryInfoReceived: EventListener<'biometry_info_received'> = e => {\n  setState(eventToState(e));\n};\n\nfunction throwNotAvailable(): never {\n  throw new NotAvailableError('Biometry is not available');\n}\n\n/**\n * Converts `biometry_info_received` to some common shape.\n * @param event - event payload.\n * @see biometry_info_received\n */\nfunction eventToState(event: EventPayload<'biometry_info_received'>): State {\n  let available = false;\n  let tokenSaved = false;\n  let deviceId = '';\n  let accessRequested = false;\n  let type = '';\n  let accessGranted = false;\n  if (event.available) {\n    available = true;\n    tokenSaved = event.token_saved;\n    deviceId = event.device_id;\n    accessRequested = event.access_requested;\n    type = event.type;\n    accessGranted = event.access_granted;\n  }\n  return { available, tokenSaved, deviceId, type, accessGranted, accessRequested };\n}\n\n/**\n * @returns True if the biometry manager is supported.\n */\nexport const isSupported = createIsSupported(REQUEST_AUTH_METHOD);\n\nconst [\n  mountFn,\n  tMountPromise,\n  tMountError,\n  tIsMounted,\n] = defineMountFn(\n  COMPONENT_NAME,\n  abortSignal => {\n    const s = isPageReload() && getStorageValue<StorageValue>(COMPONENT_NAME);\n    return s ? AbortablePromise.resolve(s) : requestBiometry({ abortSignal }).then(eventToState);\n  },\n  s => {\n    on(INFO_RECEIVED_EVENT, onBiometryInfoReceived);\n    setState(s);\n  },\n);\n\nconst wrapSupported = createWrapSupported(COMPONENT_NAME, REQUEST_AUTH_METHOD);\nconst wrapComplete = createWrapComplete(COMPONENT_NAME, tIsMounted[0], REQUEST_AUTH_METHOD);\n\n/**\n * Mounts the Biometry component.\n * @since Mini Apps v7.2\n * @throws {FunctionNotAvailableError} The environment is unknown\n * @throws {FunctionNotAvailableError} The SDK is not initialized\n * @throws {FunctionNotAvailableError} The function is not supported\n * @example\n * if (mount.isAvailable()) {\n *   await mount();\n * }\n */\nexport const mount = wrapSupported('mount', mountFn);\nexport const [, mountPromise, isMounting] = tMountPromise;\nexport const [, mountError] = tMountError;\nexport const [_isMounted, isMounted] = tIsMounted;\n\nconst [\n  authFn,\n  tAuthPromise,\n  tAuthError,\n] = defineNonConcurrentFn(\n  (options?: AuthenticateOptions): AbortablePromise<{\n    /**\n     * Authentication status.\n     */\n    status: BiometryAuthRequestStatus;\n    /**\n     * Token from the local secure storage saved previously.\n     */\n    token?: string;\n  }> => {\n    return AbortablePromise.fn(async context => {\n      const s = _state();\n      if (!s.available) {\n        throwNotAvailable();\n      }\n      const data = await request(REQUEST_AUTH_METHOD, 'biometry_auth_requested', {\n        ...options,\n        ...context,\n        params: { reason: ((options || {}).reason || '').trim() },\n      });\n      const { token } = data;\n      if (typeof token === 'string') {\n        setState({ ...s, token });\n      }\n      return data;\n    }, options);\n  },\n  'Biometry authentication is already in progress',\n);\n\n/**\n * Attempts to authenticate a user using biometrics and fetch a previously stored secure token.\n * @param options - method options.\n * @since Mini Apps v7.2\n * @returns Token from the local secure storage saved previously or undefined.\n * @throws {FunctionNotAvailableError} The environment is unknown\n * @throws {FunctionNotAvailableError} The SDK is not initialized\n * @throws {FunctionNotAvailableError} The function is not supported\n * @throws {FunctionNotAvailableError} The parent component is not mounted\n * @throws {ConcurrentCallError} Biometry authentication is already in progress\n * @throws {NotAvailableError} Biometry is not available\n * @example\n * if (authenticate.isAvailable()) {\n *   const { status, token } = await authenticate({\n *     reason: 'Authenticate to open wallet',\n *   });\n * }\n */\nexport const authenticate = wrapComplete('authenticate', authFn);\nexport const [, authPromise, isAuthenticating] = tAuthPromise;\nexport const [, authError] = tAuthError;\n\n/**\n * Opens the biometric access settings for bots. Useful when you need to request biometrics\n * access to users who haven't granted it yet.\n *\n * _Note that this method can be called only in response to user interaction with the Mini App\n * interface (e.g. a click inside the Mini App or on the main button)_.\n * @since Mini Apps v7.2\n * @throws {FunctionNotAvailableError} The environment is unknown\n * @throws {FunctionNotAvailableError} The SDK is not initialized\n * @throws {FunctionNotAvailableError} The function is not supported\n * @example\n * if (openSettings.isAvailable()) {\n *   openSettings();\n * }\n */\nexport const openSettings = wrapSupported('openSettings', (): void => {\n  postEvent('web_app_biometry_open_settings');\n});\n\nconst [\n  requestAccessFn,\n  tRequestAccessPromise,\n  tRequestAccessError,\n] = defineNonConcurrentFn(\n  (options?: RequestAccessOptions): AbortablePromise<boolean> => {\n    return AbortablePromise.fn(async context => {\n      const data = await request('web_app_biometry_request_access', INFO_RECEIVED_EVENT, {\n        ...options,\n        ...context,\n        params: { reason: (options || {}).reason || '' },\n      }).then(eventToState);\n\n      if (!data.available) {\n        throwNotAvailable();\n      }\n      setState(data);\n\n      return data.accessGranted;\n    }, options);\n  },\n  'Biometry access request is already in progress',\n);\n\n/**\n * Requests permission to use biometrics.\n * @since Mini Apps v7.2\n * @returns Promise with true, if access was granted.\n * @throws {FunctionNotAvailableError} The environment is unknown\n * @throws {FunctionNotAvailableError} The SDK is not initialized\n * @throws {FunctionNotAvailableError} The function is not supported\n * @throws {FunctionNotAvailableError} The parent component is not mounted\n * @throws {ConcurrentCallError} Biometry access request is already in progress\n * @throws {NotAvailableError} Biometry is not available\n * @example\n * if (requestAccess.isAvailable()) {\n *   const accessGranted = await requestAccess({\n *     reason: 'Authenticate to open wallet',\n *   });\n * }\n */\nexport const requestAccess = wrapComplete('requestAccess', requestAccessFn);\nexport const [, requestAccessPromise, isRequestingAccess] = tRequestAccessPromise;\nexport const [, requestAccessError] = tRequestAccessError;\n\nfunction setState(s: State): void {\n  _state.set(s);\n  setStorageValue<StorageValue>(COMPONENT_NAME, s);\n}\n\n/**\n * Unmounts the component.\n */\nexport function unmount() {\n  [authPromise, requestAccessPromise, mountPromise].forEach(signalCancel);\n  off(INFO_RECEIVED_EVENT, onBiometryInfoReceived);\n  _isMounted.set(false);\n}\n\n/**\n * Updates the biometric token in a secure storage on the device.\n * @since Mini Apps v7.2\n * @returns Promise with `true`, if token was updated.\n * @throws {FunctionNotAvailableError} The environment is unknown\n * @throws {FunctionNotAvailableError} The SDK is not initialized\n * @throws {FunctionNotAvailableError} The function is not supported\n * @throws {FunctionNotAvailableError} The parent component is not mounted\n * @example Setting a new token\n * if (updateToken.isAvailable()) {\n *   updateToken({\n *     token: 'abcdef',\n *   })\n * }\n * @example Deleting the token\n * if (updateToken.isAvailable()) {\n *   updateToken();\n * }\n */\nexport const updateToken = wrapComplete(\n  'updateToken',\n  (options?: UpdateTokenOptions): AbortablePromise<BiometryTokenUpdateStatus> => {\n    options ||= {};\n    return request('web_app_biometry_update_token', 'biometry_token_updated', {\n      ...options,\n      params: {\n        token: options.token || '',\n        reason: options.reason,\n      },\n    }).then(r => r.status);\n  },\n);\n","import { createWrapSafe, type SafeWrapFn } from '@/scopes/wrappers/createWrapSafe.js';\n\nexport function createWrapMounted(\n  component: string,\n  isMounted: () => boolean,\n): SafeWrapFn<false> {\n  return createWrapSafe(component, { isMounted });\n}","import { createWrapSafe } from '@/scopes/wrappers/createWrapSafe.js';\n\nexport const createWrapBasic = createWrapSafe;","import { isPageReload } from '@telegram-apps/navigation';\nimport { getStorageValue, setStorageValue } from '@telegram-apps/toolkit';\n\nimport { postEvent } from '@/globals.js';\nimport { createWrapMounted } from '@/scopes/wrappers/createWrapMounted.js';\nimport { createWrapBasic } from '@/scopes/wrappers/createWrapBasic.js';\nimport { createSignalsTuple } from '@/signals-registry.js';\n\ntype StorageValue = boolean;\n\nconst COMPONENT_NAME = 'closingBehavior';\n\n/**\n * Signal indicating if the confirmation dialog should be shown, while the user\n * is trying to close the Mini App.\n */\nexport const [_isConfirmationEnabled, isConfirmationEnabled] = createSignalsTuple(false);\n\n/**\n * Signal indicating if the Closing Behavior component is currently mounted.\n */\nexport const [_isMounted, isMounted] = createSignalsTuple(false);\n\nconst wrapMounted = createWrapMounted(COMPONENT_NAME, isMounted);\nconst wrapBasic = createWrapBasic(COMPONENT_NAME);\n\n/**\n * Disables the closing confirmation dialog.\n * @throws {FunctionNotAvailableError} The environment is unknown\n * @throws {FunctionNotAvailableError} The parent component is not mounted\n * @throws {FunctionNotAvailableError} The SDK is not initialized\n * @example\n * if (disableConfirmation.isAvailable()) {\n *   disableConfirmation();\n * }\n */\nexport const disableConfirmation = wrapMounted('disableConfirmation', (): void => {\n  setClosingConfirmation(false);\n});\n\n/**\n * Enables the closing confirmation dialog.\n * @throws {FunctionNotAvailableError} The environment is unknown\n * @throws {FunctionNotAvailableError} The parent component is not mounted\n * @throws {FunctionNotAvailableError} The SDK is not initialized\n * @example\n * if (enableConfirmation.isAvailable()) {\n *   enableConfirmation();\n * }\n */\nexport const enableConfirmation = wrapMounted('enableConfirmation', (): void => {\n  setClosingConfirmation(true);\n});\n\n/**\n * Mounts the Closing Behavior component restoring its state.\n * @throws {FunctionNotAvailableError} The environment is unknown\n * @throws {FunctionNotAvailableError} The SDK is not initialized\n * @example\n * if (mount.isAvailable()) {\n *   mount();\n * }\n */\nexport const mount = wrapBasic('mount', (): void => {\n  if (!_isMounted()) {\n    setClosingConfirmation(\n      isPageReload() && getStorageValue<StorageValue>(COMPONENT_NAME) || false,\n    );\n    _isMounted.set(true);\n  }\n});\n\nfunction setClosingConfirmation(value: boolean): void {\n  if (value !== _isConfirmationEnabled()) {\n    postEvent('web_app_setup_closing_behavior', { need_confirmation: value });\n    setStorageValue<StorageValue>(COMPONENT_NAME, value);\n    _isConfirmationEnabled.set(value);\n  }\n}\n\n/**\n * Unmounts the Closing Behavior component.\n */\nexport function unmount(): void {\n  _isMounted.set(false);\n}\n","import { AbortablePromise } from 'better-promises';\nimport { array, parse, record, string } from 'valibot';\n\nimport { invokeCustomMethod } from '@/globals.js';\nimport { createIsSupported } from '@/scopes/createIsSupported.js';\nimport { createWrapSupported } from '@/scopes/wrappers/createWrapSupported.js';\nimport type { InvokeCustomMethodOptions } from '@telegram-apps/bridge';\n\nconst INVOKE_METHOD_NAME = 'web_app_invoke_custom_method';\nconst wrapSupported = createWrapSupported('cloudStorage', INVOKE_METHOD_NAME);\n\n/**\n * Signal indicating if the Cloud Storage is supported.\n */\nexport const isSupported = createIsSupported(INVOKE_METHOD_NAME);\n\n/**\n * Deletes specified key or keys from the cloud storage.\n * @param keyOrKeys - key or keys to delete.\n * @param options - request execution options.\n * @since Mini Apps v6.9\n * @throws {FunctionNotAvailableError} The environment is unknown\n * @throws {FunctionNotAvailableError} The SDK is not initialized\n * @throws {FunctionNotAvailableError} The function is not supported\n * @example Deleting a single key\n * if (deleteItem.isAvailable()) {\n *   await deleteItem('my-key');\n * }\n * @example Deleting multiple keys\n * if (deleteItem.isAvailable()) {\n *   await deleteItem(['key1', 'key2']);\n * }\n */\nexport const deleteItem = wrapSupported('deleteItem', (\n  keyOrKeys: string | string[],\n  options?: InvokeCustomMethodOptions,\n): AbortablePromise<void> => {\n  const keys = Array.isArray(keyOrKeys) ? keyOrKeys : [keyOrKeys];\n  return keys.length\n    ? invokeCustomMethod('deleteStorageValues', { keys }, options).then()\n    : AbortablePromise.resolve();\n});\n\n/**\n * Gets multiple keys' values from the cloud storage.\n * @param keys - keys list.\n * @param options - request execution options.\n * @returns Map, where a key is one of the specified in the `keys` argument,\n * and a value is a corresponding storage value.\n * @since Mini Apps v6.9\n * @throws {FunctionNotAvailableError} The environment is unknown\n * @throws {FunctionNotAvailableError} The SDK is not initialized\n * @throws {FunctionNotAvailableError} The function is not supported\n * @example\n * if (deleteItem.isAvailable()) {\n *   const { key1, key2 } = await getItem(['key1', 'key2']);\n * }\n */\nfunction _getItem<K extends string>(\n  keys: K[],\n  options?: InvokeCustomMethodOptions,\n): AbortablePromise<Record<K, string>>;\n\n/**\n * Gets a single key value from the cloud storage.\n * @param key - cloud storage key.\n * @param options - request execution options.\n * @return Value of the specified key. If the key was not created previously,\n * the function will return an empty string.\n * @since Mini Apps v6.9\n * @throws {FunctionNotAvailableError} The environment is unknown\n * @throws {FunctionNotAvailableError} The SDK is not initialized\n * @throws {FunctionNotAvailableError} The function is not supported\n * @example\n * if (getItem.isAvailable()) {\n *   const keyValue = await getItem('my-key');\n * }\n */\nfunction _getItem(key: string, options?: InvokeCustomMethodOptions): AbortablePromise<string>;\n\nfunction _getItem(\n  keyOrKeys: string | string[],\n  options?: InvokeCustomMethodOptions,\n): AbortablePromise<string | Record<string, string>> {\n  const keys = Array.isArray(keyOrKeys) ? keyOrKeys : [keyOrKeys];\n\n  return keys.length\n    ? invokeCustomMethod('getStorageValues', { keys }, options).then(data => {\n      const response = {\n        // Fulfill the response with probably missing keys.\n        ...keys.reduce<Record<string, string>>((acc, key) => {\n          acc[key] = '';\n          return acc;\n        }, {}),\n        ...parse(record(string(), string()), data),\n      };\n\n      return typeof keyOrKeys === 'string' ? response[keyOrKeys] : response;\n    })\n    : AbortablePromise.resolve(Array.isArray(keyOrKeys) ? {} : '');\n}\n\nexport const getItem = wrapSupported('getItem', _getItem);\n\n/**\n * Returns a list of all keys presented in the cloud storage.\n * @param options - request execution options.\n * @since Mini Apps v6.9\n * @throws {FunctionNotAvailableError} The environment is unknown\n * @throws {FunctionNotAvailableError} The SDK is not initialized\n * @throws {FunctionNotAvailableError} The function is not supported\n * @example\n * if (getKeys.isAvailable()) {\n *   const keysArray = await getKeys();\n * }\n */\nexport const getKeys = wrapSupported('getKeys', (\n  options?: InvokeCustomMethodOptions,\n): AbortablePromise<string[]> => {\n  return invokeCustomMethod('getStorageKeys', {}, options).then(\n    data => parse(array(string()), data),\n  );\n});\n\n/**\n * Saves the specified value by a key.\n * @param key - storage key.\n * @param value - storage value.\n * @param options - request execution options.\n * @since Mini Apps v6.9\n * @throws {FunctionNotAvailableError} The environment is unknown\n * @throws {FunctionNotAvailableError} The SDK is not initialized\n * @throws {FunctionNotAvailableError} The function is not supported\n * @example\n * if (setItem.isAvailable()) {\n *   await setItem('key', 'value');\n * }\n */\nexport const setItem = wrapSupported('setItem', (\n  key: string,\n  value: string,\n  options?: InvokeCustomMethodOptions,\n): AbortablePromise<void> => {\n  return invokeCustomMethod('saveStorageValue', {\n    key,\n    value,\n  }, options).then();\n});\n\n/**\n * Clears the cloud storage.\n * @param options - additional options.\n * @since Mini Apps v6.9\n * @throws {FunctionNotAvailableError} The environment is unknown\n * @throws {FunctionNotAvailableError} The SDK is not initialized\n * @throws {FunctionNotAvailableError} The function is not supported\n * @example\n * if (clear.isAvailable()) {\n *   await clear();\n * }\n */\nexport const clear = wrapSupported('clear', (\n  options?: InvokeCustomMethodOptions,\n) => getKeys(options).then(deleteItem));","import type {\n  ImpactHapticFeedbackStyle,\n  NotificationHapticFeedbackType,\n} from '@telegram-apps/bridge';\n\nimport { postEvent } from '@/globals.js';\nimport { createIsSupported } from '@/scopes/createIsSupported.js';\nimport { createWrapSupported } from '@/scopes/wrappers/createWrapSupported.js';\n\nconst HAPTIC_METHOD_NAME = 'web_app_trigger_haptic_feedback';\nconst wrapSupported = createWrapSupported('hapticFeedback', HAPTIC_METHOD_NAME);\n\n/**\n * Signal indicating if the Haptic Feedback is supported.\n */\nexport const isSupported = createIsSupported(HAPTIC_METHOD_NAME);\n\n/**\n * A method that tells if an impact occurred. The Telegram app may play the\n * appropriate haptics based on style value passed.\n * @param style - impact style.\n * @since Mini Apps v6.1\n * @throws {FunctionNotAvailableError} The environment is unknown\n * @throws {FunctionNotAvailableError} The SDK is not initialized\n * @throws {FunctionNotAvailableError} The function is not supported\n * @example\n * if (impactOccurred.isAvailable()) {\n *   impactOccurred('medium');\n * }\n */\nexport const impactOccurred = wrapSupported(\n  'impactOccurred',\n  (style: ImpactHapticFeedbackStyle): void => {\n    postEvent(HAPTIC_METHOD_NAME, {\n      type: 'impact',\n      impact_style: style,\n    });\n  },\n);\n\n/**\n * A method tells that a task or action has succeeded, failed, or produced\n * a warning. The Telegram app may play the appropriate haptics based on type\n * value passed.\n * @param type - notification type.\n * @since Mini Apps v6.1\n * @throws {FunctionNotAvailableError} The environment is unknown\n * @throws {FunctionNotAvailableError} The SDK is not initialized\n * @throws {FunctionNotAvailableError} The function is not supported\n * @example\n * if (notificationOccurred.isAvailable()) {\n *   notificationOccurred('success');\n * }\n */\nexport const notificationOccurred = wrapSupported(\n  'notificationOccurred',\n  (type: NotificationHapticFeedbackType): void => {\n    postEvent(HAPTIC_METHOD_NAME, {\n      type: 'notification',\n      notification_type: type,\n    });\n  },\n);\n\n/**\n * A method tells that the user has changed a selection. The Telegram app may\n * play the appropriate haptics.\n *\n * Do not use this feedback when the user makes or confirms a selection; use\n * it only when the selection changes.\n * @since Mini Apps v6.1\n * @throws {FunctionNotAvailableError} The environment is unknown\n * @throws {FunctionNotAvailableError} The SDK is not initialized\n * @throws {FunctionNotAvailableError} The function is not supported\n * @example\n * if (selectionChanged.isAvailable()) {\n *   selectionChanged();\n * }\n */\nexport const selectionChanged = wrapSupported(\n  'selectionChanged',\n  (): void => {\n    postEvent(HAPTIC_METHOD_NAME, { type: 'selection_change' });\n  },\n);\n","import type { Computed } from '@telegram-apps/signals';\nimport { retrieveLaunchParams, retrieveRawInitData } from '@telegram-apps/bridge';\nimport type { InitData } from '@telegram-apps/types';\n\nimport { createComputed, createSignalsTuple } from '@/signals-registry.js';\n\n/**\n * Complete component state.\n */\nexport const [_state, state] =\n  createSignalsTuple<InitData | undefined>(undefined);\n\nfunction fromState<K extends keyof InitData>(key: K): Computed<InitData[K] | undefined> {\n  return createComputed(() => {\n    const s = _state();\n    return s ? s[key] : undefined;\n  });\n}\n\n/**\n * @see InitData.auth_date\n */\nexport const authDate = fromState('auth_date');\n\n/**\n * @see InitData.can_send_after\n */\nexport const canSendAfter = fromState('can_send_after');\n\n/**\n * Date after which it is allowed to call\n * the [answerWebAppQuery](https://core.telegram.org/bots/api#answerwebappquery) method.\n */\nexport const canSendAfterDate = createComputed(() => {\n  const authDateValue = authDate();\n  const canSendAfterValue = canSendAfter();\n\n  return canSendAfterValue && authDateValue\n    ? new Date(authDateValue.getTime() + canSendAfterValue * 1000)\n    : undefined;\n});\n\n/**\n * @see InitData.chat\n */\nexport const chat = fromState('chat');\n\n/**\n * @see InitData.chat_type\n */\nexport const chatType = fromState('chat_type');\n\n/**\n * @see InitData.chat_instance\n */\nexport const chatInstance = fromState('chat_instance');\n\n/**\n * @see InitData.hash\n */\nexport const hash = fromState('hash');\n\n/**\n * @see InitData.query_id\n */\nexport const queryId = fromState('query_id');\n\n/**\n * Raw representation of init data.\n */\nexport const [_raw, raw] = createSignalsTuple<string | undefined>();\n\n/**\n * @see InitData.receiver\n */\nexport const receiver = fromState('receiver');\n\n/**\n * Restores the component state.\n */\nexport function restore(): void {\n  const lp = retrieveLaunchParams();\n  _state.set(lp.tgWebAppData);\n  _raw.set(retrieveRawInitData());\n}\n\n/**\n * @see InitData.start_param\n */\nexport const startParam = fromState('start_param');\n\n/**\n * @see InitData.user\n */\nexport const user = fromState('user');","import type { InvoiceStatus } from '@telegram-apps/bridge';\nimport type { AbortablePromise } from 'better-promises';\n\nimport { request } from '@/globals.js';\nimport { createWrapSupported } from '@/scopes/wrappers/createWrapSupported.js';\nimport { InvalidArgumentsError } from '@/errors.js';\nimport { defineNonConcurrentFn } from '@/scopes/defineNonConcurrentFn.js';\nimport { createIsSupported } from '@/scopes/createIsSupported.js';\nimport type { RequestOptionsNoCapture } from '@/types.js';\n\nconst METHOD_NAME = 'web_app_open_invoice';\nconst wrapSupported = createWrapSupported('invoice', METHOD_NAME);\n\n/**\n * Signal indicating if invoices are supported.\n */\nexport const isSupported = createIsSupported(METHOD_NAME);\n\n/**\n * Opens an invoice using its slug.\n * @param slug - invoice slug.\n * @param options - additional options.\n * @since Mini Apps v6.1\n * @throws {FunctionNotAvailableError} The environment is unknown\n * @throws {FunctionNotAvailableError} The SDK is not initialized\n * @throws {FunctionNotAvailableError} The function is not supported\n * @throws {InvalidArgumentsError} An invoice is already opened\n * @example\n * if (open.isAvailable()) {\n *   const status = await open('kJNFS331');\n * }\n */\nfunction _open(slug: string, options?: RequestOptionsNoCapture): AbortablePromise<InvoiceStatus>;\n\n/**\n * Opens an invoice using its url.\n * @param url - invoice URL.\n * @param type - value type.\n * @param options - additional options.\n * @since Mini Apps v6.1\n * @throws {FunctionNotAvailableError} The environment is unknown\n * @throws {FunctionNotAvailableError} The SDK is not initialized\n * @throws {FunctionNotAvailableError} The function is not supported\n * @throws {InvalidArgumentsError} An invoice is already opened\n * @throws {InvalidArgumentsError} Link has unexpected hostname\n * @example\n * if (open.isAvailable()) {\n *   const status = await open('https://t.me/$kJNFS331', 'url');\n * }\n * @example\n * if (open.isAvailable()) {\n *   const status = await open('https://t.me/invoice/kJNFS331', 'url');\n * }\n */\nfunction _open(url: string, type: 'url', options?: RequestOptionsNoCapture): AbortablePromise<InvoiceStatus>;\n\nfunction _open(\n  urlOrSlug: string,\n  optionsOrType?: 'url' | RequestOptionsNoCapture,\n  options?: RequestOptionsNoCapture,\n): AbortablePromise<InvoiceStatus> {\n  let slug: string;\n  if (optionsOrType === 'url') {\n    const { hostname, pathname } = new URL(urlOrSlug, window.location.href);\n    if (hostname !== 't.me') {\n      throw new InvalidArgumentsError(`Link has unexpected hostname: ${hostname}`);\n    }\n\n    // Valid examples:\n    // \"/invoice/my-slug\"\n    // \"/$my-slug\"\n    const match = pathname.match(/^\\/(\\$|invoice\\/)([A-Za-z0-9\\-_=]+)$/);\n    if (!match) {\n      throw new InvalidArgumentsError(\n        `Expected to receive a link with a pathname in format \"/invoice/{slug}\" or \"/\\${slug}\"`,\n      );\n    }\n    [, , slug] = match;\n  } else {\n    // todo: validate slug?\n    slug = urlOrSlug;\n    options = optionsOrType;\n  }\n\n  return request(METHOD_NAME, 'invoice_closed', {\n    ...options,\n    params: { slug },\n    capture: (data) => slug === data.slug,\n  })\n    .then(d => d.status);\n}\n\nconst [\n  fn,\n  tOpenPromise,\n  tOpenError,\n] = defineNonConcurrentFn(_open, 'Invoice is already opened');\n\nexport const open = wrapSupported('open', fn);\nexport const [, openPromise, isOpened] = tOpenPromise;\nexport const [, openError] = tOpenError;\n","import { isPageReload } from '@telegram-apps/navigation';\nimport { getStorageValue, Maybe, setStorageValue } from '@telegram-apps/toolkit';\nimport { AbortablePromise } from 'better-promises';\nimport type { EventPayload } from '@telegram-apps/bridge';\nimport type { Computed } from '@telegram-apps/signals';\n\nimport { defineMountFn } from '@/scopes/defineMountFn.js';\nimport { postEvent, request } from '@/globals.js';\nimport { createWrapComplete } from '@/scopes/wrappers/createWrapComplete.js';\nimport { createWrapSupported } from '@/scopes/wrappers/createWrapSupported.js';\nimport { NotAvailableError } from '@/errors.js';\nimport { defineNonConcurrentFn } from '@/scopes/defineNonConcurrentFn.js';\nimport { signalCancel } from '@/scopes/signalCancel.js';\nimport type { AsyncOptions } from '@/types.js';\nimport { createComputed, createSignal } from '@/signals-registry.js';\nimport { createIsSupported } from '@/scopes/createIsSupported.js';\n\nconst COMPONENT_NAME = 'locationManager';\nconst CHECK_LOCATION_METHOD = 'web_app_check_location';\nconst OPEN_SETTINGS_METHOD = 'web_app_open_location_settings';\n\nexport interface State {\n  /**\n   * If true, indicates that location data tracking is available on the current device.\n   */\n  available: boolean;\n  /**\n   * Indicates whether the app has previously requested permission to track location data.\n   */\n  accessRequested: boolean;\n  /**\n   * Indicates whether the user has granted the app permission to track location data.\n   *\n   * If false and `accessRequested` is true may indicate that:\n   *\n   * - The user has simply canceled the permission popup.\n   * - The user has denied the app permission to track location data.\n   */\n  accessGranted: boolean;\n}\n\ntype StorageValue = State;\n\nconst state = createSignal<State>({\n  available: false,\n  accessGranted: false,\n  accessRequested: false,\n});\n\nfunction fromState<K extends keyof State>(key: K): Computed<State[K]> {\n  return createComputed(() => state()[key]);\n}\n\n/**\n * Signal indicating whether the location data tracking is currently supported.\n */\nexport const isSupported = createIsSupported(CHECK_LOCATION_METHOD);\n\n/**\n * Signal indicating whether the location data tracking is currently available.\n */\nexport const isAvailable = fromState('available');\n\n/**\n * Signal indicating whether the user has granted the app permission to track location data.\n */\nexport const isAccessGranted = fromState('accessGranted');\n\n/**\n * Signal indicating whether the app has previously requested permission to track location data.\n */\nexport const isAccessRequested = fromState('accessRequested');\n\n/**\n * Converts `location_checked` to some common shape.\n * @param event - event payload.\n * @see location_checked\n */\nfunction eventToState(event: EventPayload<'location_checked'>): State {\n  let available = false;\n  let accessRequested: Maybe<boolean>;\n  let accessGranted: Maybe<boolean>;\n  if (event.available) {\n    available = true;\n    accessRequested = event.access_requested;\n    accessGranted = event.access_granted;\n  }\n  return {\n    available,\n    accessGranted: accessGranted || false,\n    accessRequested: accessRequested || false,\n  };\n}\n\nconst [\n  mountFn,\n  tMountPromise,\n  tMountError,\n  tIsMounted,\n] = defineMountFn(\n  COMPONENT_NAME,\n  (options?: AsyncOptions) => {\n    const s = isPageReload() && getStorageValue<StorageValue>(COMPONENT_NAME);\n    return s\n      ? AbortablePromise.resolve(s)\n      : request('web_app_check_location', 'location_checked', options).then(eventToState);\n  },\n  s => {\n    state.set(s);\n    setStorageValue<State>(COMPONENT_NAME, s);\n  },\n);\n\nconst wrapSupported = createWrapSupported(COMPONENT_NAME, CHECK_LOCATION_METHOD);\nconst wrapComplete = createWrapComplete(COMPONENT_NAME, tIsMounted[0], CHECK_LOCATION_METHOD);\n\n/**\n * Mounts the location manager component.\n * @since Mini Apps v8.0\n * @throws {FunctionNotAvailableError} The environment is unknown\n * @throws {FunctionNotAvailableError} The SDK is not initialized\n * @throws {FunctionNotAvailableError} The function is not supported\n * @example\n * if (mount.isAvailable()) {\n *   await mount();\n * }\n */\nexport const mount = wrapSupported('mount', mountFn);\nexport const [, mountPromise, isMounting] = tMountPromise;\nexport const [, mountError] = tMountError;\nexport const [_isMounted, isMounted] = tIsMounted;\n\nconst [\n  reqLocationFn,\n  tReqLocationPromise,\n  tReqLocationError,\n] = defineNonConcurrentFn(\n  (options?: AsyncOptions) => {\n    return request('web_app_request_location', 'location_requested', options).then(data => {\n      if (!data.available) {\n        state.set({ ...state(), available: false });\n        throw new NotAvailableError('Location data tracking is not available');\n      }\n      // eslint-disable-next-line @typescript-eslint/no-unused-vars\n      const { available, ...rest } = data;\n      return rest;\n    });\n  },\n  'Location request is currently in progress',\n);\n\n\n/**\n * Requests location data.\n * @since Mini Apps v8.0\n * @returns Promise with location data.\n * @throws {FunctionNotAvailableError} The environment is unknown\n * @throws {FunctionNotAvailableError} The SDK is not initialized\n * @throws {FunctionNotAvailableError} The function is not supported\n * @throws {FunctionNotAvailableError} The parent component is not mounted\n * @throws {ConcurrentCallError} Location request is currently in progress\n * @throws {NotAvailableError} Location data tracking is not available\n * @example\n * if (requestLocation.isAvailable()) {\n *   const location = await requestLocation();\n * }\n */\nexport const requestLocation = wrapComplete('requestLocation', reqLocationFn);\nexport const [, requestLocationPromise, isRequestingLocation] = tReqLocationPromise;\nexport const [, requestLocationError] = tReqLocationError;\n\n/**\n * Opens the location access settings for bots. Useful when you need to request location access\n * from users who haven't granted it yet.\n *\n * Note that this method can be called only in response to user interaction with the Mini App\n * interface (e.g., a click inside the Mini App or on the main button).\n * @since Mini Apps v8.0\n * @throws {FunctionNotAvailableError} The environment is unknown\n * @throws {FunctionNotAvailableError} The SDK is not initialized\n * @throws {FunctionNotAvailableError} The function is not supported\n * @example\n * if (openSettings.isAvailable()) {\n *   openSettings();\n * }\n */\nexport const openSettings = wrapSupported('openSettings', () => {\n  postEvent(OPEN_SETTINGS_METHOD);\n}, OPEN_SETTINGS_METHOD);\n\n/**\n * Unmounts the component.\n */\nexport function unmount(): void {\n  signalCancel(requestLocationPromise);\n  _isMounted.set(false);\n}","import type { UnionRequiredKeys } from '@telegram-apps/toolkit';\n\ntype RemoveUndefined<T> = {\n  [K in UnionRequiredKeys<T>]-?: T[K]\n};\n\n/**\n * @returns Object with keys having undefined values.\n * @param value - an object to remove undefined values from.\n */\nexport function removeUndefined<T extends {}>(value: T): RemoveUndefined<T> {\n  const result = {} as RemoveUndefined<T>;\n  for (const k in value) {\n    const v = value[k];\n    v !== undefined && ((result as any)[k] = v);\n  }\n  return result;\n}","import { toRGB } from '@telegram-apps/transformers';\n\n/**\n * @param color - color in any format acceptable by the `toRGB` function.\n * @returns True if the color is recognized as dark.\n * @see toRGB\n */\nexport function isColorDark(color: string): boolean {\n  const rgb = toRGB(color);\n\n  // Real formula: hsp = Math.sqrt(0.299 * r * r + 0.587 * g * g + 0.114 * b * b)\n  // See: https://stackoverflow.com/a/596243\n  return Math.sqrt(\n    [0.299, 0.587, 0.114].reduce<number>((acc, modifier, idx) => {\n      // Extract part of #RRGGBB pattern and convert it to DEC.\n      const dec = parseInt(rgb.slice(1 + idx * 2, 1 + (idx + 1) * 2), 16);\n      return acc + dec * dec * modifier;\n    }, 0),\n  ) < 120;\n}\n","import type { ThemeParams } from '@telegram-apps/types';\nimport type { Computed } from '@telegram-apps/signals';\n\nimport { isColorDark } from '@/utils/isColorDark.js';\nimport { createComputed, createSignalsTuple } from '@/signals-registry.js';\n\n/**\n * True if CSS variables are currently bound.\n */\nexport const [_isCssVarsBound, isCssVarsBound] = createSignalsTuple(false);\n\n/**\n * Complete component state.\n */\nexport const [_state, state] = createSignalsTuple<ThemeParams>({});\n\nfunction fromState<K extends keyof ThemeParams>(key: K): Computed<ThemeParams[K] | undefined> {\n  return createComputed(() => _state()[key]);\n}\n\n/**\n * @since v6.10\n */\nexport const accentTextColor = fromState('accent_text_color');\n\nexport const backgroundColor = fromState('bg_color');\n\nexport const buttonColor = fromState('button_color');\n\nexport const buttonTextColor = fromState('button_text_color');\n\n/**\n * @since v7.10\n */\nexport const bottomBarBgColor = fromState('bottom_bar_bg_color');\n\nexport const destructiveTextColor = fromState('destructive_text_color');\n\n/**\n * @since v6.10\n */\nexport const headerBackgroundColor = fromState('header_bg_color');\n\nexport const hintColor = fromState('hint_color');\n\n/**\n * @returns True if the current color scheme is recognized as dark.\n * This value is calculated based on the current theme's background color.\n */\nexport const isDark = createComputed(() => {\n  const color = backgroundColor();\n  return !color || isColorDark(color);\n});\n\nexport const linkColor = fromState('link_color');\n\nexport const secondaryBackgroundColor = fromState('secondary_bg_color');\n\n/**\n * @since v6.10\n */\nexport const sectionBackgroundColor = fromState('section_bg_color');\n\n/**\n * @since v6.10\n */\nexport const sectionHeaderTextColor = fromState('section_header_text_color');\n\n/**\n * @since v7.6\n */\nexport const sectionSeparatorColor = fromState('section_separator_color');\n\n/**\n * @since v6.10\n */\nexport const subtitleTextColor = fromState('subtitle_text_color');\n\nexport const textColor = fromState('text_color');\n","import type { Computed } from '@telegram-apps/signals';\n\nimport {\n  buttonColor,\n  buttonTextColor,\n} from '@/scopes/components/theme-params/signals.js';\nimport { createComputed, createSignal, createSignalsTuple } from '@/signals-registry.js';\n\nimport type { State } from './types.js';\n\nfunction fromState<K extends keyof Required<State>>(\n  key: K,\n): Computed<Required<State>[K]> {\n  return createComputed(() => state()[key]);\n}\n\nexport const internalState = createSignal<State>({\n  hasShineEffect: false,\n  isEnabled: true,\n  isLoaderVisible: false,\n  isVisible: false,\n  text: 'Continue',\n});\n\n/**\n * Complete component state.\n */\nexport const state = createComputed<Required<State>>(() => {\n  const s = internalState();\n  return {\n    ...s,\n    backgroundColor: s.backgroundColor || buttonColor() || '#2481cc',\n    textColor: s.textColor || buttonTextColor() || '#ffffff',\n  };\n});\n\n/**\n * Signal indicating if the Main Button is currently mounted.\n */\nexport const [_isMounted, isMounted] = createSignalsTuple(false);\n\n/**\n * Signal containing the current Main Button background color.\n */\nexport const backgroundColor = fromState('backgroundColor');\n\n/**\n * Signal indicating if the Main Button has a shining effect.\n */\nexport const hasShineEffect = fromState('hasShineEffect');\n\n/**\n * Signal indicating if the Main Button is currently active and can be clicked.\n */\nexport const isEnabled = fromState('isEnabled');\n\n/**\n * Signal indicating if the Main Button displays a loader inside it.\n */\nexport const isLoaderVisible = fromState('isLoaderVisible');\n\n/**\n * Signal indicating if the Main Button is currently visible.\n */\nexport const isVisible = fromState('isVisible');\n\n/**\n * Signal containing the Main Button text.\n */\nexport const text = fromState('text');\n\n/**\n * Signal containing the current Main Button text color.\n */\nexport const textColor = fromState('textColor');\n","import {\n  off,\n  on,\n  type EventListener,\n} from '@telegram-apps/bridge';\nimport { isPageReload } from '@telegram-apps/navigation';\nimport { getStorageValue, setStorageValue } from '@telegram-apps/toolkit';\n\nimport { postEvent } from '@/globals.js';\nimport { createWrapBasic } from '@/scopes/wrappers/createWrapBasic.js';\nimport { createWrapMounted } from '@/scopes/wrappers/createWrapMounted.js';\nimport { removeUndefined } from '@/utils/removeUndefined.js';\n\nimport { internalState, isMounted, state, _isMounted } from './signals.js';\nimport type { State } from './types.js';\n\ntype StorageValue = State;\n\nconst SETUP_METHOD_NAME = 'web_app_setup_main_button';\nconst CLICK_EVENT_NAME = 'main_button_pressed';\nconst COMPONENT_NAME = 'mainButton';\n\nconst wrapBasic = createWrapBasic(COMPONENT_NAME);\nconst wrapMounted = createWrapMounted(COMPONENT_NAME, isMounted);\n\n/**\n * Mounts the Main Button restoring its state.\n * @throws {FunctionNotAvailableError} The environment is unknown\n * @throws {FunctionNotAvailableError} The SDK is not initialized\n * @example\n * if (mount.isAvailable()) {\n *   mount();\n * }\n */\nexport const mount = wrapBasic('mount', (): void => {\n  if (!_isMounted()) {\n    const prev = isPageReload() && getStorageValue<StorageValue>(COMPONENT_NAME);\n    prev && internalState.set(prev);\n    _isMounted.set(true);\n  }\n});\n\n/**\n * Adds a new Main Button click listener.\n * @param fn - event listener.\n * @returns A function to remove bound listener.\n * @throws {FunctionNotAvailableError} The environment is unknown\n * @throws {FunctionNotAvailableError} The SDK is not initialized\n * @example\n * if (onClick.isAvailable()) {\n *   const off = onClick(() => {\n *     console.log('User clicked the Main Button');\n *     off();\n *   });\n * }\n */\nexport const onClick = wrapBasic(\n  'onClick',\n  (fn: EventListener<'main_button_pressed'>): VoidFunction => {\n    return on(CLICK_EVENT_NAME, fn);\n  },\n);\n\n/**\n * Removes the Main Button click listener.\n * @param fn - an event listener.\n * @throws {FunctionNotAvailableError} The environment is unknown\n * @throws {FunctionNotAvailableError} The SDK is not initialized\n * @example\n * if (offClick.isAvailable()) {\n *   function listener() {\n *     console.log('User clicked the Main Button');\n *     offClick(listener);\n *   }\n *   onClick(listener);\n * }\n */\nexport const offClick = wrapBasic(\n  'offClick',\n  (fn: EventListener<'main_button_pressed'>): void => {\n    off(CLICK_EVENT_NAME, fn);\n  },\n);\n\n/**\n * Updates the Main Button state.\n * @param updates - state changes to perform.\n * @throws {FunctionNotAvailableError} The environment is unknown\n * @throws {FunctionNotAvailableError} The SDK is not initialized\n * @throws {FunctionNotAvailableError} The parent component is not mounted\n * @example\n * if (setParams.isAvailable()) {\n *   setParams({\n *     text: 'Submit',\n *     isEnabled: true,\n *     hasShineEffect: true,\n *   });\n * }\n */\nexport const setParams = wrapMounted(\n  'setParams',\n  (updates: Partial<State>): void => {\n    internalState.set({ ...internalState(), ...removeUndefined(updates) });\n    setStorageValue<StorageValue>(COMPONENT_NAME, internalState());\n\n    // We should not commit changes until the payload is correct.\n    // Some version of Telegram will crash due to the empty value of the text.\n    const s = state();\n    s.text && postEvent(SETUP_METHOD_NAME, {\n      color: s.backgroundColor,\n      has_shine_effect: s.hasShineEffect,\n      is_active: s.isEnabled,\n      is_progress_visible: s.isLoaderVisible,\n      is_visible: s.isVisible,\n      text: s.text,\n      text_color: s.textColor,\n    });\n  },\n);\n\n/**\n * Unmounts the Main Button.\n *\n * Note that this function does not remove listeners added via the `onClick`\n * function, so you have to remove them on your own.\n * @see onClick\n */\nexport function unmount(): void {\n  _isMounted.set(false);\n}\n","/**\n * Sets CSS variable globally.\n * @param name - variable name.\n * @param value - variable value.\n */\nexport function setCssVar(name: string, value: string | null): void {\n  document.documentElement.style.setProperty(name, value);\n}\n\n/**\n * Deletes specified CSS variable.\n * @param name - variable name.\n */\nexport function deleteCssVar(name: string): void {\n  document.documentElement.style.removeProperty(name);\n}\n","import {\n  off,\n  on,\n  type EventListener,\n} from '@telegram-apps/bridge';\nimport { isPageReload } from '@telegram-apps/navigation';\nimport { getStorageValue, setStorageValue, snakeToKebab } from '@telegram-apps/toolkit';\nimport { batch } from '@telegram-apps/signals';\nimport type { RGB, ThemeParams } from '@telegram-apps/types';\nimport { AbortablePromise } from 'better-promises';\n\nimport { createWrapMounted } from '@/scopes/wrappers/createWrapMounted.js';\nimport { createWrapBasic } from '@/scopes/wrappers/createWrapBasic.js';\nimport { deleteCssVar, setCssVar } from '@/utils/css-vars.js';\nimport { CSSVarsBoundError } from '@/errors.js';\nimport { defineMountFn } from '@/scopes/defineMountFn.js';\nimport { $launchParams } from '@/globals.js';\nimport { signalCancel } from '@/scopes/signalCancel.js';\nimport type { RequestOptionsNoCapture } from '@/types.js';\n\nimport { _isCssVarsBound, _state } from './signals.js';\nimport type { GetCssVarNameFn } from './types.js';\n\ntype StorageValue = ThemeParams;\n\nconst COMPONENT_NAME = 'themeParams';\nconst THEME_CHANGED_EVENT = 'theme_changed';\nconst wrapBasic = createWrapBasic(COMPONENT_NAME);\n\nconst onThemeChanged: EventListener<'theme_changed'> = ({ theme_params: value }) => {\n  _state.set(value);\n  setStorageValue<StorageValue>(COMPONENT_NAME, value);\n};\n\nconst [\n  mountFn,\n  tMountPromise,\n  tMountError,\n  tIsMounted,\n] = defineMountFn(\n  COMPONENT_NAME,\n  // eslint-disable-next-line @typescript-eslint/no-unused-vars\n  (_options?: RequestOptionsNoCapture): AbortablePromise<ThemeParams> => {\n    return AbortablePromise.resolve(\n      (isPageReload() && getStorageValue<StorageValue>(COMPONENT_NAME))\n      || $launchParams().tgWebAppThemeParams\n      || {},\n    );\n  },\n  s => {\n    on(THEME_CHANGED_EVENT, onThemeChanged);\n    _state.set(s);\n  },\n);\n\nconst wrapMounted = createWrapMounted(COMPONENT_NAME, tIsMounted[0]);\n\n/**\n * Creates CSS variables connected with the current theme parameters.\n *\n * By default, created CSS variables names are following the pattern \"--tg-theme-{name}\", where\n * {name} is a theme parameters key name converted from snake case to kebab case.\n *\n * Default variables:\n * - `--tg-theme-bg-color`\n * - `--tg-theme-secondary-text-color`\n *\n * Variables are being automatically updated if theme parameters were changed.\n *\n * @param getCSSVarName - function, returning complete CSS variable name for the specified\n * theme parameters key.\n * @returns Function to stop updating variables.\n * @throws {FunctionNotAvailableError} The environment is unknown\n * @throws {FunctionNotAvailableError} The SDK is not initialized\n * @throws {CSSVarsBoundError} CSS variables are already bound\n * @throws {FunctionNotAvailableError} The parent component is not mounted\n * @example Using no arguments\n * if (bindCssVars.isAvailable()) {\n *   bindCssVars();\n * }\n * @example Using custom CSS vars generator\n * if (bindCssVars.isAvailable()) {\n *   bindCssVars(key => `--my-prefix-${key}`);\n * }\n */\nexport const bindCssVars = wrapMounted(\n  'bindCssVars',\n  (getCSSVarName?: GetCssVarNameFn): VoidFunction => {\n    if (_isCssVarsBound()) {\n      throw new CSSVarsBoundError();\n    }\n\n    getCSSVarName ||= (prop) => `--tg-theme-${snakeToKebab(prop)}`;\n\n    function forEachEntry(fn: (key: string, value: RGB) => void): void {\n      Object.entries(_state()).forEach(([k, v]) => {\n        v && fn(k, v);\n      });\n    }\n\n    function actualize(): void {\n      forEachEntry((k, v) => {\n        setCssVar(getCSSVarName!(k), v);\n      });\n    }\n\n    actualize();\n    _state.sub(actualize);\n    _isCssVarsBound.set(true);\n\n    return () => {\n      forEachEntry(deleteCssVar);\n      _state.unsub(actualize);\n      _isCssVarsBound.set(false);\n    };\n  },\n);\n\n/**\n * Mounts the Theme Params component restoring its state.\n * @throws {FunctionNotAvailableError} The environment is unknown\n * @throws {FunctionNotAvailableError} The SDK is not initialized\n * @throws {FunctionNotAvailableError} The function is not supported\n * @deprecated Use `mountSync`.\n * @example\n * if (mount.isAvailable()) {\n *   await mount();\n * }\n */\nexport const mount = wrapBasic('mount', mountFn);\n/**\n * @deprecated The initialization is synchronous. Use `mountSync`.\n */\nexport const isMounting = tMountPromise[2];\n/**\n * @deprecated The initialization is synchronous. Use `mountSync`.\n */\nexport const mountPromise = tMountPromise[1];\n/**\n * @deprecated The initialization is synchronous. Use `mountSync`.\n */\nexport const mountError = tMountError[1];\n\nexport const [_isMounted, isMounted] = tIsMounted;\n\n/**\n * Mounts the Theme Params component restoring its state.\n * @throws {FunctionNotAvailableError} The environment is unknown\n * @throws {FunctionNotAvailableError} The SDK is not initialized\n * @throws {FunctionNotAvailableError} The function is not supported\n * @example\n * if (mountSync.isAvailable()) {\n *   mountSync();\n * }\n */\nexport const mountSync = wrapBasic('mountSync', () => {\n  if (!_isMounted()) {\n    const tp = (isPageReload() && getStorageValue<StorageValue>(COMPONENT_NAME))\n      || $launchParams().tgWebAppThemeParams\n      || {};\n    on(THEME_CHANGED_EVENT, onThemeChanged);\n    batch(() => {\n      _state.set(tp);\n      _isMounted.set(true);\n    });\n  }\n});\n\n/**\n * Unmounts the Theme Params component.\n */\nexport function unmount(): void {\n  signalCancel(mountPromise);\n  off(THEME_CHANGED_EVENT, onThemeChanged);\n  _isMounted.set(false);\n}","import type { Computed } from '@telegram-apps/signals';\nimport type { RGB } from '@telegram-apps/types';\nimport { isRGB } from '@telegram-apps/transformers';\n\nimport { state as themeParamsState } from '@/scopes/components/theme-params/signals.js';\nimport { createComputed } from '@/signals-registry.js';\n\nimport type { AnyColor } from './types.js';\n\n// #__NO_SIDE_EFFECTS__\nexport function rgbComputedBasedOn(signal: Computed<AnyColor>): Computed<RGB | undefined> {\n  return createComputed<RGB | undefined>(() => rgbBasedOn(signal()));\n}\n\nexport function rgbBasedOn(color: AnyColor): RGB | undefined {\n  return isRGB(color) ? color : themeParamsState()[color];\n}","import { isRGB } from '@telegram-apps/transformers';\nimport type { RGB } from '@telegram-apps/types';\n\nimport { isColorDark } from '@/utils/isColorDark.js';\nimport {\n  secondaryBackgroundColor as themeSecondaryBgColor,\n  state as themeParamsState,\n} from '@/scopes/components/theme-params/signals.js';\nimport { createComputed, createSignalsTuple } from '@/signals-registry.js';\nimport { rgbComputedBasedOn } from './utils.js';\n\nimport type { AnyColor, State } from './types.js';\n\n/**\n * The Mini App background color.\n *\n * Represents an RGB color, or theme parameters key, like \"bg_color\", \"secondary_bg_color\", etc.\n *\n * Note that using a theme parameters key, background color becomes bound to the current\n * theme parameters, making it automatically being updated whenever theme parameters change.\n * In order to remove this bind, use an explicit RGB color.\n */\nexport const [_backgroundColor, backgroundColor] = createSignalsTuple<AnyColor>('bg_color');\n\n/**\n * RGB representation of the background color.\n *\n * This value requires the Theme Params component to be mounted to extract a valid RGB value\n * of the color key.\n */\nexport const backgroundColorRGB = rgbComputedBasedOn(_backgroundColor);\n\n\n/**\n * The Mini App bottom bar background color.\n */\nexport const [_bottomBarColor, bottomBarColor] = createSignalsTuple<AnyColor>('bottom_bar_bg_color');\n\n/**\n * RGB representation of the bottom bar background color.\n *\n * This value requires the Theme Params component to be mounted to extract a valid RGB value\n * of the color key.\n */\nexport const bottomBarColorRGB = createComputed<RGB | undefined>(() => {\n  const color = _bottomBarColor();\n  return isRGB(color)\n    ? color\n    // Falling back to secondary_bg_color following the logic from the Telegram SDK.\n    : themeParamsState()[color] || themeSecondaryBgColor();\n});\n\n/**\n * The Mini App header color.\n */\nexport const [_headerColor, headerColor] = createSignalsTuple<AnyColor>('bg_color');\n\n/**\n * RGB representation of the header color.\n *\n * This value requires the Theme Params component to be mounted to extract a valid RGB value\n * of the color key.\n */\nexport const headerColorRGB = rgbComputedBasedOn(_headerColor);\n\n/**\n * True if CSS variables are currently bound.\n */\nexport const [_isCssVarsBound, isCssVarsBound] = createSignalsTuple(false);\n\n/**\n * True if the current Mini App background color is recognized as dark.\n */\nexport const isDark = createComputed(() => {\n  const color = backgroundColorRGB();\n  return color ? isColorDark(color) : false;\n});\n\n/**\n * Signal indicating if the mini app is currently active.\n */\nexport const [_isActive, isActive] = createSignalsTuple(true);\n\n/**\n * Complete component state.\n */\nexport const state = createComputed<State>(() => ({\n  backgroundColor: _backgroundColor(),\n  bottomBarColor: _bottomBarColor(),\n  headerColor: _headerColor(),\n  isActive: _isActive(),\n}));\n","import {\n  supports,\n  on,\n  off,\n  type EventListener,\n  type MethodName,\n} from '@telegram-apps/bridge';\nimport { isRGB } from '@telegram-apps/transformers';\nimport { isPageReload } from '@telegram-apps/navigation';\nimport { type Computed, type SubscribeListenerFn, batch } from '@telegram-apps/signals';\nimport {\n  camelToKebab,\n  createCbCollector,\n  getStorageValue,\n  setStorageValue,\n} from '@telegram-apps/toolkit';\nimport type { RGB, ThemeParams } from '@telegram-apps/types';\n\nimport { version, postEvent } from '@/globals.js';\nimport {\n  mount as mountThemeParams,\n  mountSync as mountThemeParamsSync,\n} from '@/scopes/components/theme-params/methods.js';\nimport { createWrapComplete } from '@/scopes/wrappers/createWrapComplete.js';\nimport { createWrapSupported } from '@/scopes/wrappers/createWrapSupported.js';\nimport { createWrapBasic } from '@/scopes/wrappers/createWrapBasic.js';\nimport { createComputed } from '@/signals-registry.js';\nimport { CSSVarsBoundError, UnknownThemeParamsKeyError } from '@/errors.js';\nimport { deleteCssVar, setCssVar } from '@/utils/css-vars.js';\nimport { defineMountFn } from '@/scopes/defineMountFn.js';\nimport { signalCancel } from '@/scopes/signalCancel.js';\nimport type { RequestOptionsNoCapture } from '@/types.js';\n\nimport {\n  _isCssVarsBound,\n  state,\n  headerColorRGB,\n  bottomBarColorRGB,\n  backgroundColorRGB,\n  _isActive,\n  _backgroundColor,\n  _bottomBarColor,\n  _headerColor,\n} from './signals.js';\nimport type { AnyColor, GetCssVarNameFn, State } from './types.js';\nimport { rgbBasedOn } from './utils.js';\nimport { themeParamsState } from '@/scopes/components/theme-params/exports.js';\n\ntype StorageValue = State;\n\nconst SET_BG_COLOR_METHOD = 'web_app_set_background_color';\nconst SET_BOTTOM_BAR_COLOR_METHOD = 'web_app_set_bottom_bar_color';\nconst SET_HEADER_COLOR_METHOD = 'web_app_set_header_color';\nconst VISIBILITY_CHANGED_EVENT = 'visibility_changed';\nconst COMPONENT_NAME = 'miniApp';\n\nconst isSupportedSchema = {\n  any: [\n    SET_BG_COLOR_METHOD,\n    SET_BOTTOM_BAR_COLOR_METHOD,\n    SET_HEADER_COLOR_METHOD,\n  ] as MethodName[],\n};\n\n/**\n * True if the Mini App component is supported.\n */\nexport const isSupported = createComputed(() => {\n  return isSupportedSchema.any.some(method => supports(method, version()));\n});\n\nconst onVisibilityChanged: EventListener<'visibility_changed'> = (data) => {\n  _isActive.set(data.is_visible);\n  saveState();\n};\n\nconst onThemeParamsChanged: SubscribeListenerFn<ThemeParams> = themeParams => {\n  ([\n    [_headerColor, SET_HEADER_COLOR_METHOD],\n    [_backgroundColor, SET_BG_COLOR_METHOD],\n    [_bottomBarColor, SET_BOTTOM_BAR_COLOR_METHOD],\n  ] as const).forEach(([signal, method]) => {\n    const color = signal();\n    if (!isRGB(color) && (\n      // Header color setter uses additional checks. We don't apply changes if the current\n      // value is a known color key because it updates automatically by itself.\n      method !== SET_HEADER_COLOR_METHOD\n      || (color !== 'bg_color' && color !== 'secondary_bg_color')\n    )) {\n      const rgb = themeParams[color];\n      rgb && postEvent(method, { color: rgb });\n    }\n  });\n};\n\nconst [\n  mountFn,\n  tMountPromise,\n  tMountError,\n  tIsMounted,\n] = defineMountFn(\n  COMPONENT_NAME,\n  (options?: RequestOptionsNoCapture) => {\n    return mountThemeParams(options).then(() => {\n      return isPageReload() && getStorageValue<StorageValue>(COMPONENT_NAME) || undefined;\n    });\n  },\n  s => {\n    setBackgroundColor.ifAvailable(s ? s.backgroundColor : 'bg_color');\n    setBottomBarColor.ifAvailable(s ? s.bottomBarColor : 'bottom_bar_bg_color');\n    setHeaderColor.ifAvailable(s ? s.headerColor : 'bg_color');\n    _isActive.set(s ? s.isActive : true);\n\n    on(VISIBILITY_CHANGED_EVENT, onVisibilityChanged);\n    themeParamsState.sub(onThemeParamsChanged);\n  },\n);\n\nconst wrapBasic = createWrapBasic(COMPONENT_NAME);\nconst wrapSupported = createWrapSupported(COMPONENT_NAME, isSupportedSchema);\nconst wrapComplete = createWrapComplete(COMPONENT_NAME, tIsMounted[0], isSupportedSchema);\n\n/**\n * Creates CSS variables connected with the mini app.\n *\n * Default variables:\n * - `--tg-bg-color`\n * - `--tg-header-color`\n * - `--tg-bottom-bar-color`\n *\n * Variables are being automatically updated if theme parameters were changed.\n *\n * @param getCSSVarName - function, returning complete CSS variable name for the specified\n * mini app key.\n * @returns Function to stop updating variables.\n * @throws {FunctionNotAvailableError} The environment is unknown\n * @throws {CSSVarsBoundError} CSS variables are already bound\n * @throws {FunctionNotAvailableError} The parent component is not mounted\n * @throws {FunctionNotAvailableError} The SDK is not initialized\n * @example Using no arguments\n * if (bindCssVars.isAvailable()) {\n *   bindCssVars();\n * }\n * @example Using custom CSS vars generator\n * if (bindCssVars.isAvailable()) {\n *   bindCssVars(key => `--my-prefix-${key}`);\n * }\n */\nexport const bindCssVars = wrapComplete(\n  'bindCssVars',\n  (getCSSVarName?: GetCssVarNameFn): VoidFunction => {\n    if (_isCssVarsBound()) {\n      throw new CSSVarsBoundError();\n    }\n\n    const [addCleanup, cleanup] = createCbCollector();\n\n    /**\n     * Binds specified CSS variable to a signal.\n     * @param cssVar - CSS variable name.\n     * @param signal - signal to listen changes to.\n     */\n    function bind(cssVar: string, signal: Computed<RGB | undefined>) {\n      function update() {\n        setCssVar(cssVar, signal() || null);\n      }\n\n      // Instantly set CSS variable.\n      update();\n\n      // Remember to clean this relation up.\n      addCleanup(signal.sub(update), deleteCssVar.bind(null, cssVar));\n    }\n\n    getCSSVarName ||= (prop) => `--tg-${camelToKebab(prop)}`;\n    bind(getCSSVarName('bgColor'), backgroundColorRGB);\n    bind(getCSSVarName('bottomBarColor'), bottomBarColorRGB);\n    bind(getCSSVarName('headerColor'), headerColorRGB);\n    addCleanup(() => {\n      _isCssVarsBound.set(false);\n    });\n\n    _isCssVarsBound.set(true);\n\n    return cleanup;\n  },\n);\n\n/**\n * Closes the Mini App.\n * @param returnBack - should the client return to the previous activity.\n * @throws {FunctionNotAvailableError} The environment is unknown\n * @throws {FunctionNotAvailableError} The SDK is not initialized\n * @example\n * if (close.isAvailable()) {\n *   close();\n * }\n */\nexport const close = wrapBasic('close', (returnBack?: boolean): void => {\n  postEvent('web_app_close', { return_back: returnBack });\n});\n\n/**\n * Mounts the component.\n *\n * This function restores the component state and is automatically saving it in the local storage\n * if it changed.\n *\n * Internally, the function mounts the Theme Params component to work with correctly extracted\n * theme palette values.\n * @since Mini Apps v6.1\n * @throws {FunctionNotAvailableError} The environment is unknown\n * @throws {FunctionNotAvailableError} The SDK is not initialized\n * @throws {FunctionNotAvailableError} The function is not supported\n * @deprecated Use `mountSync`.\n * @example\n * if (mount.isAvailable()) {\n *   await mount();\n * }\n */\nexport const mount = wrapSupported('mount', mountFn);\n/**\n * @deprecated The initialization is synchronous. Use `mountSync`.\n */\nexport const isMounting = tMountPromise[2];\n/**\n * @deprecated The initialization is synchronous. Use `mountSync`.\n */\nexport const mountPromise = tMountPromise[1];\n/**\n * @deprecated The initialization is synchronous. Use `mountSync`.\n */\nexport const mountError = tMountError[1];\n\nexport const [_isMounted, isMounted] = tIsMounted;\n\n/**\n * Mounts the component.\n *\n * This function restores the component state and is automatically saving it in the local storage\n * if it changed.\n *\n * Internally, the function mounts the Theme Params component to work with correctly extracted\n * theme palette values.\n * @since Mini Apps v6.1\n * @throws {FunctionNotAvailableError} The environment is unknown\n * @throws {FunctionNotAvailableError} The SDK is not initialized\n * @throws {FunctionNotAvailableError} The function is not supported\n * @example\n * if (mountSync.isAvailable()) {\n *   mountSync();\n * }\n */\nexport const mountSync = wrapSupported('mountSync', () => {\n  if (!_isMounted()) {\n    mountThemeParamsSync();\n    const s = isPageReload() && getStorageValue<StorageValue>(COMPONENT_NAME) || undefined;\n\n    setBackgroundColor.ifAvailable(s ? s.backgroundColor : 'bg_color');\n    setBottomBarColor.ifAvailable(s ? s.bottomBarColor : 'bottom_bar_bg_color');\n    setHeaderColor.ifAvailable(s ? s.headerColor : 'bg_color');\n    on(VISIBILITY_CHANGED_EVENT, onVisibilityChanged);\n    themeParamsState.sub(onThemeParamsChanged);\n\n    batch(() => {\n      _isActive.set(s ? s.isActive : true);\n      _isMounted.set(true);\n    });\n  }\n});\n\n/**\n * Informs the Telegram app that the Mini App is ready to be displayed.\n *\n * It is recommended to call this method as early as possible, as soon as all\n * essential interface elements loaded.\n *\n * Once this method is called, the loading placeholder is hidden and the Mini\n * App shown.\n *\n * If the method is not called, the placeholder will be hidden only when the\n * page was fully loaded.\n * @throws {FunctionNotAvailableError} The environment is unknown\n * @throws {FunctionNotAvailableError} The SDK is not initialized\n * @example\n * if (ready.isAvailable()) {\n *   ready();\n * }\n */\nexport const ready = wrapBasic('ready', (): void => {\n  postEvent('web_app_ready');\n});\n\nfunction saveState() {\n  setStorageValue<StorageValue>(COMPONENT_NAME, state());\n}\n\n/**\n * Updates the background color.\n * @since Mini Apps v6.1\n * @throws {FunctionNotAvailableError} The environment is unknown\n * @throws {FunctionNotAvailableError} The SDK is not initialized\n * @throws {FunctionNotAvailableError} The function is not supported\n * @throws {FunctionNotAvailableError} The parent component is not mounted\n * @throws {UnknownThemeParamsKeyError} Unknown theme params key passed\n * @example\n * if (setBackgroundColor.isAvailable()) {\n *   setBackgroundColor('bg_color');\n * }\n */\nexport const setBackgroundColor = wrapComplete(\n  'setBackgroundColor',\n  (color: AnyColor): void => {\n    if (color === _backgroundColor()) {\n      return;\n    }\n    const rgb = rgbBasedOn(color);\n    if (!rgb) {\n      throw new UnknownThemeParamsKeyError(color);\n    }\n    postEvent(SET_BG_COLOR_METHOD, { color: rgb });\n    _backgroundColor.set(color);\n    saveState();\n  },\n  SET_BG_COLOR_METHOD,\n);\n\n/**\n * Updates the bottom bar background color.\n * @since Mini Apps v7.10\n * @throws {FunctionNotAvailableError} The environment is unknown\n * @throws {FunctionNotAvailableError} The SDK is not initialized\n * @throws {FunctionNotAvailableError} The function is not supported\n * @throws {FunctionNotAvailableError} The parent component is not mounted\n * @throws {UnknownThemeParamsKeyError} Unknown theme params key passed\n * @example\n * if (setBottomBarColor.isAvailable()) {\n *   setBottomBarColor('#ff11a3');\n * }\n */\nexport const setBottomBarColor = wrapComplete(\n  'setBottomBarColor',\n  (color: AnyColor) => {\n    if (color === _bottomBarColor()) {\n      return;\n    }\n    const rgb = rgbBasedOn(color);\n    if (!rgb) {\n      throw new UnknownThemeParamsKeyError(color);\n    }\n    postEvent(SET_BOTTOM_BAR_COLOR_METHOD, { color: rgb });\n    _bottomBarColor.set(color);\n    saveState();\n  },\n  SET_BOTTOM_BAR_COLOR_METHOD,\n);\n\n/**\n * Updates the header color.\n * @since Mini Apps v6.1\n * @throws {FunctionNotAvailableError} The environment is unknown\n * @throws {FunctionNotAvailableError} The SDK is not initialized\n * @throws {FunctionNotAvailableError} The function is not supported\n * @throws {FunctionNotAvailableError} The parent component is not mounted\n * @throws {UnknownThemeParamsKeyError} Unknown theme params key passed\n * @example Using known color key\n * if (setHeaderColor.isAvailable()) {\n *   setHeaderColor('bg_color');\n * }\n * @example Using RGB\n * if (setHeaderColor.isAvailable() && setHeaderColor.supports.rgb()) {\n *   setHeaderColor('#ffaabb');\n * }\n */\nexport const setHeaderColor = wrapComplete(\n  'setHeaderColor',\n  (color: AnyColor): void => {\n    if (color === _headerColor()) {\n      return;\n    }\n    if (color === 'bg_color' || color === 'secondary_bg_color') {\n      postEvent(SET_HEADER_COLOR_METHOD, { color_key: color });\n    } else {\n      const rgb = rgbBasedOn(color);\n      if (!rgb) {\n        throw new UnknownThemeParamsKeyError(color);\n      }\n      postEvent(SET_HEADER_COLOR_METHOD, { color: rgb });\n    }\n    _headerColor.set(color);\n    saveState();\n  },\n  SET_HEADER_COLOR_METHOD,\n  {\n    rgb: [SET_HEADER_COLOR_METHOD, 'color', isRGB],\n  },\n);\n\n/**\n * Unmounts the component, removing the listener, saving the component state in the local storage.\n */\nexport function unmount(): void {\n  signalCancel(mountPromise);\n  off(VISIBILITY_CHANGED_EVENT, onVisibilityChanged);\n  themeParamsState.unsub(onThemeParamsChanged);\n  _isMounted.set(false);\n}\n","import { type PopupParams } from '@telegram-apps/bridge';\n\nimport { InvalidArgumentsError } from '@/errors.js';\n\nimport type { OpenOptions } from './types.js';\n\n/**\n * Prepares popup parameters before sending them to native app.\n * @param params - popup parameters.\n * @throws {InvalidArgumentsError} Invalid title\n * @throws {InvalidArgumentsError} Invalid message\n * @throws {InvalidArgumentsError} Invalid buttons count\n * @throws {InvalidArgumentsError} Invalid button id length\n * @throws {InvalidArgumentsError} Invalid button text length\n */\nexport function prepareParams(params: OpenOptions): PopupParams {\n  const message = params.message.trim();\n  const title = (params.title || '').trim();\n  const buttons = params.buttons || [];\n\n  if (title.length > 64) {\n    throw new InvalidArgumentsError(`Invalid title: ${title}`);\n  }\n  if (!message || message.length > 256) {\n    throw new InvalidArgumentsError(`Invalid message: ${message}`);\n  }\n  if (buttons.length > 3) {\n    throw new InvalidArgumentsError(`Invalid buttons count: ${buttons.length}`);\n  }\n\n  return {\n    title,\n    message,\n    buttons: buttons.length\n      ? buttons.map((b, idx) => {\n        const id = b.id || '';\n        if (id.length > 64) {\n          throw new InvalidArgumentsError(`Button with index ${idx} has invalid id: ${id}`);\n        }\n\n        if (!b.type || b.type === 'default' || b.type === 'destructive') {\n          const text = b.text.trim();\n          if (!text || text.length > 64) {\n            throw new InvalidArgumentsError(`Button with index ${idx} has invalid text: ${text}`);\n          }\n          return { type: b.type, text, id };\n        }\n        return { type: b.type, id };\n      })\n      : [{ type: 'close', id: '' }],\n  };\n}","import type { AbortablePromise } from 'better-promises';\n\nimport { request } from '@/globals.js';\nimport { createIsSupported } from '@/scopes/createIsSupported.js';\nimport { createWrapSupported } from '@/scopes/wrappers/createWrapSupported.js';\nimport { defineNonConcurrentFn } from '@/scopes/defineNonConcurrentFn.js';\n\nimport { prepareParams } from './prepareParams.js';\nimport type { ShowOptions } from './types.js';\n\nconst OPEN_METHOD = 'web_app_open_popup';\nconst wrapSupported = createWrapSupported('popup', OPEN_METHOD);\n\n/**\n * Signal indicating if popups are supported.\n */\nexport const isSupported = createIsSupported(OPEN_METHOD);\n\nconst [fn, tPromise, tShowError] = defineNonConcurrentFn(\n  (options: ShowOptions): AbortablePromise<string | null> => {\n    return request(OPEN_METHOD, 'popup_closed', {\n      ...options,\n      params: prepareParams(options),\n    }).then(({ button_id: buttonId }) => buttonId === undefined ? null : buttonId);\n  },\n  'A popup is already opened',\n);\n\n/**\n * @deprecated Deprecated for consistence naming, to be removed in the next major update. Use\n *   `show` instead.\n */\nexport const open = wrapSupported('open', fn);\n/**\n * @deprecated Deprecated for consistence naming, to be removed in the next major update. Use\n *   `showPromise` instead.\n */\nconst openPromise = tPromise[1];\n/**\n * @deprecated Deprecated for consistence naming, to be removed in the next major update. Use\n *   `isShown` instead.\n */\nconst isOpened = tPromise[2];\n/**\n * @deprecated Deprecated for consistence naming, to be removed in the next major update. Use\n *   `showError` instead.\n */\nconst openError = tShowError[1];\n\nexport { openPromise, isOpened, openError };\n\n/**\n * A method that shows a native popup described by the `params` argument.\n * The promise will be resolved when the popup is closed. Resolved value will have\n * an identifier of the pressed button.\n *\n * If a user clicked outside the popup or clicked the top right popup close\n * button, null will be resolved.\n *\n * @param options - popup parameters.\n * @since Mini Apps v6.2\n * @throws {InvalidArgumentsError} Invalid title\n * @throws {InvalidArgumentsError} Invalid message\n * @throws {InvalidArgumentsError} Invalid buttons count\n * @throws {InvalidArgumentsError} Invalid button id length\n * @throws {InvalidArgumentsError} Invalid button text length\n * @throws {ConcurrentCallError} A popup is already opened\n * @throws {FunctionNotAvailableError} The environment is unknown\n * @throws {FunctionNotAvailableError} The SDK is not initialized\n * @throws {FunctionNotAvailableError} The function is not supported\n * @example\n * if (open.isAvailable()) {\n *   const buttonId = await open({\n *     title: 'Confirm action',\n *     message: 'Do you really want to buy this burger?',\n *     buttons: [\n *       { id: 'yes', text: 'Yes' },\n *       { id: 'no', type: 'destructive', text: 'No' },\n *     ],\n *   });\n * }\n */\nexport const show = wrapSupported('show', fn);\nexport const [, showPromise, isShown] = tPromise;\nexport const [, showError] = tShowError;\n","import { on } from '@telegram-apps/bridge';\nimport { createCbCollector } from '@telegram-apps/toolkit';\nimport { AbortablePromise, ManualPromise } from 'better-promises';\n\nimport { postEvent } from '@/globals.js';\nimport { createWrapSupported } from '@/scopes/wrappers/createWrapSupported.js';\nimport { defineNonConcurrentFn } from '@/scopes/defineNonConcurrentFn.js';\nimport { createIsSupported } from '@/scopes/createIsSupported.js';\nimport { signalCancel } from '@/scopes/signalCancel.js';\nimport type { RequestOptionsNoCapture } from '@/types.js';\nimport { ignoreCanceled } from '@/utils/ignoreCanceled.js';\n\ninterface OpenSharedOptions extends RequestOptionsNoCapture {\n  /**\n   * Title to be displayed in the scanner.\n   */\n  text?: string;\n}\n\nconst CLOSE_METHOD = 'web_app_close_scan_qr_popup';\nconst OPEN_METHOD = 'web_app_open_scan_qr_popup';\nconst CLOSED_EVENT = 'scan_qr_popup_closed';\nconst TEXT_RECEIVED_EVENT = 'qr_text_received';\n\nconst wrapSupported = createWrapSupported('qrScanner', OPEN_METHOD);\n\n/**\n * Closes the scanner.\n * @since Mini Apps v6.4\n * @throws {FunctionNotAvailableError} The environment is unknown\n * @throws {FunctionNotAvailableError} The SDK is not initialized\n * @throws {FunctionNotAvailableError} The function is not supported\n * @example\n * if (close.isAvailable()) {\n *   close();\n * }\n */\nexport const close = wrapSupported('close', (): void => {\n  postEvent(CLOSE_METHOD);\n  signalCancel(openPromise);\n});\n\n/**\n * Signal indicating if the QR Scanner is currently opened.\n */\nexport const isSupported = createIsSupported(OPEN_METHOD);\n\n/**\n * Opens the scanner and returns a promise which will be resolved with the QR content if the\n * passed `capture` function returned true.\n *\n * The `capture` option may be ommited. In this case, the first scanned QR will be returned.\n *\n * Promise may also be resolved to undefined if the scanner was closed.\n * @param options - method options.\n * @returns A promise with QR content presented as string or undefined if the\n * scanner was closed.\n * @since Mini Apps v6.4\n * @throws {FunctionNotAvailableError} The environment is unknown\n * @throws {FunctionNotAvailableError} The SDK is not initialized\n * @throws {FunctionNotAvailableError} The function is not supported\n * @throws {ConcurrentCallError} The QR Scanner is already opened\n * @example Without `capture` option\n * if (captureOne.isAvailable()) {\n *   const qr = await captureOne({ text: 'Scan any QR' });\n * }\n * @example Using `capture` option\n * if (captureOne.isAvailable()) {\n *   const qr = await captureOne({\n *     text: 'Scan any QR',\n *     capture(scannedQr) {\n *       return scannedQr === 'any expected by me qr';\n *     }\n *   });\n * }\n */\nfunction _open(\n  options?: OpenSharedOptions & {\n    /**\n     * Function, which should return true if the scanned QR should be captured.\n     * @param qr - scanned QR content.\n     */\n    capture?: (qr: string) => boolean;\n  },\n): AbortablePromise<string | undefined>;\n\n/**\n * Opens the scanner and calls the `onCaptured` function each time, a QR was scanned.\n *\n * The function returns a promise which will be resolved when the QR scanner was closed. It expects\n * the scanner to be closed externally by a user or via the `close` method.\n * @param options - method options.\n * @since Mini Apps v6.4\n * @throws {FunctionNotAvailableError} The environment is unknown\n * @throws {FunctionNotAvailableError} The SDK is not initialized\n * @throws {FunctionNotAvailableError} The function is not supported\n * @throws {ConcurrentCallError} The QR Scanner is already opened\n * @example\n * if (captureMany.isAvailable()) {\n *   const promise = await captureMany({\n *     text: 'Scan any QR',\n *     onCaptured(scannedQr) {\n *       if (scannedQr === 'any expected by me qr') {\n *         close();\n *       }\n *     }\n *   });\n *   console.log('The scanner was closed');\n * }\n */\nfunction _open(\n  options: OpenSharedOptions & {\n    /**\n     * Function which will be called if a QR code was scanned.\n     * @param qr - scanned QR content.\n     */\n    onCaptured: (qr: string) => void;\n  },\n): AbortablePromise<void>;\n\nfunction _open(\n  options?: OpenSharedOptions & {\n    onCaptured?: (qr: string) => void;\n    capture?: (qr: string) => boolean;\n  },\n): AbortablePromise<string | undefined | void> {\n  options ||= {};\n  const { onCaptured, text, capture } = options;\n  const [, cleanup] = createCbCollector(\n    on(CLOSED_EVENT, () => {\n      promise.resolve();\n    }),\n    on(TEXT_RECEIVED_EVENT, (event) => {\n      if (onCaptured) {\n        onCaptured(event.data);\n      } else if (!capture || capture(event.data)) {\n        promise.resolve(event.data);\n        postEvent(CLOSE_METHOD);\n      }\n    }),\n  );\n\n  const promise = new ManualPromise<string | void>(options);\n  (options.postEvent || postEvent)(OPEN_METHOD, { text });\n\n  return AbortablePromise.resolve(promise).catch(ignoreCanceled).finally(cleanup);\n}\n\nconst [\n  openFn,\n  tOpenPromise,\n  tOpenError,\n] = defineNonConcurrentFn(_open, 'The QR Scanner is already opened');\n\nexport const open = wrapSupported('open', openFn);\nexport const [, openPromise, isOpened] = tOpenPromise;\nexport const [, openError] = tOpenError;","import type { Computed } from '@telegram-apps/signals';\n\nimport { buttonColor } from '@/scopes/components/theme-params/signals.js';\nimport { bottomBarColorRGB } from '@/scopes/components/mini-app/signals.js';\nimport { createComputed, createSignal, createSignalsTuple } from '@/signals-registry.js';\n\nimport type { State } from './types.js';\n\nfunction fromState<K extends keyof Required<State>>(key: K): Computed<Required<State>[K]> {\n  return createComputed(() => state()[key]);\n}\n\nexport const internalState = createSignal<State>({\n  hasShineEffect: false,\n  isEnabled: true,\n  isLoaderVisible: false,\n  isVisible: false,\n  position: 'left',\n  text: 'Cancel',\n});\n\n/**\n * Complete component state.\n */\nexport const state = createComputed<Required<State>>(() => {\n  const s = internalState();\n  return {\n    ...s,\n    backgroundColor: s.backgroundColor || bottomBarColorRGB() || '#000000',\n    textColor: s.textColor || buttonColor() || '#2481cc',\n  };\n});\n\n/**\n * True if the component is currently mounted.\n */\nexport const [_isMounted, isMounted] = createSignalsTuple(false);\n\n/**\n * @see State.backgroundColor\n */\nexport const backgroundColor = fromState('backgroundColor');\n\n/**\n * @see State.hasShineEffect\n */\nexport const hasShineEffect = fromState('hasShineEffect');\n\n/**\n * @see State.isEnabled\n */\nexport const isEnabled = fromState('isEnabled');\n\n/**\n * @see State.isLoaderVisible\n */\nexport const isLoaderVisible = fromState('isLoaderVisible');\n\n/**\n * @see State.isVisible\n */\nexport const isVisible = fromState('isVisible');\n\n/**\n * @see State.position\n */\nexport const position = fromState('position');\n\n/**\n * @see State.text\n */\nexport const text = fromState('text');\n\n/**\n * @see State.textColor\n */\nexport const textColor = fromState('textColor');\n","import {\n  off,\n  on,\n  type EventListener,\n} from '@telegram-apps/bridge';\nimport { isPageReload } from '@telegram-apps/navigation';\nimport { getStorageValue, setStorageValue } from '@telegram-apps/toolkit';\n\nimport { postEvent } from '@/globals.js';\nimport { createIsSupported } from '@/scopes/createIsSupported.js';\nimport { createWrapComplete } from '@/scopes/wrappers/createWrapComplete.js';\nimport { createWrapSupported } from '@/scopes/wrappers/createWrapSupported.js';\n\nimport { internalState, isMounted, _isMounted, state } from './signals.js';\nimport type { State } from './types.js';\nimport { removeUndefined } from '@/utils/removeUndefined.js';\n\ntype StorageValue = State;\n\nconst SETUP_METHOD_NAME = 'web_app_setup_secondary_button';\nconst CLICK_EVENT_NAME = 'secondary_button_pressed';\nconst COMPONENT_NAME = 'secondaryButton';\n\nconst wrapSupported = createWrapSupported(COMPONENT_NAME, SETUP_METHOD_NAME);\nconst wrapComplete = createWrapComplete(COMPONENT_NAME, isMounted, SETUP_METHOD_NAME);\n\n/**\n * Signal indicating if the Secondary Button is supported.\n */\nexport const isSupported = createIsSupported(SETUP_METHOD_NAME);\n\n/**\n * Mounts the Secondary Button restoring its state.\n * @throws {FunctionNotAvailableError} The environment is unknown\n * @throws {FunctionNotAvailableError} The SDK is not initialized\n * @throws {FunctionNotAvailableError} The function is not supported\n * @example\n * if (mount.isAvailable()) {\n *   mount();\n * }\n */\nexport const mount = wrapSupported('mount', (): void => {\n  if (!_isMounted()) {\n    const prev = isPageReload() && getStorageValue<StorageValue>(COMPONENT_NAME);\n    prev && internalState.set(prev);\n    _isMounted.set(true);\n  }\n});\n\n/**\n * Adds a new Secondary Button click listener.\n * @param fn - event listener.\n * @returns A function to remove bound listener.\n * @throws {FunctionNotAvailableError} The environment is unknown\n * @throws {FunctionNotAvailableError} The SDK is not initialized\n * @throws {FunctionNotAvailableError} The function is not supported\n * @example\n * if (onClick.isAvailable()) {\n *   const off = onClick(() => {\n *     console.log('User clicked the Secondary Button');\n *     off();\n *   });\n * }\n */\nexport const onClick = wrapSupported(\n  'onClick',\n  (fn: EventListener<'secondary_button_pressed'>): VoidFunction => on(CLICK_EVENT_NAME, fn),\n);\n\n/**\n * Removes the Secondary Button click listener.\n * @param fn - an event listener.\n * @throws {FunctionNotAvailableError} The environment is unknown\n * @throws {FunctionNotAvailableError} The SDK is not initialized\n * @throws {FunctionNotAvailableError} The function is not supported\n * @example\n * if (offClick.isAvailable()) {\n *   function listener() {\n *     console.log('User clicked the Secondary Button');\n *     offClick(listener);\n *   }\n *   onClick(listener);\n * }\n */\nexport const offClick = wrapSupported(\n  'offClick',\n  (fn: EventListener<'secondary_button_pressed'>): void => {\n    off(CLICK_EVENT_NAME, fn);\n  },\n);\n\n/**\n * Updates the Secondary Button state.\n * @param updates - state changes to perform.\n * @throws {FunctionNotAvailableError} The environment is unknown\n * @throws {FunctionNotAvailableError} The SDK is not initialized\n * @throws {FunctionNotAvailableError} The parent component is not mounted\n * @throws {FunctionNotAvailableError} The function is not supported\n * @example\n * if (setParams.isAvailable()) {\n *   setParams({\n *     text: 'Submit',\n *     isEnabled: true,\n *     isVisible: true,\n *     position: 'left',\n *   });\n * }\n */\nexport const setParams = wrapComplete(\n  'setParams',\n  (updates: Partial<State>): void => {\n    internalState.set({ ...internalState(), ...removeUndefined(updates) });\n    setStorageValue<StorageValue>(COMPONENT_NAME, internalState());\n\n    // We should not commit changes until the payload is correct. Some version of Telegram will\n    // crash due to the empty value of the text.\n    const s = state();\n    s.text && postEvent(SETUP_METHOD_NAME, {\n      color: s.backgroundColor,\n      has_shine_effect: s.hasShineEffect,\n      is_active: s.isEnabled,\n      is_progress_visible: s.isLoaderVisible,\n      is_visible: s.isVisible,\n      position: s.position,\n      text: s.text,\n      text_color: s.textColor,\n    });\n  },\n);\n\n/**\n * Unmounts the Secondary Button.\n *\n * Note that this function does not remove listeners added via the `onClick`\n * function, so you have to remove them on your own.\n * @see onClick\n */\nexport function unmount(): void {\n  _isMounted.set(false);\n}","import { off, on, type EventListener } from '@telegram-apps/bridge';\nimport { getStorageValue, setStorageValue } from '@telegram-apps/toolkit';\nimport { isPageReload } from '@telegram-apps/navigation';\n\nimport { postEvent } from '@/globals.js';\nimport { createIsSupported } from '@/scopes/createIsSupported.js';\nimport { createWrapComplete } from '@/scopes/wrappers/createWrapComplete.js';\nimport {\n  createWrapSupported,\n} from '@/scopes/wrappers/createWrapSupported.js';\nimport { createSignalsTuple } from '@/signals-registry.js';\n\ntype StorageValue = boolean;\n\nconst SETUP_METHOD_NAME = 'web_app_setup_settings_button';\nconst CLICK_EVENT_NAME = 'settings_button_pressed';\nconst COMPONENT_NAME = 'settingsButton';\n\n/**\n * Signal indicating if the Settings Button is currently visible.\n */\nexport const [_isVisible, isVisible] = createSignalsTuple(false);\n\n/**\n * Signal indicating if the Settings Button is currently mounted.\n */\nexport const [_isMounted, isMounted] = createSignalsTuple(false);\n\n/**\n * Signal indicating if the Settings Button is supported.\n */\nexport const isSupported = createIsSupported(SETUP_METHOD_NAME);\n\nconst wrapSupported = createWrapSupported(COMPONENT_NAME, SETUP_METHOD_NAME);\nconst wrapComplete = createWrapComplete(COMPONENT_NAME, _isMounted, SETUP_METHOD_NAME);\n\n/**\n * Hides the Settings Button.\n * @throws {FunctionNotAvailableError} The environment is unknown\n * @throws {FunctionNotAvailableError} The SDK is not initialized\n * @throws {FunctionNotAvailableError} The function is not supported\n * @throws {FunctionNotAvailableError} The parent component is not mounted\n * @since Mini Apps v6.10\n * @example\n * if (hide.isAvailable()) {\n *   hide();\n * }\n */\nexport const hide = wrapComplete('hide', (): void => {\n  setVisibility(false);\n});\n\n/**\n * Mounts the Settings Button restoring its state.\n * @throws {FunctionNotAvailableError} The environment is unknown\n * @throws {FunctionNotAvailableError} The SDK is not initialized\n * @throws {FunctionNotAvailableError} The function is not supported\n * @since Mini Apps v6.10\n * @example\n * if (mount.isAvailable()) {\n *   mount();\n * }\n */\nexport const mount = wrapSupported('mount', (): void => {\n  if (!_isMounted()) {\n    setVisibility(isPageReload() && getStorageValue<StorageValue>(COMPONENT_NAME) || false);\n    _isMounted.set(true);\n  }\n});\n\nfunction setVisibility(value: boolean): void {\n  if (value !== _isVisible()) {\n    postEvent(SETUP_METHOD_NAME, { is_visible: value });\n    setStorageValue<StorageValue>(COMPONENT_NAME, value);\n    _isVisible.set(value);\n  }\n}\n\n/**\n * Adds a new Settings Button click listener.\n * @param fn - event listener.\n * @returns A function to remove bound listener.\n * @throws {FunctionNotAvailableError} The environment is unknown\n * @throws {FunctionNotAvailableError} The SDK is not initialized\n * @throws {FunctionNotAvailableError} The function is not supported\n * @since Mini Apps v6.10\n * @example\n * if (onClick.isAvailable()) {\n *   const off = onClick(() => {\n *     console.log('User clicked the Settings Button');\n *     off();\n *   });\n * }\n */\nexport const onClick = wrapSupported(\n  'onClick',\n  (fn: EventListener<'settings_button_pressed'>): VoidFunction => on(CLICK_EVENT_NAME, fn),\n);\n\n/**\n * Removes the Settings Button click listener.\n * @param fn - an event listener.\n * @throws {FunctionNotAvailableError} The environment is unknown\n * @throws {FunctionNotAvailableError} The SDK is not initialized\n * @throws {FunctionNotAvailableError} The function is not supported\n * @since Mini Apps v6.10\n * @example\n * if (offClick.isAvailable()) {\n *   function listener() {\n *     console.log('User clicked the Settings Button');\n *     offClick(listener);\n *   }\n *   onClick(listener);\n * }\n */\nexport const offClick = wrapSupported(\n  'offClick',\n  (fn: EventListener<'settings_button_pressed'>): void => {\n    off(CLICK_EVENT_NAME, fn);\n  },\n);\n\n/**\n * Shows the Settings Button.\n * @throws {FunctionNotAvailableError} The environment is unknown\n * @throws {FunctionNotAvailableError} The SDK is not initialized\n * @throws {FunctionNotAvailableError} The function is not supported\n * @throws {FunctionNotAvailableError} The parent component is not mounted\n * @since Mini Apps v6.10\n * @example\n * if (show.isAvailable()) {\n *   show();\n * }\n */\nexport const show = wrapComplete('show', (): void => {\n  setVisibility(true);\n});\n\n/**\n * Unmounts the Settings Button.\n *\n * Note that this function does not remove listeners added via the `onClick`\n * function, so you have to remove them on your own.\n * @see onClick\n */\nexport function unmount(): void {\n  _isMounted.set(false);\n}\n","import { isPageReload } from '@telegram-apps/navigation';\nimport { getStorageValue, setStorageValue } from '@telegram-apps/toolkit';\n\nimport { postEvent } from '@/globals.js';\nimport { createIsSupported } from '@/scopes/createIsSupported.js';\nimport { createWrapComplete } from '@/scopes/wrappers/createWrapComplete.js';\nimport {\n  createWrapSupported,\n} from '@/scopes/wrappers/createWrapSupported.js';\nimport { createSignalsTuple } from '@/signals-registry.js';\n\ntype StorageValue = boolean;\n\nconst SETUP_METHOD_NAME = 'web_app_setup_swipe_behavior';\nconst COMPONENT_NAME = 'swipeBehavior';\n\n/**\n * Signal indicating if the Swipe Behavior component is currently mounted.\n */\nexport const [_isMounted, isMounted] = createSignalsTuple(false);\n\n/**\n * Signal indicating if the Swipe Behavior is supported.\n */\nexport const isSupported = createIsSupported(SETUP_METHOD_NAME);\n\n/**\n * Signal indicating if vertical swipes are enabled.\n */\nexport const [_isVerticalEnabled, isVerticalEnabled] = createSignalsTuple(true);\n\nconst wrapSupported = createWrapSupported(COMPONENT_NAME, SETUP_METHOD_NAME);\nconst wrapComplete = createWrapComplete(COMPONENT_NAME, _isMounted, SETUP_METHOD_NAME);\n\n/**\n * Disables vertical swipes.\n * @since Mini Apps v7.7\n * @throws {FunctionNotAvailableError} The environment is unknown\n * @throws {FunctionNotAvailableError} The SDK is not initialized\n * @throws {FunctionNotAvailableError} The function is not supported\n * @throws {FunctionNotAvailableError} The parent component is not mounted\n * @example\n * if (disableVertical.isAvailable()) {\n *   disableVertical();\n * }\n */\nexport const disableVertical = wrapComplete('disableVertical', (): void => {\n  setVerticalEnabled(false);\n});\n\n/**\n * Enables vertical swipes.\n * @since Mini Apps v7.7\n * @throws {FunctionNotAvailableError} The environment is unknown\n * @throws {FunctionNotAvailableError} The SDK is not initialized\n * @throws {FunctionNotAvailableError} The function is not supported\n * @throws {FunctionNotAvailableError} The parent component is not mounted\n * @example\n * if (enableVertical.isAvailable()) {\n *   enableVertical();\n * }\n */\nexport const enableVertical = wrapComplete('enableVertical', (): void => {\n  setVerticalEnabled(true);\n});\n\n/**\n * Mounts the Swipe Behavior component restoring its state.\n * @since Mini Apps v7.7\n * @throws {FunctionNotAvailableError} The environment is unknown\n * @throws {FunctionNotAvailableError} The SDK is not initialized\n * @throws {FunctionNotAvailableError} The function is not supported\n * @example\n * if (mount.isAvailable()) {\n *   mount();\n * }\n */\nexport const mount = wrapSupported('mount', (): void => {\n  if (!_isMounted()) {\n    setVerticalEnabled(\n      isPageReload() && getStorageValue<StorageValue>(COMPONENT_NAME) || false,\n      true,\n    );\n    _isMounted.set(true);\n  }\n});\n\nfunction setVerticalEnabled(value: boolean, force?: boolean): void {\n  if (value !== _isVerticalEnabled() || force) {\n    postEvent(SETUP_METHOD_NAME, { allow_vertical_swipe: value });\n    setStorageValue<StorageValue>(COMPONENT_NAME, value);\n    _isVerticalEnabled.set(value);\n  }\n}\n\n/**\n * Unmounts the Swipe Behavior component.\n */\nexport function unmount(): void {\n  _isMounted.set(false);\n}\n","export const COMPONENT_NAME = 'viewport';\nexport const FS_CHANGED_EVENT = 'fullscreen_changed';\nexport const SA_CHANGED_EVENT = 'safe_area_changed';\nexport const CSA_CHANGED_EVENT = 'content_safe_area_changed';\nexport const VIEWPORT_CHANGED_EVENT = 'viewport_changed';","import { createWrapBasic } from '@/scopes/wrappers/createWrapBasic.js';\n\nimport { COMPONENT_NAME } from './const.js';\n\nexport const wrapBasic = createWrapBasic(COMPONENT_NAME);\n","import type { Computed } from '@telegram-apps/signals';\nimport type { SafeAreaInsets } from '@telegram-apps/bridge';\nimport { getStorageValue, setStorageValue } from '@telegram-apps/toolkit';\n\nimport { createComputed, createSignalsTuple } from '@/signals-registry.js';\nimport type { State } from '@/scopes/components/viewport/types.js';\nimport { removeUndefined } from '@/utils/removeUndefined.js';\nimport { COMPONENT_NAME } from '@/scopes/components/viewport/const.js';\n\nconst initialInsets: SafeAreaInsets = { left: 0, top: 0, bottom: 0, right: 0 };\n\nfunction nonNegative(value: number): number {\n  return Math.max(value, 0);\n}\n\n//#region Core State.\n\n/**\n * Signal containing the component complete state.\n */\nexport const [_state, state] = createSignalsTuple<State>({\n  contentSafeAreaInsets: initialInsets,\n  height: 0,\n  isExpanded: false,\n  isFullscreen: false,\n  safeAreaInsets: initialInsets,\n  stableHeight: 0,\n  width: 0,\n});\n\nexport function signalFromState<K extends keyof State>(key: K): Computed<State[K]> {\n  return createComputed(() => state()[key]);\n}\n\n/**\n * Signal containing the current height of the **visible area** of the Mini App.\n *\n * The application can display just the top part of the Mini App, with its\n * lower part remaining outside the screen area. From this position, the user\n * can \"pull\" the Mini App to its maximum height, while the bot can do the same\n * by calling `expand` method. As the position of the Mini App changes, the\n * current height value of the visible area will be updated  in real time.\n *\n * Please note that the refresh rate of this value is not sufficient to\n * smoothly follow the lower border of the window. It should not be used to pin\n * interface elements to the bottom of the visible area. It's more appropriate\n * to use the value of the `stableHeight` field for this purpose.\n *\n * @see stableHeight\n */\nexport const height = signalFromState('height');\n\n/**\n * Signal containing the height of the visible area of the Mini App in its last stable state.\n *\n * The application can display just the top part of the Mini App, with its\n * lower part remaining outside the screen area. From this position, the user\n * can \"pull\" the Mini App to its maximum height, while the application can do\n * the same by calling `expand` method.\n *\n * Unlike the value of `height`, the value of `stableHeight` does not change as\n * the position of the Mini App changes with user gestures or during\n * animations. The value of `stableHeight` will be updated after all gestures\n * and animations are completed and the Mini App reaches its final size.\n *\n * @see height\n */\nexport const stableHeight = signalFromState('stableHeight');\n\n/**\n * Signal containing the currently visible area width.\n */\nexport const width = signalFromState('width');\n\n/**\n * Signal indicating if the Mini App is expanded to the maximum available height. Otherwise,\n * if the Mini App occupies part of the screen and can be expanded to the full\n * height using `expand` method.\n * @see expand\n */\nexport const isExpanded = signalFromState('isExpanded');\n\n/**\n * Signal indicating if the current viewport height is stable and is not going to change in\n * the next moment.\n */\nexport const isStable = createComputed(() => height() === stableHeight());\n\n/**\n * Updates the viewport signal state saving it in the storage.\n * @param s - state updates.\n */\nexport function setState(s: Partial<State>): void {\n  const { height, stableHeight, width } = s;\n\n  _state.set({\n    ..._state(),\n    ...removeUndefined({\n      ...s,\n      height: height ? nonNegative(height) : undefined,\n      width: width ? nonNegative(width) : undefined,\n      stableHeight: stableHeight ? nonNegative(stableHeight) : undefined,\n    }),\n  });\n  setStorageValue<State>(COMPONENT_NAME, _state());\n}\n\n/**\n * Retrieves the viewport state from the storage.\n */\nexport function getStateFromStorage(): State | undefined {\n  return getStorageValue<State>(COMPONENT_NAME);\n}\n\n//#endregion\n\n//#region Content Safe Area Insets.\n\nfunction fromCsaState(key: keyof SafeAreaInsets): Computed<number> {\n  return createComputed(() => contentSafeAreaInsets()[key]);\n}\n\nexport const contentSafeAreaInsets = signalFromState('contentSafeAreaInsets');\nexport const contentSafeAreaInsetBottom = fromCsaState('bottom');\nexport const contentSafeAreaInsetLeft = fromCsaState('left');\nexport const contentSafeAreaInsetRight = fromCsaState('right');\nexport const contentSafeAreaInsetTop = fromCsaState('top');\n\n//#endregion\n\n//#region Safe Area Insets.\n\nfunction fromSaState(key: keyof SafeAreaInsets): Computed<number> {\n  return createComputed(() => safeAreaInsets()[key]);\n}\n\nexport const safeAreaInsets = signalFromState('safeAreaInsets');\nexport const safeAreaInsetBottom = fromSaState('bottom');\nexport const safeAreaInsetLeft = fromSaState('left');\nexport const safeAreaInsetRight = fromSaState('right');\nexport const safeAreaInsetTop = fromSaState('top');\n\n//#endregion","import type { AbortablePromise } from 'better-promises';\nimport type { EventPayload } from '@telegram-apps/bridge';\n\nimport { request } from '@/globals.js';\nimport { createWrapSupported } from '@/scopes/wrappers/createWrapSupported.js';\nimport type { RequestOptionsNoCapture } from '@/types.js';\n\nimport {\n  COMPONENT_NAME,\n  CSA_CHANGED_EVENT,\n  SA_CHANGED_EVENT,\n  VIEWPORT_CHANGED_EVENT,\n} from './const.js';\n\nconst REQUEST_SA_METHOD_NAME = 'web_app_request_safe_area';\nconst wrapSafe = createWrapSupported(COMPONENT_NAME, REQUEST_SA_METHOD_NAME);\n\n/**\n * Requests the actual viewport content safe area insets information.\n * @param options - request options.\n * @throws {FunctionNotAvailableError} The environment is unknown\n * @throws {FunctionNotAvailableError} The SDK is not initialized\n * @throws {FunctionNotAvailableError} The function is not supported\n * @since Mini Apps v8.0\n * @example\n * if (requestContentSafeAreaInsets.isAvailable()) {\n *   const insets = await requestContentSafeAreaInsets();\n * }\n */\nexport const requestContentSafeAreaInsets = wrapSafe(\n  'requestContentSafeAreaInsets',\n  (options?: RequestOptionsNoCapture): AbortablePromise<EventPayload<'content_safe_area_changed'>> => {\n    return request('web_app_request_content_safe_area', CSA_CHANGED_EVENT, options);\n  },\n);\n\n/**\n * Requests viewport actual information from the Telegram application.\n * @param options - request options.\n * @example\n * if (requestViewport.isAvailable()) {\n *   const viewport = await requestViewport();\n * }\n */\nexport function requestViewport(\n  options?: RequestOptionsNoCapture,\n): AbortablePromise<EventPayload<'viewport_changed'>> {\n  return request('web_app_request_viewport', VIEWPORT_CHANGED_EVENT, options);\n}\n\n/**\n * Requests the actual viewport safe area insets information.\n * @param options - request options.\n * @throws {FunctionNotAvailableError} The environment is unknown\n * @throws {FunctionNotAvailableError} The SDK is not initialized\n * @throws {FunctionNotAvailableError} The function is not supported\n * @since Mini Apps v8.0\n * @example\n * if (requestSafeAreaInsets.isAvailable()) {\n *   const insets = await requestSafeAreaInsets();\n * }\n */\nexport const requestSafeAreaInsets = wrapSafe(\n  'requestSafeAreaInsets',\n  (options?: RequestOptionsNoCapture): AbortablePromise<EventPayload<'safe_area_changed'>> => {\n    return request(REQUEST_SA_METHOD_NAME, SA_CHANGED_EVENT, options);\n  },\n);","import { isPageReload } from '@telegram-apps/navigation';\nimport { type EventListener, off, on } from '@telegram-apps/bridge';\nimport { AbortablePromise } from 'better-promises';\n\nimport { defineMountFn } from '@/scopes/defineMountFn.js';\nimport { $launchParams } from '@/globals.js';\nimport { signalCancel } from '@/scopes/signalCancel.js';\nimport type { RequestOptionsNoCapture } from '@/types.js';\n\nimport { wrapBasic } from './wrappers.js';\nimport {\n  COMPONENT_NAME,\n  CSA_CHANGED_EVENT,\n  FS_CHANGED_EVENT,\n  SA_CHANGED_EVENT,\n  VIEWPORT_CHANGED_EVENT,\n} from './const.js';\nimport { contentSafeAreaInsets, getStateFromStorage, safeAreaInsets, setState } from './signals.js';\nimport { requestContentSafeAreaInsets, requestSafeAreaInsets, requestViewport } from './static.js';\n\nconst onViewportChanged: EventListener<'viewport_changed'> = (data) => {\n  const { height } = data;\n  setState({\n    isExpanded: data.is_expanded,\n    height,\n    width: data.width,\n    stableHeight: data.is_state_stable ? height : undefined,\n  });\n};\n\nconst onFullscreenChanged: EventListener<'fullscreen_changed'> = (data) => {\n  setState({ isFullscreen: data.is_fullscreen });\n};\n\nconst onSafeAreaChanged: EventListener<'safe_area_changed'> = (data) => {\n  setState({ safeAreaInsets: data });\n};\n\nconst onContentSafeAreaChanged: EventListener<'content_safe_area_changed'> = (data) => {\n  setState({ contentSafeAreaInsets: data });\n};\n\nconst [\n  fn,\n  tMountPromise,\n  tMountError,\n  tIsMounted,\n] = defineMountFn(\n  COMPONENT_NAME,\n  (options?: RequestOptionsNoCapture) => {\n    // Try to restore the state using the storage.\n    const s = isPageReload() && getStateFromStorage();\n    return s\n      ? AbortablePromise.resolve(s)\n      : AbortablePromise.fn(async context => {\n        // Request all insets.\n        const insets = await AbortablePromise.all([\n          requestSafeAreaInsets.isAvailable()\n            ? requestSafeAreaInsets(context)\n            : safeAreaInsets(),\n          requestContentSafeAreaInsets.isAvailable()\n            ? requestContentSafeAreaInsets(context)\n            : contentSafeAreaInsets(),\n        ]);\n\n        const lp = $launchParams();\n        const shared = {\n          contentSafeAreaInsets: insets[1],\n          isFullscreen: !!lp.tgWebAppFullscreen,\n          safeAreaInsets: insets[0],\n        };\n\n        // If the platform has a stable viewport, it means we could use the window global object\n        // properties.\n        if (['macos', 'tdesktop', 'unigram', 'webk', 'weba', 'web'].includes(lp.tgWebAppPlatform)) {\n          const w = window;\n          return {\n            ...shared,\n            height: w.innerHeight,\n            isExpanded: true,\n            stableHeight: w.innerHeight,\n            width: w.innerWidth,\n          };\n        }\n\n        // We were unable to retrieve data locally. In this case, we are\n        // sending a request returning the viewport information.\n        return requestViewport(context).then(data => ({\n          ...shared,\n          height: data.height,\n          isExpanded: data.is_expanded,\n          stableHeight: data.is_state_stable ? data.height : 0,\n          width: data.width,\n        }));\n      }, options);\n  },\n  (result) => {\n    on(VIEWPORT_CHANGED_EVENT, onViewportChanged);\n    on(FS_CHANGED_EVENT, onFullscreenChanged);\n    on(SA_CHANGED_EVENT, onSafeAreaChanged);\n    on(CSA_CHANGED_EVENT, onContentSafeAreaChanged);\n    setState(result);\n  },\n);\n\n/**\n * Mounts the Viewport component.\n * @throws {FunctionNotAvailableError} The environment is unknown\n * @throws {FunctionNotAvailableError} The SDK is not initialized\n * @throws {ConcurrentCallError} The component is already mounting\n * @example\n * if (mount.isAvailable() && !isMounting()) {\n *   await mount();\n * }\n */\nexport const mount = wrapBasic('mount', fn);\nexport const [, mountPromise, isMounting] = tMountPromise;\nexport const [, mountError] = tMountError;\nexport const [_isMounted, isMounted] = tIsMounted;\n\n/**\n * Unmounts the Viewport.\n */\nexport function unmount(): void {\n  signalCancel(mountPromise);\n  off(VIEWPORT_CHANGED_EVENT, onViewportChanged);\n  off(FS_CHANGED_EVENT, onFullscreenChanged);\n  off(SA_CHANGED_EVENT, onSafeAreaChanged);\n  off(CSA_CHANGED_EVENT, onContentSafeAreaChanged);\n  _isMounted.set(false);\n}\n","import { camelToKebab } from '@telegram-apps/toolkit';\nimport { deleteCssVar, setCssVar } from '@/utils/css-vars.js';\n\nimport { CSSVarsBoundError } from '@/errors.js';\nimport { createSignalsTuple } from '@/signals-registry.js';\nimport { createWrapMounted } from '@/scopes/wrappers/createWrapMounted.js';\nimport { COMPONENT_NAME } from '@/scopes/components/viewport/const.js';\nimport { _isMounted } from '@/scopes/components/viewport/mounting.js';\n\nimport {\n  safeAreaInsetBottom,\n  safeAreaInsetTop,\n  safeAreaInsetRight,\n  safeAreaInsetLeft,\n  height,\n  width,\n  stableHeight,\n  contentSafeAreaInsetBottom,\n  contentSafeAreaInsetTop,\n  contentSafeAreaInsetRight,\n  contentSafeAreaInsetLeft,\n} from './signals.js';\nimport type { GetCSSVarNameFn } from './types.js';\n\nconst wrapMounted = createWrapMounted(COMPONENT_NAME, _isMounted);\n\n/**\n * True if CSS variables are currently bound.\n */\nexport const [_isCssVarsBound, isCssVarsBound] = createSignalsTuple(false);\n\n/**\n * Creates CSS variables connected with the current viewport.\n *\n * By default, created CSS variables names are following the pattern \"--tg-theme-{name}\", where\n * {name} is a viewport property name converted from camel case to kebab case.\n *\n * Default variables:\n * - `--tg-viewport-height`\n * - `--tg-viewport-width`\n * - `--tg-viewport-stable-height`\n * - `--tg-viewport-content-safe-area-inset-top`\n * - `--tg-viewport-content-safe-area-inset-bottom`\n * - `--tg-viewport-content-safe-area-inset-left`\n * - `--tg-viewport-content-safe-area-inset-right`\n * - `--tg-viewport-safe-area-inset-top`\n * - `--tg-viewport-safe-area-inset-bottom`\n * - `--tg-viewport-safe-area-inset-left`\n * - `--tg-viewport-safe-area-inset-right`\n *\n * Variables are being automatically updated if the viewport was changed.\n *\n * @param getCSSVarName - function, returning computed complete CSS variable name. The CSS\n * variable will only be defined if the function returned non-empty string value.\n * @returns Function to stop updating variables.\n * @throws {FunctionNotAvailableError} The environment is unknown\n * @throws {CSSVarsBoundError} CSS variables are already bound\n * @throws {FunctionNotAvailableError} The parent component is not mounted\n * @throws {FunctionNotAvailableError} The SDK is not initialized\n * @example Using no arguments\n * if (bindCssVars.isAvailable()) {\n *   bindCssVars();\n * }\n * @example Using custom CSS vars generator\n * if (bindCssVars.isAvailable()) {\n *   bindCssVars(key => `--my-prefix-${key}`);\n * }\n */\nexport const bindCssVars = wrapMounted(\n  'bindCssVars',\n  (getCSSVarName?: GetCSSVarNameFn): VoidFunction => {\n    if (_isCssVarsBound()) {\n      throw new CSSVarsBoundError();\n    }\n\n    getCSSVarName ||= (prop) => `--tg-viewport-${camelToKebab(prop)}`;\n\n    const settings = ([\n      ['height', height],\n      ['stableHeight', stableHeight],\n      ['width', width],\n      ['safeAreaInsetTop', safeAreaInsetTop],\n      ['safeAreaInsetBottom', safeAreaInsetBottom],\n      ['safeAreaInsetLeft', safeAreaInsetLeft],\n      ['safeAreaInsetRight', safeAreaInsetRight],\n      ['contentSafeAreaInsetTop', contentSafeAreaInsetTop],\n      ['contentSafeAreaInsetBottom', contentSafeAreaInsetBottom],\n      ['contentSafeAreaInsetLeft', contentSafeAreaInsetLeft],\n      ['contentSafeAreaInsetRight', contentSafeAreaInsetRight],\n    ] as const).reduce<[\n      update: VoidFunction,\n      removeListener: VoidFunction,\n      cssVar: string\n    ][]>((acc, [key, signal]) => {\n      const cssVar = getCSSVarName(key);\n      if (cssVar) {\n        const update = () => {\n          setCssVar(cssVar, `${signal()}px`);\n        };\n        acc.push([update, signal.sub(update), cssVar]);\n      }\n      return acc;\n    }, []);\n\n    // Instantly set CSS variables.\n    settings.forEach(setting => {\n      setting[0]();\n    });\n    _isCssVarsBound.set(true);\n\n    return () => {\n      settings.forEach(s => {\n        // Remove update listener.\n        s[1]();\n        // Remove CSS variable.\n        deleteCssVar(s[2]);\n      });\n      _isCssVarsBound.set(false);\n    };\n  },\n);\n","import { postEvent } from '@/globals.js';\n\nimport { wrapBasic } from './wrappers.js';\n\n/**\n * A method that expands the Mini App to the maximum available height. To find\n * out if the Mini App is expanded to the maximum height, refer to the value of\n * the `isExpanded`.\n * @throws {FunctionNotAvailableError} The environment is unknown\n * @throws {FunctionNotAvailableError} The SDK is not initialized\n * @see isExpanded\n * @example\n * if (expand.isAvailable()) {\n *   expand();\n * }\n */\nexport const expand = wrapBasic('expand', (): void => {\n  postEvent('web_app_expand');\n});\n","import type { AbortablePromise, PromiseOptions } from 'better-promises';\n\nimport { request } from '@/globals.js';\nimport { FullscreenFailedError } from '@/errors.js';\nimport { createWrapComplete } from '@/scopes/wrappers/createWrapComplete.js';\nimport { defineNonConcurrentFn } from '@/scopes/defineNonConcurrentFn.js';\n\nimport { COMPONENT_NAME, FS_CHANGED_EVENT } from './const.js';\nimport { setState, signalFromState } from './signals.js';\nimport { _isMounted } from './mounting.js';\nimport { createSignalsTuple } from '@/signals-registry.js';\n\nconst REQUEST_METHOD_NAME = 'web_app_request_fullscreen';\nconst wrapComplete = createWrapComplete(COMPONENT_NAME, _isMounted, REQUEST_METHOD_NAME);\n\n/**\n * Signal indicating if the viewport is currently in fullscreen mode.\n */\nexport const isFullscreen = signalFromState('isFullscreen');\n\n/**\n * Signal containing fullscreen request or exit promise.\n */\nexport const [\n  _changeFullscreenPromise,\n  changeFullscreenPromise,\n] = createSignalsTuple<AbortablePromise<void>>();\n\n/**\n * Signal containing an error received during the last fullscreen mode request.\n */\nexport const [\n  _changeFullscreenError,\n  changeFullscreenError,\n] = createSignalsTuple<Error | undefined>();\n\nfunction createFullscreenFn(method: string, isRequest?: boolean) {\n  return wrapComplete(\n    method,\n    defineNonConcurrentFn(\n      (options?: PromiseOptions) => {\n        return request(\n          isRequest ? REQUEST_METHOD_NAME : 'web_app_exit_fullscreen',\n          [FS_CHANGED_EVENT, 'fullscreen_failed'],\n          options,\n        )\n          .then(data => {\n            if ('error' in data && data.error !== 'ALREADY_FULLSCREEN') {\n              throw new FullscreenFailedError(data.error);\n            }\n            const value = 'is_fullscreen' in data ? data.is_fullscreen : true;\n            value !== isFullscreen() && setState({ isFullscreen: value });\n          });\n      },\n      'Fullscreen mode change is already being requested',\n      {\n        promise: _changeFullscreenPromise,\n        error: _changeFullscreenError,\n      },\n    )[0],\n  );\n}\n\n/**\n * Requests fullscreen mode for the mini application.\n * @since Mini Apps v8.0\n * @throws {FunctionNotAvailableError} The environment is unknown\n * @throws {FunctionNotAvailableError} The SDK is not initialized\n * @throws {FunctionNotAvailableError} The parent component is not mounted\n * @throws {FunctionNotAvailableError} The function is not supported\n * @throws {FullscreenFailedError}\n * @example Using `isAvailable()`\n * if (requestFullscreen.isAvailable() && !isChangingFullscreen()) {\n *   await requestFullscreen();\n * }\n * @example Using `ifAvailable()`\n * if (!isChangingFullscreen()) {\n *   await requestFullscreen.ifAvailable();\n * }\n */\nexport const requestFullscreen = createFullscreenFn('requestFullscreen', true);\n\n/**\n * Exits mini application fullscreen mode.\n * @since Mini Apps v8.0\n * @throws {FunctionNotAvailableError} The environment is unknown\n * @throws {FunctionNotAvailableError} The SDK is not initialized\n * @throws {FunctionNotAvailableError} The parent component is not mounted\n * @throws {FunctionNotAvailableError} The function is not supported\n * @throws {FullscreenFailedError}\n * @example Using `isAvailable()`\n * if (exitFullscreen.isAvailable() && !isChangingFullscreen()) {\n *   await exitFullscreen();\n * }\n * @example Using `ifAvailable()`\n * if (!isChangingFullscreen()) {\n *   await exitFullscreen.ifAvailable();\n * }\n */\nexport const exitFullscreen = createFullscreenFn('exitFullscreen');","import type { RequestOptionsNoCapture } from '@/types.js';\nimport { request } from '@/globals.js';\nimport { wrapSafe } from '@/scopes/wrappers/wrapSafe.js';\nimport { defineNonConcurrentFn } from '@/scopes/defineNonConcurrentFn.js';\n\nconst METHOD = 'web_app_request_emoji_status_access';\n\nconst [\n  fn,\n  tPromise,\n  tError,\n] = defineNonConcurrentFn((options?: RequestOptionsNoCapture) => {\n  return request(METHOD, 'emoji_status_access_requested', options).then(d => d.status);\n}, 'Emoji status access request is already in progress');\n\n/**\n * Shows a native popup requesting permission for the bot to manage user's emoji status.\n * @param options - additional options.\n * @since Mini Apps v8.0\n * @throws {ConcurrentCallError} Emoji status access request is already in progress\n * @throws {FunctionNotAvailableError} The environment is unknown\n * @throws {FunctionNotAvailableError} The SDK is not initialized\n * @throws {FunctionNotAvailableError} The function is not supported\n * @example\n * if (requestEmojiStatusAccess.isAvailable()) {\n *   const status = await requestEmojiStatusAccess();\n * }\n */\nexport const requestEmojiStatusAccess = wrapSafe(\n  'requestEmojiStatusAccess',\n  fn,\n  { isSupported: METHOD },\n);\nexport const [, requestEmojiStatusAccessPromise, isRequestingEmojiStatusAccess] = tPromise;\nexport const [, requestEmojiStatusAccessError] = tError;","import type { RequestOptionsNoCapture } from '@/types.js';\nimport { SetEmojiStatusError } from '@/errors.js';\nimport { request } from '@/globals.js';\nimport { wrapSafe } from '@/scopes/wrappers/wrapSafe.js';\nimport { defineNonConcurrentFn } from '@/scopes/defineNonConcurrentFn.js';\n\nconst METHOD = 'web_app_set_emoji_status';\n\nexport interface SetEmojiStatusOptions extends RequestOptionsNoCapture {\n  duration?: number;\n}\n\nconst [\n  fn,\n  tPromise,\n  tError,\n] = defineNonConcurrentFn(\n  (customEmojiId: string, options?: SetEmojiStatusOptions) => {\n    return request(METHOD, ['emoji_status_set', 'emoji_status_failed'], {\n      params: {\n        custom_emoji_id: customEmojiId,\n        duration: (options || {}).duration,\n      },\n      ...options,\n    })\n      .then(d => {\n        if (d && 'error' in d) {\n          throw new SetEmojiStatusError(d.error);\n        }\n      });\n  },\n  'Emoji status set request is currently in progress',\n);\n\n/**\n * Opens a dialog allowing the user to set the specified custom emoji as their status.\n * @returns Promise with boolean value indicating if the status was set.\n * @param options - additional options.\n * @since Mini Apps v8.0\n * @throws {ConcurrentCallError} Emoji status set request is currently in progress\n * @throws {SetEmojiStatusError} Failed to set emoji status\n * @throws {FunctionNotAvailableError} The environment is unknown\n * @throws {FunctionNotAvailableError} The SDK is not initialized\n * @throws {FunctionNotAvailableError} The function is not supported\n * @example\n * if (setEmojiStatus.isAvailable()) {\n *   const statusSet = await setEmojiStatus('5361800828313167608');\n * }\n */\nexport const setEmojiStatus = wrapSafe('setEmojiStatus', fn, {\n  isSupported: METHOD,\n});\nexport const [, setEmojiStatusPromise, isSettingEmojiStatus] = tPromise;\nexport const [, setEmojiStatusError] = tError;","import { on, type EventListener, off } from '@telegram-apps/bridge';\n\nimport { wrapSafe } from '@/scopes/wrappers/wrapSafe.js';\n\nconst wrapOptions = { isSupported: 'web_app_add_to_home_screen' } as const;\nconst EVENT_NAME = 'home_screen_failed';\n\n/**\n * Adds the event listener that being called whenever the user declines the request to add the\n * current mini app to the device's home screen.\n * @since Mini Apps v8.0\n * @throws {FunctionNotAvailableError} The environment is unknown\n * @throws {FunctionNotAvailableError} The SDK is not initialized\n * @throws {FunctionNotAvailableError} The function is not supported\n * @example\n * if (onAddToHomeScreenFailed.isAvailable()) {\n *   const off = onAddToHomeScreenFailed(() => {\n *     console.log('Failed to add to home screen');\n *     off();\n *   });\n * }\n */\nexport const onAddToHomeScreenFailed = wrapSafe(\n  'onAddToHomeScreenFailed',\n  (listener: EventListener<typeof EVENT_NAME>, once?: boolean): VoidFunction => {\n    return on(EVENT_NAME, listener, once);\n  },\n  { isSupported: 'web_app_add_to_home_screen' },\n);\n\n/**\n * Removes add to home screen failed event listener.\n * @since Mini Apps v8.0\n * @throws {FunctionNotAvailableError} The environment is unknown\n * @throws {FunctionNotAvailableError} The SDK is not initialized\n * @throws {FunctionNotAvailableError} The function is not supported\n * @example\n * if (offAddToHomeScreenFailed.isAvailable()) {\n *   const handler = () => {\n *     console.log('Failed to add');\n *     offAddToHomeScreenFailed(handler);\n *   };\n *   onAddToHomeScreenFailed(handler);\n * }\n */\nexport const offAddToHomeScreenFailed = wrapSafe(\n  'offAddToHomeScreenFailed',\n  (listener: EventListener<typeof EVENT_NAME>): void => {\n    off(EVENT_NAME, listener);\n  },\n  wrapOptions,\n);","import { type EventListener, off, on } from '@telegram-apps/bridge';\n\nimport { wrapSafe } from '@/scopes/wrappers/wrapSafe.js';\n\nconst wrapOptions = { isSupported: 'web_app_add_to_home_screen' } as const;\nconst EVENT_NAME = 'home_screen_added';\n\n/**\n * Adds the event listener that being called whenever the user adds the current mini app to the\n * device's home screen.\n *\n * Note that if the device cannot determine the installation status, a corresponding event may\n * not be received even if the icon has been added.\n * @since Mini Apps v8.0\n * @throws {FunctionNotAvailableError} The environment is unknown\n * @throws {FunctionNotAvailableError} The SDK is not initialized\n * @throws {FunctionNotAvailableError} The function is not supported\n * @example\n * if (onAddedToHomeScreen.isAvailable()) {\n *   const off = onAddedToHomeScreen(() => {\n *     console.log('Added');\n *     off();\n *   });\n * }\n */\nexport const onAddedToHomeScreen = wrapSafe(\n  'onAddedToHomeScreen',\n  (listener: EventListener<typeof EVENT_NAME>, once?: boolean): VoidFunction => {\n    return on(EVENT_NAME, listener, once);\n  },\n  wrapOptions,\n);\n\n/**\n * Removes the event listener that being called whenever the user adds the current mini app to the\n * device's home screen.\n * @since Mini Apps v8.0\n * @throws {FunctionNotAvailableError} The environment is unknown\n * @throws {FunctionNotAvailableError} The SDK is not initialized\n * @throws {FunctionNotAvailableError} The function is not supported\n * @example\n * if (offAddedToHomeScreen.isAvailable()) {\n *   const handler = () => {\n *     console.log('Added');\n *     offAddedToHomeScreen(handler);\n *   };\n *   onAddedToHomeScreen(handler);\n * }\n */\nexport const offAddedToHomeScreen = wrapSafe(\n  'offAddedToHomeScreen',\n  (listener: EventListener<typeof EVENT_NAME>): void => {\n    off(EVENT_NAME, listener);\n  },\n  wrapOptions,\n);","import { wrapSafe } from '@/scopes/wrappers/wrapSafe.js';\nimport { postEvent } from '@/globals.js';\n\nconst METHOD_NAME = 'web_app_add_to_home_screen';\n\n/**\n * Prompts the user to add the Mini App to the home screen.\n * @since Mini Apps v8.0\n * @throws {FunctionNotAvailableError} The environment is unknown\n * @throws {FunctionNotAvailableError} The SDK is not initialized\n * @throws {FunctionNotAvailableError} The function is not supported\n * @example Using `isAvailable`\n * if (addToHomeScreen.isAvailable()) {\n *   addToHomeScreen();\n * }\n * @example Using `ifAvailable`\n * addToHomeScreen.ifAvailable()\n */\nexport const addToHomeScreen = wrapSafe(\n  'addToHomeScreen',\n  () => {\n    postEvent(METHOD_NAME);\n  },\n  { isSupported: METHOD_NAME },\n);","import type { AbortablePromise, PromiseOptions } from 'better-promises';\nimport type { HomeScreenStatus } from '@telegram-apps/bridge';\n\nimport { defineNonConcurrentFn } from '@/scopes/defineNonConcurrentFn.js';\nimport { request } from '@/globals.js';\nimport { wrapSafe } from '@/scopes/wrappers/wrapSafe.js';\n\nconst METHOD_NAME = 'web_app_check_home_screen';\n\nconst [\n  fn,\n  tPromise,\n  tError,\n] = defineNonConcurrentFn((options?: PromiseOptions): AbortablePromise<HomeScreenStatus> => {\n  return request(METHOD_NAME, 'home_screen_checked', options).then(d => d.status || 'unknown');\n}, 'Check home screen status request is currently in progress');\n\n/**\n * Sends a request to the native Telegram application to check if the current mini\n * application is added to the device's home screen.\n * @param options - additional options.\n * @since Mini Apps v8.0\n * @throws {ConcurrentCallError} Check home screen status request is currently in progress\n * @throws {FunctionNotAvailableError} The environment is unknown\n * @throws {FunctionNotAvailableError} The SDK is not initialized\n * @throws {FunctionNotAvailableError} The function is not supported\n * @example\n * if (checkHomeScreenStatus.isAvailable()) {\n *   const status = await checkHomeScreenStatus();\n * }\n */\nexport const checkHomeScreenStatus = wrapSafe('checkHomeScreenStatus', fn, {\n  isSupported: METHOD_NAME,\n});\nexport const [, checkHomeScreenStatusPromise, isCheckingHomeScreenStatus] = tPromise;\nexport const [, checkHomeScreenStatusError] = tError;","import type { OpenLinkBrowser } from '@telegram-apps/bridge';\n\nimport { createWrapBasic } from '@/scopes/wrappers/createWrapBasic.js';\nimport { InvalidArgumentsError } from '@/errors.js';\nimport { postEvent } from '@/globals.js';\n\nexport interface OpenLinkOptions {\n  /**\n   * Attempts to use the instant view mode.\n   */\n  tryInstantView?: boolean;\n  /**\n   * A preferred browser to open the link in.\n   */\n  tryBrowser?: OpenLinkBrowser;\n}\n\nconst wrapBasic = createWrapBasic();\n\n/**\n * Opens a link.\n *\n * The Mini App will not be closed.\n *\n * Note that this method can be called only in response to the user\n * interaction with the Mini App interface (e.g. click inside the Mini App or on the main button).\n * @param url - URL to be opened.\n * @param options - additional options.\n * @throws {FunctionNotAvailableError} The environment is unknown\n * @throws {FunctionNotAvailableError} The SDK is not initialized\n * @throws {InvalidArgumentsError} Invalid URL passed\n * @example\n * if (openLink.isAvailable()) {\n *   openLink('https://google.com', {\n *     tryInstantView: true,\n *     tryBrowser: 'chrome',\n *   });\n * }\n */\nexport const openLink = wrapBasic(\n  'openLink',\n  (url: string | URL, options?: OpenLinkOptions): void => {\n    if (typeof url === 'string') {\n      try {\n        url = new URL(url);\n      } catch (e) {\n        throw new InvalidArgumentsError(`\"${url.toString()}\" is invalid URL`, e);\n      }\n    }\n    options ||= {};\n    postEvent('web_app_open_link', {\n      url: url.toString(),\n      try_browser: options.tryBrowser,\n      try_instant_view: options.tryInstantView,\n    });\n  },\n);","import { supports } from '@telegram-apps/bridge';\n\nimport { createWrapBasic } from '@/scopes/wrappers/createWrapBasic.js';\nimport { InvalidArgumentsError } from '@/errors.js';\nimport { version, postEvent } from '@/globals.js';\n\nconst OPEN_TG_LINK_METHOD = 'web_app_open_tg_link';\nconst wrapBasic = createWrapBasic();\n\n/**\n * Opens a Telegram link inside the Telegram app. The function expects passing a link in a full\n * format using the hostname \"t.me\".\n *\n * The Mini App will be closed.\n * @param url - URL to be opened.\n * @throws {FunctionNotAvailableError} The environment is unknown\n * @throws {FunctionNotAvailableError} The SDK is not initialized\n * @throws {InvalidArgumentsError} Invalid URL passed\n * @example\n * if (openTelegramLink.isAvailable()) {\n *   openTelegramLink('https://t.me/heyqbnk');\n * }\n */\nexport const openTelegramLink = wrapBasic(\n  'openTelegramLink',\n  (url: string | URL): void => {\n    const urlString = url.toString();\n    if (!urlString.match(/^https:\\/\\/t.me\\/.+/)) {\n      throw new InvalidArgumentsError(`\"${urlString}\" is invalid URL`);\n    }\n\n    if (!supports(OPEN_TG_LINK_METHOD, version())) {\n      window.location.href = urlString;\n      return;\n    }\n\n    url = new URL(url);\n    postEvent(OPEN_TG_LINK_METHOD, { path_full: url.pathname + url.search });\n  },\n);","import { createWrapBasic } from '@/scopes/wrappers/createWrapBasic.js';\nimport { openTelegramLink } from '@/scopes/utilities/links/openTelegramLink.js';\n\nconst wrapBasic = createWrapBasic();\n\n/**\n * Shares the specified URL with the passed to the chats, selected by user.\n * After being called, it closes the mini application.\n *\n * This method uses Telegram's Share Links.\n * @param url - URL to share.\n * @param text - text to append after the URL.\n * @throws {FunctionNotAvailableError} The environment is unknown\n * @throws {FunctionNotAvailableError} The SDK is not initialized\n * @throws {InvalidArgumentsError} Invalid URL passed\n * @see https://core.telegram.org/api/links#share-links\n * @see https://core.telegram.org/widgets/share#custom-buttons\n */\nexport const shareURL = wrapBasic(\n  'shareURL',\n  (url: string, text?: string): void => {\n    openTelegramLink(\n      `https://t.me/share/url?` + new URLSearchParams({ url, text: text || '' })\n        .toString()\n        // By default, URL search params encode spaces with \"+\".\n        // We are replacing them with \"%20\", because plus symbols are working incorrectly\n        // in Telegram.\n        .replace(/\\+/g, '%20'),\n    );\n  },\n);\n","import { AbortablePromise } from 'better-promises';\n\n/**\n * Awaits for specified amount of time.\n * @param duration - duration in ms to await.\n * @param abortSignal - signal to stop function execution.\n */\nexport function sleep(duration: number, abortSignal?: AbortSignal): AbortablePromise<void> {\n  return new AbortablePromise<void>({ abortSignal, timeout: duration }).catch(() => {});\n}\n","import { request } from '@/globals.js';\nimport { wrapSafe } from '@/scopes/wrappers/wrapSafe.js';\nimport { defineNonConcurrentFn } from '@/scopes/defineNonConcurrentFn.js';\nimport type { RequestOptionsNoCapture } from '@/types.js';\n\nconst METHOD_NAME = 'web_app_request_phone';\n\nconst [\n  fn,\n  tPromise,\n  tError,\n] = defineNonConcurrentFn((options?: RequestOptionsNoCapture) => {\n  return request(METHOD_NAME, 'phone_requested', options).then(d => d.status);\n}, 'Phone access request is currently in progress');\n\n/**\n * Requests current user phone access. Method returns promise, which resolves\n * status of the request. In case, user accepted the request, Mini App bot will receive\n * the according notification.\n *\n * To obtain the retrieved information instead, utilize the `requestContact` method.\n * @param options - additional options.\n * @since Mini Apps v6.9\n * @see requestContact\n * @throws {ConcurrentCallError} Phone access request is currently in progress\n * @throws {FunctionNotAvailableError} The environment is unknown\n * @throws {FunctionNotAvailableError} The SDK is not initialized\n * @throws {FunctionNotAvailableError} The function is not supported\n * @example\n * if (requestPhoneAccess.isAvailable()) {\n *   const status = await requestPhoneAccess();\n * }\n */\nexport const requestPhoneAccess = wrapSafe('requestPhoneAccess', fn, {\n  isSupported: METHOD_NAME,\n});\nexport const [, requestPhoneAccessPromise, isRequestingPhoneAccess] = tPromise;\nexport const [, requestPhoneAccessError] = tError;","import { jsonParse, transformQueryUsing } from '@telegram-apps/transformers';\nimport { AbortablePromise, type PromiseOptions } from 'better-promises';\nimport {\n  date,\n  instance,\n  looseObject,\n  number,\n  optional,\n  parse,\n  pipe,\n  string,\n  transform,\n  union,\n  ValiError,\n} from 'valibot';\nimport type { InvokeCustomMethodOptions } from '@telegram-apps/bridge';\n\nimport { wrapSafe } from '@/scopes/wrappers/wrapSafe.js';\nimport { invokeCustomMethod } from '@/globals.js';\nimport { AccessDeniedError } from '@/errors.js';\nimport { defineNonConcurrentFn } from '@/scopes/defineNonConcurrentFn.js';\nimport { sleep } from '@/utils/sleep.js';\n\nimport { requestPhoneAccess } from './requestPhoneAccess.js';\n\n/**\n * Requested contact information.\n */\nexport interface RequestedContact {\n  contact: {\n    user_id: number;\n    phone_number: string;\n    first_name: string;\n    last_name?: string;\n    [key: string]: unknown;\n  };\n  auth_date: Date;\n  hash: string;\n  [key: string]: unknown;\n}\n\n/**\n * Requested contact complete data.\n */\nexport interface RequestedContactCompleteData {\n  /**\n   * Raw original representation of the contact data returned from the Telegram server.\n   */\n  raw: string;\n  /**\n   * Parsed representation of the contact data.\n   */\n  parsed: RequestedContact;\n}\n\nconst fnOptions = {\n  isSupported: 'web_app_request_phone',\n} as const;\n\n/**\n * Attempts to get requested contact.\n * @param options - execution options.\n * @throws {ValiError} Response has invalid structure\n */\nasync function getRequestedContact(options?: InvokeCustomMethodOptions): Promise<RequestedContactCompleteData> {\n  const raw = parse(string(), await invokeCustomMethod('getRequestedContact', {}, {\n    ...options,\n    timeout: (options || {}).timeout || 5000,\n  }));\n  return {\n    raw,\n    parsed: parse(\n      pipe(\n        // todo: Union is unnecessary here, but we use it to comply TypeScript checker.\n        union([string(), instance(URLSearchParams)]),\n        transformQueryUsing(\n          looseObject({\n            contact: pipe(\n              string(),\n              jsonParse(),\n              looseObject({\n                user_id: number(),\n                phone_number: string(),\n                first_name: string(),\n                last_name: optional(string()),\n              }),\n            ),\n            auth_date: pipe(\n              string(),\n              transform(input => new Date(Number(input) * 1000)),\n              date(),\n            ),\n            hash: string(),\n          }),\n        ),\n      ),\n      raw,\n    ),\n  };\n}\n\nconst [fn, tPromise, tError] = defineNonConcurrentFn(\n  (options?: PromiseOptions): AbortablePromise<RequestedContactCompleteData> => {\n    return new AbortablePromise<RequestedContactCompleteData>(\n      async (res, _, context) => {\n        // First of all, let's try to get the requested contact. Probably, we already requested it\n        // before.\n        try {\n          return res(await getRequestedContact(context));\n        } catch (e) {\n          if (e instanceof ValiError) {\n            throw e;\n          }\n        }\n\n        // Then, request access to the user's phone.\n        const status = await requestPhoneAccess(context);\n        if (status !== 'sent') {\n          throw new AccessDeniedError('User denied access');\n        }\n\n        // Time to wait before executing the next request.\n        let sleepTime = 50;\n\n        // We are trying to retrieve the requested contact until the deadline was reached.\n        while (!context.isAborted()) {\n          try {\n            return res(await getRequestedContact(context));\n          } catch (e) {\n            if (e instanceof ValiError) {\n              throw e;\n            }\n          }\n\n          // Sleep for some time.\n          await sleep(sleepTime);\n\n          // Increase the sleep time not to kill the backend service.\n          sleepTime += 50;\n        }\n      },\n      options,\n    );\n  },\n  'Contact is already being requested',\n);\n\n/**\n * Requests current user contact information. In contrary to requestPhoneAccess, this method\n * returns promise with contact information that rejects in case, user denied access, or request\n * failed.\n *\n * This function returns an object, containing both raw and parsed representations of the response,\n * received from the Telegram client.\n * @param options - additional options.\n * @since Mini Apps v6.9\n * @throws {FunctionNotAvailableError} The environment is unknown\n * @throws {FunctionNotAvailableError} The SDK is not initialized\n * @throws {FunctionNotAvailableError} The function is not supported\n * @throws {AccessDeniedError} User denied access\n * @throws {ValiError} Response has invalid structure\n * @example\n * if (requestContactComplete.isAvailable()) {\n *   const completeData = await requestContactComplete();\n * }\n */\nexport const requestContactComplete = wrapSafe('requestContactComplete', fn, fnOptions);\n\n/**\n * Works the same way as the `requestContactComplete` function, but returns only parsed\n * representation of the contact data.\n * @see requestContactComplete\n * @param options - additional options.\n * @since Mini Apps v6.9\n * @throws {FunctionNotAvailableError} The environment is unknown\n * @throws {FunctionNotAvailableError} The SDK is not initialized\n * @throws {FunctionNotAvailableError} The function is not supported\n * @throws {AccessDeniedError} User denied access\n * @throws {ValiError} Response has invalid structure\n * @example\n * if (requestContact.isAvailable()) {\n *   const contact = await requestContact();\n * }\n */\nexport const requestContact = wrapSafe(\n  'requestContact',\n  (options?: PromiseOptions): AbortablePromise<RequestedContact> => {\n    return requestContactComplete(options).then(r => r.parsed);\n  },\n  fnOptions,\n);\nexport const [, requestContactPromise, isRequestingContact] = tPromise;\nexport const [, requestContactError] = tError;","import type { WriteAccessRequestedStatus } from '@telegram-apps/bridge';\nimport type { AbortablePromise } from 'better-promises';\n\nimport { request } from '@/globals.js';\nimport { wrapSafe } from '@/scopes/wrappers/wrapSafe.js';\nimport { defineNonConcurrentFn } from '@/scopes/defineNonConcurrentFn.js';\nimport type { RequestOptionsNoCapture } from '@/types.js';\n\nconst METHOD_NAME = 'web_app_request_write_access';\n\nconst [\n  fn,\n  tPromise,\n  tError,\n] = defineNonConcurrentFn(\n  (options?: RequestOptionsNoCapture): AbortablePromise<WriteAccessRequestedStatus> => {\n    return request(METHOD_NAME, 'write_access_requested', options).then(d => d.status);\n  },\n  'Write access request is currently in progress',\n);\n\n/**\n * Requests write message access to the current user.\n * @param options - additional options.\n * @since Mini Apps v6.9\n * @throws {ConcurrentCallError} Write access request is currently in progress\n * @throws {FunctionNotAvailableError} The environment is unknown\n * @throws {FunctionNotAvailableError} The SDK is not initialized\n * @throws {FunctionNotAvailableError} The function is not supported\n * @example\n * if (requestWriteAccess.isAvailable()) {\n *   const status = await requestWriteAccess();\n * }\n */\nexport const requestWriteAccess = wrapSafe('requestWriteAccess', fn, {\n  isSupported: METHOD_NAME,\n});\nexport const [, requestWriteAccessPromise, isRequestingWriteAccess] = tPromise;\nexport const [, requestWriteAccessError] = tError;\n","function fallback(text: string) {\n  const textArea = document.createElement('textarea');\n  textArea.value = text;\n\n  // Avoid scrolling to bottom\n  textArea.style.top = '0';\n  textArea.style.left = '0';\n  textArea.style.position = 'fixed';\n\n  document.body.appendChild(textArea);\n  textArea.focus();\n  textArea.select();\n\n  try {\n    document.execCommand('copy');\n  } finally {\n    document.body.removeChild(textArea);\n  }\n}\n\n/**\n * Copies specified text to the clipboard.\n * @param text - text to copy.\n */\nexport async function copyTextToClipboard(text: string): Promise<void> {\n  try {\n    const { clipboard } = navigator;\n    if (clipboard) {\n      return await clipboard.writeText(text);\n    }\n  } catch {\n  }\n  fallback(text);\n}","import { request } from '@/globals.js';\nimport { wrapSafe } from '@/scopes/wrappers/wrapSafe.js';\nimport { AccessDeniedError } from '@/errors.js';\nimport type { RequestOptionsNoCapture } from '@/types.js';\n\nconst METHOD_NAME = 'web_app_request_file_download';\n\n/**\n * Displays a native popup prompting the user to download a file.\n * @param url - the HTTPS URL of the file to be downloaded.\n * @param file - the suggested name for the downloaded file.\n * @param options - additional request execution options.\n * @since Mini Apps v8.0\n * @throws {FunctionNotAvailableError} The environment is unknown\n * @throws {FunctionNotAvailableError} The SDK is not initialized\n * @throws {FunctionNotAvailableError} The function is not supported\n * @throws {AccessDeniedError} User denied the action\n * @example\n * if (downloadFile.isAvailable()) {\n *   await downloadFile('https://telegram.org/js/telegram-web-app.js', 'telegram-sdk.js');\n * }\n */\nexport const downloadFile = wrapSafe(\n  'downloadFile',\n  (url: string, fileName: string, options?: RequestOptionsNoCapture) => {\n    return request(\n      METHOD_NAME,\n      'file_download_requested',\n      { ...options, params: { url, file_name: fileName } },\n    ).then(response => {\n      if (response.status !== 'downloading') {\n        throw new AccessDeniedError('User denied the action');\n      }\n    });\n  }, { isSupported: METHOD_NAME },\n);","import type { AbortablePromise } from 'better-promises';\nimport { date, integer, number, parse, pipe, transform } from 'valibot';\nimport type { InvokeCustomMethodOptions } from '@telegram-apps/bridge';\n\nimport { invokeCustomMethod } from '@/globals.js';\nimport { wrapSafe } from '@/scopes/wrappers/wrapSafe.js';\n\n/**\n * @returns Current server time.\n * @param options - execution options.\n * @since Mini Apps v6.9\n * @throws {FunctionNotAvailableError} The environment is unknown\n * @throws {FunctionNotAvailableError} The SDK is not initialized\n * @throws {FunctionNotAvailableError} The function is not supported\n * @example\n * if (getCurrentTime.isAvailable()) {\n *   const time = await getCurrentTime();\n * }\n */\nexport const getCurrentTime = wrapSafe(\n  'getCurrentTime',\n  (options?: InvokeCustomMethodOptions): AbortablePromise<Date> => {\n    return invokeCustomMethod('getCurrentTime', {}, options).then(value => {\n      return parse(\n        pipe(number(), integer(), transform(v => new Date(v * 1000)), date()),\n        value,\n      );\n    });\n  },\n  { isSupported: 'web_app_invoke_custom_method' },\n);","import { captureSameReq } from '@telegram-apps/bridge';\nimport type { AbortablePromise } from 'better-promises';\n\nimport { wrapSafe } from '@/scopes/wrappers/wrapSafe.js';\nimport { createRequestId, request } from '@/globals.js';\nimport type { RequestOptionsNoCapture } from '@/types.js';\n\nconst METHOD_NAME = 'web_app_read_text_from_clipboard';\n\n/**\n * Reads a text from the clipboard and returns a `string` or `null`. `null` is returned\n * in cases:\n * - A value in the clipboard is not a text.\n * - Access to the clipboard is not granted.\n * @since Mini Apps v6.4\n * @throws {FunctionNotAvailableError} The environment is unknown\n * @throws {FunctionNotAvailableError} The SDK is not initialized\n * @throws {FunctionNotAvailableError} The function is not supported\n * @example\n * if (readTextFromClipboard.isAvailable()) {\n *   const value = await readTextFromClipboard();\n * }\n */\nexport const readTextFromClipboard = wrapSafe(\n  'readTextFromClipboard',\n  (options?: RequestOptionsNoCapture): AbortablePromise<string | null> => {\n    const reqId = createRequestId();\n\n    return request(METHOD_NAME, 'clipboard_text_received', {\n      ...options,\n      params: { req_id: reqId },\n      capture: captureSameReq(reqId),\n    }).then(({ data = null }) => data);\n  },\n  { isSupported: METHOD_NAME },\n);","import { wrapSafe } from '@/scopes/wrappers/wrapSafe.js';\nimport { InvalidArgumentsError } from '@/errors.js';\nimport { postEvent } from '@/globals.js';\n\nconst METHOD_NAME = 'web_app_data_send';\n\n/**\n * Sends data to the bot.\n *\n * When this method called, a service message sent to the bot containing the data of the length\n * up to 4096 bytes, and the Mini App closed.\n *\n * See the field `web_app_data` in the class [Message](https://core.telegram.org/bots/api#message).\n *\n * This method is only available for Mini Apps launched via a Keyboard button.\n * @param data - data to send to bot.\n * @throws {FunctionNotAvailableError} The function is not supported\n * @throws {FunctionNotAvailableError} The environment is unknown\n * @throws {InvalidArgumentsError} Maximum size of data to send is 4096 bytes\n * @throws {InvalidArgumentsError} Attempted to send empty data\n * @example\n * if (sendData.isAvailable()) {\n *   sendData('Here comes my data');\n * }\n */\nexport const sendData = wrapSafe(\n  'sendData',\n  (data: string): void => {\n    const { size } = new Blob([data]);\n    if (!size || size > 4096) {\n      throw new InvalidArgumentsError(size\n        ? 'Maximum size of data to send is 4096 bytes'\n        : 'Attempted to send empty data');\n    }\n    postEvent(METHOD_NAME, { data });\n  },\n  { isSupported: METHOD_NAME },\n);\n","import type { AbortablePromise } from 'better-promises';\n\nimport { wrapSafe } from '@/scopes/wrappers/wrapSafe.js';\nimport { request } from '@/globals.js';\nimport { ShareMessageError } from '@/errors.js';\nimport type { AsyncOptions } from '@/types.js';\n\nconst METHOD_NAME = 'web_app_send_prepared_message';\n\n/**\n * Opens a dialog allowing the user to share a message provided by the bot.\n * @since Mini Apps v8.0\n * @throws {FunctionNotAvailableError} The function is not supported\n * @throws {FunctionNotAvailableError} The environment is unknown\n * @throws {FunctionNotAvailableError} The SDK is not initialized\n * @throws {ShareMessageError} Message sharing failed.\n * @example\n * if (shareMessage.isAvailable()) {\n *   await shareMessage('bbhjSYgvck23');\n * }\n */\nexport const shareMessage = wrapSafe(\n  'shareMessage',\n  (id: string, options?: AsyncOptions): AbortablePromise<void> => {\n    return request(METHOD_NAME, ['prepared_message_failed', 'prepared_message_sent'], {\n      ...options,\n      params: { id },\n    }).then(data => {\n      if (data && 'error' in data) {\n        throw new ShareMessageError(data.error);\n      }\n    });\n  },\n  { isSupported: METHOD_NAME },\n);","import { wrapSafe } from '@/scopes/wrappers/wrapSafe.js';\nimport { postEvent } from '@/globals.js';\n\nconst SHARE_STORY_METHOD = 'web_app_share_to_story';\n\nexport interface ShareStoryOptions {\n  /**\n   * The caption to be added to the media.\n   * 0-200 characters for regular users and 0-2048 characters for premium subscribers.\n   * @see https://telegram.org/faq_premium#telegram-premium\n   */\n  text?: string;\n  /**\n   * An object that describes a widget link to be included in the story.\n   * Note that only premium subscribers can post stories with links.\n   * @see https://telegram.org/faq_premium#telegram-premium\n   */\n  widgetLink?: {\n    /**\n     * The URL to be included in the story.\n     */\n    url: string;\n    /**\n     * The name to be displayed for the widget link, 0-48 characters.\n     */\n    name?: string;\n  };\n}\n\n/**\n * Opens the native story editor.\n * @since Mini Apps v7.8\n * @throws {FunctionNotAvailableError} The function is not supported\n * @throws {FunctionNotAvailableError} The environment is unknown\n * @throws {FunctionNotAvailableError} The SDK is not initialized\n * @example\n * if (shareStory.isAvailable()) {\n *   shareStory('https://example.com/background.png', {\n *     text: 'Look at this cool group!',\n *     widgetLink: {\n *       url: 'https://t.me/heyqbnk',\n *       name: 'Vlad\\'s community',\n *     },\n *   });\n * }\n */\nexport const shareStory = wrapSafe(\n  'shareStory',\n  (mediaUrl: string, options?: ShareStoryOptions) => {\n    options ||= {};\n    postEvent(SHARE_STORY_METHOD, {\n      text: options.text,\n      media_url: mediaUrl,\n      widget_link: options.widgetLink,\n    });\n  },\n  { isSupported: SHARE_STORY_METHOD },\n);","import type { SwitchInlineQueryChatType } from '@telegram-apps/bridge';\n\nimport { $launchParams, postEvent } from '@/globals.js';\nimport { wrapSafe } from '@/scopes/wrappers/wrapSafe.js';\n\nconst SWITCH_INLINE_QUERY_METHOD = 'web_app_switch_inline_query';\n\n/**\n * Inserts the bot's username and the specified inline query in the current chat's input field.\n * Query may be empty, in which case only the bot's username will be inserted. The client prompts\n * the user to choose a specific chat, then opens that chat and inserts the bot's username and\n * the specified inline query in the input field.\n * @param query - text which should be inserted in the input after the current bot name. Max\n * length is 256 symbols.\n * @param chatTypes - List of chat types which could be chosen to send the message. Could be an\n * empty list.\n * @since Mini Apps v6.7\n * @throws {FunctionNotAvailableError} The function is not supported\n * @throws {FunctionNotAvailableError} The environment is unknown\n * @throws {FunctionNotAvailableError} The SDK is not initialized\n * @throws {FunctionNotAvailableError} The application must be launched in the inline mode\n * @example\n * if (switchInlineQuery.isAvailable()) {\n *   switchInlineQuery('my query goes here', ['users']);\n * }\n */\nexport const switchInlineQuery = wrapSafe(\n  'switchInlineQuery',\n  (query: string, chatTypes?: SwitchInlineQueryChatType[]) => {\n    postEvent(SWITCH_INLINE_QUERY_METHOD, {\n      query: query,\n      chat_types: chatTypes || [],\n    });\n  },\n  {\n    isSupported() {\n      return $launchParams().tgWebAppBotInline\n        ? undefined\n        : 'The application must be launched in the inline mode';\n    }\n  }\n);\n","export type SafeCallResult<Data, Error> = [ok: true, data: Data] | [ok: false, error: Error];\n\n/**\n * Calls the function and prevents it from throwing an error.\n * Instead, it handles the error and returns it as a value.\n * The returned tuple reminds tuples in GoLang.\n *\n * You can use this function to safely execute any other function.\n * @param fn - function to call.\n * @returns A tuple with either true on the first place and date on the second if the call\n * is successful, or false on the first place and error on the second if something went wrong.\n */\nexport function safeCall<T, E = unknown>(fn: () => T): SafeCallResult<T, E> {\n  try {\n    return [true, fn()];\n  } catch (error) {\n    return [false, error as E];\n  }\n}\n","import { on } from '@telegram-apps/bridge';\nimport { createCbCollector } from '@telegram-apps/toolkit';\n\nimport { postEvent, configure, type ConfigureOptions } from '@/globals.js';\nimport { logInfo } from '@/debug.js';\n\nexport interface InitOptions extends ConfigureOptions {\n  /**\n   * True if SDK should accept styles sent from the Telegram application.\n   * @default true\n   */\n  acceptCustomStyles?: boolean;\n}\n\n/**\n * Initializes the SDK allowing it to properly handle events, sent from the native Telegram\n * application.\n * @param options - function options.\n * @returns A function, to perform a cleanup.\n */\nexport function init(options?: InitOptions): VoidFunction {\n  // Configure the package global dependencies.\n  configure(options);\n\n  const [addCleanup, cleanup] = createCbCollector(\n    on('reload_iframe', () => {\n      logInfo(false, 'Received a request to reload the page');\n      postEvent('iframe_will_reload');\n      window.location.reload();\n    }),\n  );\n\n  const { acceptCustomStyles = true } = options || {};\n  if (acceptCustomStyles) {\n    const style = document.createElement('style');\n    style.id = 'telegram-custom-styles';\n    document.head.appendChild(style);\n\n    addCleanup(\n      on('set_custom_style', html => {\n        // It is safe to use innerHTML here as long as style tag has a special behavior related\n        // to the specified content.\n        // In case any script will be passed here, it will not be executed, so XSS is not possible.\n        style.innerHTML = html;\n      }),\n      () => {\n        document.head.removeChild(style);\n      },\n    );\n  }\n\n  // Notify Telegram that the application is ready.\n  //\n  // This will result in sending style tag html content from the Telegram web application.\n  // We should call this method also to start receiving \"reload_iframe\" events from the Telegram\n  // application.\n  //\n  // It really has no effect outside non-Telegram web environment.\n  postEvent('iframe_ready', { reload_supported: true });\n\n  logInfo(false, 'The package was initialized');\n\n  return cleanup;\n}"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}